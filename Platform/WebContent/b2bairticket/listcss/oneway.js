!function(global){
var template=function(e,t){
return template[/string|function/.test(typeof t)?"compile":"render"].apply(template,arguments);},
cache=template.cache={},toString=function(e,t){return"string"!=typeof e&&(t=typeof e,"number"===t?e+="":e="function"===t?toString(e.call(e)):""),e;},
escapeMap={"<":"&#60;",">":"&#62;",'"':"&#34;","'":"&#39;","&":"&#38;"},
escapeHTML=function(e){return toString(e).replace(/&(?![\w#]+;)|[<>"']/g,function(e){return escapeMap[e];});},
isArray=Array.isArray||function(e){return"[object Array]"==={}.toString.call(e);},
each=function(e,t){if(isArray(e)){for(var i=0,s=e.length;s>i;i++){t.call(e,e[i],i,e);}}else{for(i in e){t.call(e,e[i],i);}}},resolve=function(e,t){var i=/(\/)[^/]+\1\.\.\1/,s=e.replace(/^([^.])/,"./$1").replace(/[^/]+$/,""),n=s+t;for(n=n.replace(/\/\.\//g,"/");n.match(i);){n=n.replace(i,"/");}return n;},helpers=template.helpers={$include:function(e,t,i){var s=resolve(i,e);return template.render(s,t);},$string:toString,$escape:escapeHTML,$each:each},debug=function(e){var t="";for(var i in e){t+="<"+i+">\n"+e[i]+"\n\n";}return t&&global.console&&console.error("Template Error\n\n"+t),function(){return"{Template Error}";};};template.render=function(e,t){var i=template.get(e)||debug({id:e,name:"Render Error",message:"No Template"});return t?i(t):i;},template.compile=function(e,t){var i="function"==typeof t,s=cache[e]=function(s){try{return i?new t(s,e)+"":t;}catch(n){return debug(n)();}};return s.prototype=helpers,i&&(t.prototype=helpers),s.toString=function(){return t+"";},s;},template.get=function(e){return cache[e.replace(/^\.\//,"")];},template.helper=function(e,t){helpers[e]=t;},template.helper("Date",Date),template.helper("String",String),template.helper("parseInt",parseInt),template.helper("$log",function(e){console.log(e);}),template.helper("$MsJson2Date",function(value){var d=eval("new "+value.replace(/\//g,""));return d;}),template.helper("$timeFormat",function(e){return new String(e).length<=0?"":1==new String(e).length?"0"+e:e;}),template.helper("$jsonDateFormat",function(e,t){var i=new Date(parseInt(e.substr(6))),s=i.getTime(),n=60000*i.getTimezoneOffset(),a=s+n;e=new Date(a+28800000);var r=e.getMonth()+1<10?"0"+(e.getMonth()+1):e.getMonth()+1,o=e.getDate()<10?"0"+e.getDate():e.getDate(),l=e.getHours()<10?"0"+e.getHours():e.getHours(),d=e.getMinutes()<10?"0"+e.getMinutes():e.getMinutes(),c=e.getSeconds()<10?"0"+e.getSeconds():e.getSeconds();return"date"==t?e.getFullYear()+"/"+r+"/"+o:"time"==t?l+":"+d+":"+c:"shorttime"==t?l+":"+d:"full"==t?e.getFullYear()+"/"+r+"/"+o+" "+l+":"+d+":"+c:e.getFullYear()+"/"+r+"/"+o+" "+l+":"+d+":"+c;}),template("List_Price",function(e){var t=this,i=e.className,s=e.leg,n=e.index,a=e.context,r=t.$escape,o=e.searchIndex,l=t.$string,d="";d+=" ";var i=s.SegmentList[0].ClassName||"";if(null!=i&&""!=i&&i.length>0){var n=i.length>=2?2:i.length;"EN"==a.Language&&(n=i.length),d+=' <span class="icon_bg01 ml5" method="class" flightno="',d+=r(s.SegmentList[0].FlightNumber),d+='" flightclass="',d+=r(s.SegmentList[0].FlightClassNumber),d+='" way="',d+=r(o),d+='"> ',d+=r(i.substring(0,n)),d+=" </span> ",d+=r(i.substring(n)),d+=" ";}else{d+=' <span class="tax"> ',d+=l(s.ClassNameAuto),d+="</span> ";}return d+=' <span class="price">&yen;<strong>',d+=r(s.SalePrice),d+="</strong></span> ",new String(d);}),template("List_Promotions",function(e){var t=this,i=e.isShowDragon,s=e.leg,n=e.context,a=e.i,r=e.c,o=t.$escape,l=e.ids,d=e.hasDragon,c=e.p,p=e.o,m=e.presaleDate,g=void 0===e.Date?t.Date:e.Date,u=t.$jsonDateFormat,h="";h+=" ";var i=!0;if(!s.IsTransfer){if("Elong"==n.WebCategory&&"CN"==n.Language){if(1==s.SegmentList[0].IsShowCoupon&&s.SegmentList[0].CouponPromotList.hasOwnProperty("C")&&s.SegmentList[0].CouponPromotList.C.length>0){for(var a=0;a<s.SegmentList[0].CouponPromotList.C.length;a++){var r=s.SegmentList[0].CouponPromotList.C[a];h+=' <div class="clx"> <div class="icon_bg04" method="promotelist" pid="',h+=o(r.Id),h+='" price="',h+=o(r.SalePrice),h+='" iscoupon="1"> <span method="promotelist" promtype="',h+=o(r.AirPromotionTypeID),h+='" pid="',h+=o(r.Id),h+='" price="',h+=o(r.SalePrice),h+='" iscoupon="1"> ',h+=o(r.SalePrice),h+=o(n.listResource.CurrencyName),h+="</span> </div> </div> ",r.IsInproc&&(h+=' <div class="clx"> <div class="icon_',h+=o(r.OrderFromId),h+='" method="',h+=o(r.OrderFromId),h+='promotelist"> </div> </div> '),h+=" ",!s.IsDragonOnly&&r.IsDragon&&i&&(i=!1,h+=' <div class="clx"> <div class="icon_bg_lc"> <span method="dragon"> ',h+=o(n.listResource.DragonOnly),h+="</span> </div> </div> "),h+=" ";}h+=" ";}h+=" ";}h+=" ";}if(h+=" ",s.SegmentList[0].CouponPromotList.hasOwnProperty("D")){h+=" ";for(var a=0;a<s.SegmentList[0].CouponPromotList.D.length;a++){h+=" ";var r=s.SegmentList[0].CouponPromotList.D[a];h+=' <div class="clx"> <div class="icon_bg04" method="promotelist" pid="',h+=o(r.Id),h+='" price="',h+=o(r.SalePrice),h+='" iscoupon="1"> ',"CN"==n.Language?(h+=' <span method="promotelist" promtype="',h+=o(r.AirPromotionTypeID),h+='" pid="',h+=o(r.Id),h+='" price="',h+=o(r.SalePrice),h+='" iscoupon="1"> ',h+=o(r.SalePrice),h+=o(n.listResource.CurrencyName),h+=" </span> "):(h+=' <span method="promotelist" promtype="',h+=o(r.AirPromotionTypeID),h+='" pid="',h+=o(r.Id),h+='" price="',h+=o(r.SalePrice),h+='" iscoupon="1"> ',h+=o(n.listResource.CurrencyName),h+=o(r.SalePrice),h+="</span> "),h+=" </div> </div> ",r.IsInproc&&(h+=' <div class="clx"> <div class="icon_',h+=o(r.OrderFromId),h+='" method="',h+=o(r.OrderFromId),h+='promotelist"> </div> </div> '),h+=" ",!s.IsDragonOnly&&r.IsDragon&&i&&(i=!1,h+=' <div class="clx"> <div class="icon_bg_lc"> <span method="dragon"> ',h+=o(n.listResource.DragonOnly),h+="</span> </div> </div> "),h+=" ";}h+=" ";}h+=" ",s.IsDragonOnly&&i&&(i=!1,h+=' <div class="clx"> <div class="icon_bg_lc"> <span method="dragon">',h+=o(n.listResource.DragonOnly),h+="</span> </div> </div> "),h+=" ",s.ProductTypes.join(",").indexOf("3")<0&&s.IsPackagePromotion?(h+=' <div class="clx"> <div class="icon_bg02"> <span method="BindInsuranceWithPackage"> ',h+=o(n.listResource.BindInsuranceWithPackage),h+="</span> </div> </div> "):s.ProductTypes.join(",").indexOf("3")<0&&s.InsuranceProductId>0&&(h+=' <div class="clx"> <div class="icon_bg02"> <span method="BindInsurance"> ',h+=o(n.listResource.BindInsuranceWithoutPackage),h+="</span></div> </div> "),h+=" ";for(var l="",d=!1,a=0;a<s.SegmentList[0].PromotList.length;a++){var c=s.SegmentList[0].PromotList[a];l.length>0&&(l+=","),l+=c.Id,1==c.IsDragon&&(d=!0);}for(var a=0;a<s.SegmentList[0].OtherPromots.length;a++){var p=s.SegmentList[0].OtherPromots[a];(2!=s.Channel||"\u4e1c\u822a\u76f4\u8fde\u7ed1\u5b9a\u4fdd\u9669"!=p.Title)&&(1==p.IsDragon&&(d=!0),l.length>0&&(l+=","),l+=p.Id);}if(l.length>0||s.IsPreSale||2==s.SegmentList[0].MarketChannel){var m=new g(u(s.PreSaleDate));i&&d&&(h+=' <div class="icon_bg_lc"> <span method="dragon">',h+=o(n.listResource.DragonOnly),h+="</span> </div> "),h+=' <div class="icon_bg02 icon_hui"> <span method="promotions" pid="',h+=o(l),h+='" date="',h+=o(m.toLocaleDateString()),h+='" presale="',h+=o(s.IsPreSale?1:0),h+='" channel="',h+=o(s.SegmentList[0].MarketChannel),h+='">',h+=o(n.listResource.Promotion),h+="</span></div> ";}return new String(h);}),template("List_Rule",function(e){var t=this,i=e.muRule,s=(e.shopRule,e.leg),n=e.rule,a=t.$jsonDateFormat,r=t.$escape,o=e.context,l="";l+=" ";var i="";2==s.Channel&&(i="",i+=s.SegmentList[0].DepartureAirPort+"|",i+=s.SegmentList[0].ArriveAirPort+"|",i+=s.SegmentList[0].FlightNumber);var n="BSP";return 2==s.Channel&&(n="MU"),4==s.Channel&&(n="AirShopping"),6==s.Channel&&(n="Book51"),n+="|",n+=s.SegmentList[0].AirCorpInfo.Code+"|",n+=s.FareId+"|",n+=s.SegmentList[0].FlightClassNumber+"|",n+=a(s.SegmentList[0].DepartureTime),n+="|",n+=s.IssueCity+"|",n+=(s.ProductTypes.join(",").indexOf("7")>0?"True":"False")+"|",n+=(s.ProductTypes.join(",").indexOf("2")>0?"True":"False")+"|",n+=s.PolicyId+"|",n+=s.SegmentList[0].DepartureAirPort+"|",n+=s.SegmentList[0].ArriveAirPort,l+=' <span class="pseudo_link" method="flightrule" shoprule="0-0" murule="',l+=r(i),l+='" psg="',l+=r(s.PassengerType),l+='" rule="',l+=r(n),l+='"> ',l+=r(o.listResource.List_Rule),l+='</span><div style="display: none;"></div> ',new String(l);}),template("OneWay_DataList",function(e,t){var i=this,s=e.recommended,n=e.RecommendedFlights,a=e.i,r=e.FlightLegList,o=e.leg,l=(e.itemId,e.ticketCount,e.isLijian,e.isPackagePromotion,e.departtime),d=void 0===e.Date?i.Date:e.Date,c=i.$jsonDateFormat,p=e.ticks,m=e.channel,g=e.uniqueKey,u=e.styleVal,h=e.SearchRequest,v=i.$escape,S=void 0===e.parseInt?i.parseInt:e.parseInt,L=e.moreCoupon,y=e.IsSupportCoupon,f=e.context,C=function(s,n){n=n||e;var a=i.$include(s,n,t);return N+=a,a;},T=(e.seg,e.j),P=e.RecommendLegList,b=e.rleg,F=e.k,_=e.SelloutClasses,I=e.selloutFlight,A=i.$string,N="";N+=" ";var s=n.length;for(a=0;a<r.length;a++){var o=r[a],l=(o.SegmentList[0].TicketCount,o.AdultLegislationAmount>0?!0:!1,o.IsPackagePromotion,new d(c(o.SegmentList[0].DepartureTime))),p=10000*l.getTime()+6.21355968e+17,m="BSP";2==o.Channel&&(m="MU"),4==o.Channel&&(m="AirShopping"),6==o.Channel&&(m="Book51");var g="";g+=m,g+=o.SegmentList[0].FlightNumber,g+=o.SegmentList[0].FlightClass,g+=o.PromotionID,g+=o.SalePrice;var u="";h.AirCorp.length>0&&"0"!=h.AirCorp&&h.AirCorp!=o.SegmentList[0].AirCorpInfo.Code&&(u='style="display:none;"'),N+=' <div class="flightlist" price="',N+=v(o.SalePrice),N+='" flighttime="',N+=v(p),N+='" flightno="',N+=v(o.SegmentList[0].FlightNumber),N+='" method="divBox" itemid="',N+=v(s+o.IndexByFlyType),N+='" aircorp="',N+=v(o.SegmentList[0].AirCorpInfo.Code),N+='" depart="',N+=v(o.SegmentList[0].DepartureAirPort),N+='" arrive="',N+=v(o.SegmentList[0].ArriveAirPort),N+='" time="',N+=v(S(l.getHours()/6)),N+='"> ';var L="";y&&o.SegmentList[0].IsShowMoreCoupon&&null!=o.SegmentList[0].CouponPromotList&&o.SegmentList[0].CouponPromotList.hasOwnProperty("A")&&(L=f.listResource.List_AllFlight_Return.replace("{0}",o.SegmentList[0].CouponPromotList.A[0].SalePrice)),N+=' <div class="f-goto-div"> ',C("./OneWay_SegmentInfo",{seg:o.SegmentList[0],context:f}),N+=' </div> <div class="fltable-div"> <table class="fltable"> ',C("./OneWay_SegmentPrice",{leg:o,context:f}),N+=" ";for(var T=0;T<P.length;T++){var b=P[T];b.SegmentList[0].FlightNumber==o.SegmentList[0].FlightNumber&&(N+=" ",C("./OneWay_SegmentSoldout",{leg:b,context:f}),N+=" ");}N+=" ";for(var F=0;F<_.length;F++){var I=_[F];if(I.SegmentList[0].FlightNumber==o.SegmentList[0].FlightNumber&&I.SalePrice<=o.SalePrice){N+=" ",C("./OneWay_SegmentSoldout",{leg:I,context:f});break;}}N+=' </table> <div method="divMore"> </div> <p class="lh"> <span method="loadding" style="display: none"></span><span class="pseudo_link" method="moreflight" itemid="',N+=v(s+o.IndexByFlyType),N+='" flightno="',N+=v(o.SegmentList[0].FlightNumber),N+='" channel="',N+=v(o.Channel),N+='" flightclass="',N+=v(o.SegmentList[0].FlightClassNumber),N+='" datacache="0" fareid="',N+=v(o.FareId),N+='" uniquekey="',N+=v(g),N+='"> ',N+=v(f.listResource.List_AllFlight),N+=A(L),N+='</span><span method="spanMore" itemid="',N+=v(s+o.IndexByFlyType),N+='" class="flight_down"></span> </p> </div> </div> ';}return new String(N);}),template("OneWay_DataList_Transfer",function(e,t){var i=this,s=i.$escape,n=e.context,a=e.i,r=e.FlightTransferLegList,o=e.leg,l=e.oilfee,d=e.fee,c=e.totalfee,p=e.insuranceId,m=e.departtime,g=void 0===e.Date?i.Date:e.Date,u=i.$jsonDateFormat,h=e.onehour,v=e.kseat,S=e.j,L=e.rule,y=e.date,f=e.channel,C=e.rule2,T=e.uniqueKey,P=function(s,n){n=n||e;var a=i.$include(s,n,t);return k+=a,a;},b=e.durationHour,F=e.duration,_=void 0===e.parseInt?i.parseInt:e.parseInt,I=e.flightnum,A=e.k,N=e.departHour,D=e.arriveHour,x=e.departureTime,R=e.arriveTime,k="";k+=' <div class="main2" id="DataList_Transfer"> <div class="titlebox"> <h2> ',k+=s(n.listResource.TransferLeg_Title),k+='</h2> </div> <ul class="flightlist"> ';for(var a=0;a<r.length;a++){for(var o=r[a],l=o.SegmentList[0].OilFee+o.SegmentList[1].OilFee,d=o.SegmentList[0].AircorpFee+o.SegmentList[1].AircorpFee,c=l+d,p=o.InsuranceProductId,m=10000*new g(u(o.SegmentList[0].DepartureTime)).getTime()+6.21355968e+17,h=!1,v=!1,S=0;S<o.ProductTypes.length;S++){h=h||3==o.ProductTypes[S]&&"CN"==n.Language,v=v||7==o.ProductTypes[S];}var L="BSP";2==o.Channel&&(L="MU"),4==o.Channel&&(L="AirShopping"),6==o.Channel&&(L="Book51"),L+="|",L+=o.SegmentList[0].AirCorpInfo.Code+"|",L+=o.FareId+"|",L+=o.SegmentList[0].FlightClassNumber+"|";var y=new g(u(o.SegmentList[0].DepartureTime));L+=y.toLocaleDateString()+" ",L+=y.toLocaleTimeString(),L+="|",L+=o.IssueCity+"|",L+=(o.ProductTypes.join(",").indexOf("7")>0?"True":"False")+"|",L+=(o.ProductTypes.join(",").indexOf("2")>0?"True":"False")+"|",L+=o.PolicyId+"|",L+=o.SegmentList[0].DepartureAirPort+"|",L+=o.SegmentList[0].ArriveAirPort;var f="BSP",C="BSP";2==o.Channel&&(C="MU",f="MU"),4==o.Channel&&(C="AirShopping",f="AirShopping"),6==o.Channel&&(C="Book51",f="Book51"),C+="|",C+=o.SegmentList[1].AirCorpInfo.Code+"|",C+=o.FareId+"|",C+=o.SegmentList[1].FlightClassNumber+"|";var y=new g(u(o.SegmentList[1].DepartureTime));C+=y.toLocaleDateString()+" ",C+=y.toLocaleTimeString(),C+="|",C+=o.IssueCity+"|",C+=(o.ProductTypes.join(",").indexOf("7")>0?"True":"False")+"|",C+=(o.ProductTypes.join(",").indexOf("2")>0?"True":"False")+"|",C+=o.PolicyId+"|",C+=o.SegmentList[1].DepartureAirPort+"|",C+=o.SegmentList[1].ArriveAirPort;var T="";T+=f,T+=o.SegmentList[0].FlightNumber,T+=o.SegmentList[0].FlightClass,T+=o.SegmentList[1].FlightNumber,T+=o.SegmentList[1].FlightClass,T+=o.PromotionID,T+=o.SalePrice,k+=' <li method="divBox" itemid="',k+=s(o.IndexByFlyType),k+='" class="no_li" ',0!=o.IndexByFlyType&&(k+='style="display:none;" '),k+='> <table class="fltable"> <tr> <td> <table class="zz_table"> <tr> <td valign="top" class="cols01"> <span class="Airlines_',k+=s(o.SegmentList[0].AirCorpInfo.Code),k+=' icon_box"></span> <span class="company"> ',k+=s(o.SegmentList[0].AirCorpInfo.ShortName),k+="</span>&nbsp;",k+=s(o.SegmentList[0].FlightNumber),k+="<br /> ",k+=s(n.listResource.List_Data_PlaneType),k+='&nbsp;<a href="javascript:void(0)" rel="nofollow" method="PlanType" planetype="',k+=s(o.SegmentList[0].PlaneType),k+='">',k+=s(null==o.SegmentList[0].PlanTypeName||""==o.SegmentList[0].PlanTypeName?o.SegmentList[0].PlaneType:o.SegmentList[0].PlanTypeName),k+='</a> </td> <td valign="top" class="cols02"> <span class="ftime"> ',k+=u(o.SegmentList[0].DepartureTime,"shorttime"),k+="</span>&nbsp;",k+=s(o.SegmentList[0].DepartureAirPortName),k+=" ",k+=s(o.SegmentList[0].DepartTermianlEN),k+="<br /> ",k+=u(o.SegmentList[0].ArriveTime,"shorttime"),k+="&nbsp;",k+=s(o.SegmentList[0].ArriveAirPortName),k+=s(o.SegmentList[0].ArriveTermianlEN),k+=" ",new g(u(o.SegmentList[0].ArriveTime)).getHours()<new g(u(o.SegmentList[0].DepartureTime)).getHours()&&(k+="&nbsp; ",k+=s(n.listResource.List_AddDay),k+=" "),k+=" ",o.SegmentList[0].StopNumber>0&&(k+=' <a href="javascript:void(0)" rel="nofollow" method="StopOver" flightno="',k+=s(o.SegmentList[0].FlightNumber),k+='" class="dun"> ',k+=s(n.listResource.List_StopOver),k+="</a> "),k+=' </td> <td valign="top" class="cols03"> ',P("./OneWay_Mileage",{leg:o,context:n}),k+=' <br /> <a href="javascript:void(0)" rel="nofollow" method="flightrule" shoprule="0-0" rule="',k+=s(L),k+='"> ',k+=s(n.listResource.List_Rule),k+='</a><div style="display: none;"> </div> </td> </tr> </table> <p class="huafei" method="taxfee"> ',k+=s(n.listResource.Taxfee),k+=" ",k+=s(o.SegmentList[0].OilFee),k+="+",k+=s(o.SegmentList[0].AircorpFee),k+=" ",k+=s(n.listResource.Dollar),k+=" | ",k+=s(n.listResource.FlightTime),k+=" ",k+=s(n.listResource.FlightTimeFormat.replace("{0}",(o.SegmentList[0].FlightTime/60).toFixed()).replace("{1}",o.SegmentList[0].FlightTime%60)),k+='<br /> </p> <div class="zhong_zhuan"> <span class="zz_icon"> ';var b=new g(u(o.SegmentList[1].DepartureTime)).getHours()-new g(u(o.SegmentList[0].ArriveTime)).getHours(),F=new g(u(o.SegmentList[1].DepartureTime)).getMinutes()-new g(u(o.SegmentList[0].ArriveTime)).getMinutes();0>b&&(b+=24),0>F&&(F+=60,b--),k+=" ",k+=s(o.SegmentList[0].ArriveAirPortName),k+=s(o.SegmentList[0].ArriveTermianlEN),k+=" <span>",k+=s(n.listResource.List_MidTurn.replace("{0}",b.toFixed()).replace("{1}",F)),k+="</span> ",o.SegmentList.length>2&&(k+=' <a class="dun zzbg" href="javascript:void(0)" rel="nofollow" method="showchange" itemid="',k+=s(o.IndexByFlyType),k+='">',k+=s(n.listResource.List_ChangeMidTurn),k+="</a>"),k+='</span></div> <table class="zz_table" method="Turn"> <tr> <td valign="top" class="cols01"> <span class="Airlines_',k+=s(o.SegmentList[1].AirCorpInfo.Code),k+=' icon_box"></span> <span class="company"> ',k+=s(o.SegmentList[1].AirCorpInfo.ShortName),k+="</span>&nbsp;",k+=s(o.SegmentList[1].FlightNumber),k+="<br /> ",k+=s(n.listResource.List_Data_PlaneType),k+='&nbsp;<a href="javascript:void(0)" rel="nofollow" method="PlanType" planetype="',k+=s(o.SegmentList[1].PlaneType),k+='"> ',k+=s(null==o.SegmentList[1].PlanTypeName||""==o.SegmentList[1].PlanTypeName?o.SegmentList[1].PlaneType:o.SegmentList[1].PlanTypeName),k+='</a> </td> <td valign="top" class="cols02"> <span class="ftime"> ',k+=u(o.SegmentList[1].DepartureTime,"shorttime"),k+="</span> ",k+=s(o.SegmentList[1].DepartureAirPortName),k+=" ",k+=s(o.SegmentList[1].DepartTermianlEN),k+="<br /> ",k+=u(o.SegmentList[1].ArriveTime,"shorttime"),k+="&nbsp;",k+=s(o.SegmentList[1].ArriveAirPortName),k+="&nbsp;",k+=s(o.SegmentList[1].ArriveTermianlEN),k+="&nbsp; ",new g(u(o.SegmentList[0].ArriveTime)).getHours()<=new g(u(o.SegmentList[1].DepartureTime)).getHours()&&new g(u(o.SegmentList[1].ArriveTime)).getHours()<new g(u(o.SegmentList[1].DepartureTime)).getHours()&&(k+=" ",k+=s(n.listResource.List_AddDay),k+=" "),k+=" ",o.SegmentList[1].StopNumber>0&&(k+=' <a href="javascript:void(0)" rel="nofollow" method="StopOver" flightno="',k+=s(o.SegmentList[0].FlightNumber),k+='"> ',k+=s(n.listResource.List_StopOver),k+="</a> "),k+=' </td> <td valign="top" class="cols03"> ',P("./OneWay_Mileage",{leg:o,context:n}),k+='<br /> <a href="javascript:void(0)" rel="nofollow" method="flightrule" shoprule="0-1" rule="',k+=s(C),k+='"> ',k+=s(n.listResource.List_Rule),k+='</a><div style="display: none;"> </div> </td> </tr> </table> <p class="huafei" method="taxfee"> ',k+=s(n.listResource.Taxfee),k+=" ",k+=s(o.SegmentList[1].OilFee),k+="+",k+=s(o.SegmentList[1].AircorpFee),k+=" ",k+=s(n.listResource.Dollar),k+=" | ",k+=s(n.listResource.FlightTime),k+=" ",k+=s(n.listResource.FlightTimeFormat.replace("{0}",_(o.SegmentList[1].FlightTime/60)).replace("{1}",o.SegmentList[1].FlightTime%60)),k+='<br /> </p> </td> <td class="cols04"> ',P("./List_Price",{leg:o,context:n}),k+=' <span method="loadding" style="display: none"></span><a method="moreflight_transfer" itemid="',k+=s(o.IndexByFlyType),k+='" flightno="',k+=s(o.SegmentList[0].FlightNumber+"-"+o.SegmentList[1].FlightNumber),k+='" flightclass="',k+=s(o.SegmentList[0].FlightClassNumber+"-"+o.SegmentList[1].FlightClassNumber),k+='" datacache="0" href="javascript:void(0)" rel="nofollow" fareid="',k+=s(o.FareId),k+='" channel="',k+=s(f),k+='" uniquekey="',k+=s(T),k+='"> ',k+=s(n.listResource.List_AllFlight),k+='</a><span method="spanMore" itemid="',k+=s(o.IndexByFlyType),k+='" class="flight_down"></span> </td> <td valign="middle" class="cols05"> ',P("./List_Promotions",{leg:o,context:n}),k+=' </td> <td class="cols06"> <div style="position: relative"> <p class="p1"> </p> ';var I=o.SegmentList[0].FlightNumber+"-"+o.SegmentList[1].FlightNumber;if(k+=' <input type="button" class="button" method="btnBooking" itemid="',k+=s(o.IndexByFlyType),k+='" flightnum="',k+=s(I),k+='" flightclassnum="',k+=s(o.SegmentList[0].FlightClassNumber+"-"+o.SegmentList[1].FlightClassNumber),k+='" channel="',k+=s(f),k+='" onfocus="this.blur()" fareid="',k+=s(o.FareId),k+='" departtime="',k+=s(m),k+='" price="',k+=s(o.SalePrice),k+='" onehour="',k+=s(o.ProductTypes.join(",").indexOf("7")>0&&"CN"==n.Language),k+='" totalfee="',k+=s(c),k+='" insuranceproductid="',k+=s(p),k+='" value="',k+=s(n.listResource.Select),k+='" /> <br /> ',(2==o.SegmentList[0].TicketStatus||2==o.SegmentList[1].TicketStatus)&&(k+=' <span class="red"> ',2==o.SegmentList[0].TicketStatus?(k+=" ",k+=s(n.listResource.Tag_Tight.replace("{0}",o.SegmentList[0].TicketCount)),k+=" "):(k+=" ",k+=s(n.listResource.Tag_Tight.replace("{0}",o.SegmentList[1].TicketCount)),k+=" "),k+=" </span> <br /> "),k+=" </div> </td> </tr> </table> ",o.SegmentList.length>2){k+=' <div style="display: none" method="ChangeTurn" itemid="',k+=s(o.IndexByFlyType),k+='"> <table class="zzfltable"> ';for(var A=1;A<o.SegmentList.length;A++){var N=new g(u(o.SegmentList[A].DepartureTime)).getHours(),D=new g(u(o.SegmentList[A].ArriveTime)).getHours(),x=u(o.SegmentList[A].DepartureTime,"shorttime"),R=u(o.SegmentList[A].ArriveTime,"shorttime"),b=new g(u(o.SegmentList[A].DepartureTime)).getHours()-new g(u(o.SegmentList[0].ArriveTime)).getHours(),F=new g(u(o.SegmentList[A].DepartureTime)).getMinutes()-new g(u(o.SegmentList[0].ArriveTime)).getMinutes();0>b&&(b+=24),0>F&&(F+=60,b--);var L="BSP";2==o.Channel&&(L="MU"),4==o.Channel&&(L="AirShopping"),6==o.Channel&&(L="Book51"),L+="|",L+=o.SegmentList[A].AirCorpInfo.Code+"|",L+=o.FareId+"|",L+=o.SegmentList[A].FlightClassNumber+"|";var y=new g(u(o.SegmentList[A].DepartureTime));L+=y.toLocaleDateString()+" ",L+=y.toLocaleTimeString(),L+="|",L+=o.IssueCity+"|",L+=(o.ProductTypes.join(",").indexOf("7")>0?"True":"False")+"|",L+=(o.ProductTypes.join(",").indexOf("2")>0?"True":"False")+"|",L+=o.PolicyId+"|",L+=o.SegmentList[A].DepartureAirPort+"|",L+=o.SegmentList[A].ArriveAirPort,k+=' <tr segid="',k+=s(A),k+='"> <td style="width:300px;"> <div class="ift_zz_bj"> ',k+=s(n.listResource.List_MidTurn.replace("{0}",b.toFixed()).replace("{1}",F)),k+='</div> <p class="huafei"> ',k+=s(n.listResource.Taxfee),k+=" ",k+=s(o.SegmentList[A].OilFee),k+="+",k+=s(o.SegmentList[A].AircorpFee),k+=" ",k+=s(n.listResource.Dollar),k+=" | ",k+=s(n.listResource.FlightTime),k+=" ",k+=s(n.listResource.FlightTimeFormat.replace("{0}",_(o.SegmentList[A].FlightTime/60)).replace("{1}",o.SegmentList[A].FlightTime%60)),k+='</p> </td> <td style="width:140px;"> <p> <span class="ftime"> ',k+=s(x),k+="</span>",k+=s(o.SegmentList[A].DepartureAirPortName),k+=" ",k+=s(o.SegmentList[A].DepartTermianlEN),k+="<br /> <span> ",k+=s(R),k+="</span>",k+=s(o.SegmentList[A].ArriveAirPortName),k+=" ",N>=D&&N>D&&(k+=" ",k+=s(n.listResource.List_AddDay),k+=" "),k+=" ",o.SegmentList[0].StopNumber>0&&(k+=' <a href="javascript:void(0)" rel="nofollow" method="StopOver" flightno="',k+=s(o.SegmentList[0].FlightNumber),k+='"> ',k+=s(n.listResource.List_StopOver),k+="</a> "),k+=' </p> </td> <td class="cols03"> <span class="Airlines_',k+=s(o.SegmentList[A].AirCorpInfo.Code),k+=' icon_box"></span> <span class="company"> ',k+=s(o.SegmentList[A].AirCorpInfo.ShortName),k+="</span> ",k+=s(o.SegmentList[A].FlightNumber),k+="<br /> ",k+=s(n.listResource.List_Data_PlaneType),k+=' <a href="javascript:void(0)" rel="nofollow" method="PlanType" planetype="',k+=s(o.SegmentList[A].PlaneType),k+='"> ',k+=s(null==o.SegmentList[A].PlanTypeName||""==o.SegmentList[A].PlanTypeName?o.SegmentList[A].PlaneType:o.SegmentList[A].PlanTypeName),k+='</a> </td> <td class="cols03"> ',P("./OneWay_Mileage",{leg:o,context:n}),k+='<br /> <a href="javascript:void(0)" rel="nofollow" method="flightrule" shoprule="0-',k+=s(A),k+='" rule="',k+=s(L),k+='"> ',k+=s(n.listResource.List_Rule),k+='</a><div style="display: none;"> </div> </td> <td> <input type="radio" name="btnChange" method="btnChange" value="',k+=s(A),k+='" segid="',k+=s(A),k+='" flightnum="',k+=s(o.SegmentList[0].FlightNumber+"-"+o.SegmentList[A].FlightNumber),k+='" flightclassnum="',k+=s(o.SegmentList[0].FlightClassNumber+"-"+o.SegmentList[A].FlightClassNumber),k+='" itemid="',k+=s(o.IndexByFlyType),k+='" /> </td> </tr> ';}k+=' </table> <div class="clear"> </div> </div> ';}k+=' <ul style="border-top: 1px dotted #C7C7C7; zoom: 1; display: none;"> <div method="divMore" class="trans_more"> </div> </ul> </li> ';}return k+=" </ul> ",null!=r&&r.length>1&&(k+=' <div id="fpagebox" class="more"> <a href="javascript:void(0);" rel="nofollow" method="moretrans"> ',k+=s(n.listResource.TransferLeg_More),k+='</a><span class="flight_down" method="moretrans"></span> </div> '),k+=" </div> ",new String(k);}),template("OneWay_Mileage",function(e){var t=this,i=e.pointsCorp,s=(e.MU,e.FM,e.KN,e.HO,e.MF,e.NS,t.$escape),n=e.leg,a=e.context,r=e.temp,o="";o+=" ";var i={MU:"MU",FM:"FM",KN:"KN",HO:"HO",MF:"MF",NS:"NS"};if(o+=' <span class="pseudo_link bor" aircorp="',o+=s(n.SegmentList[0].AirCorpInfo.Code),o+='" ',6==n.Channel&&(o+='book="true"'),o+=' mileage="',o+=s(n.Mileage),o+='" upgradeleg="',o+=s(n.UpgradeLeg),o+='" method="Mileage"> ',6==n.Channel){o+="\u5e38\u65c5\u5ba2\u91cc\u7a0b\u7d2f\u79ef\u8be6\u60c5 ";}else{if(o+=" ",n.Mileage.length>0&&"0"!=n.Mileage){o+=" ",o+=s("HO"==n.SegmentList[0].AirCorpInfo.Code?a.listResource.ActualTicketPrice:a.listResource.StandardMileage),o+=" \xd7",o+=s(n.Mileage),o+="% ";}else{o+=" ";var r=""+a.listResource.NoAccumulation;o+=" ",null!=i[n.SegmentList[0].AirCorpInfo.Code]?(o+=" ",o+=s(r.replace("{0}",a.listResource.AccumulationUnitPoints)),o+=" "):(o+=" ",o+=s(r.replace("{0}",a.listResource.AccumulationUnitMileage)),o+=" "),o+=" ";}o+=" ";}return o+=" </span>",new String(o);}),template("OneWay_MoreFlight",function(e){var t=this,i=e.i,s=e.list,n=e.leg,a=e.isShowDragon,r=e.ticketCount,o=e.listResource,l=e.context,d=t.$escape,c=t.$string,p=e.k,m=e.flightNumber,g=e.classNumber,u=e.promotionId,h="";h+=' <table class="fltable"> ';for(var i=0;i<s.length;i++){var n=s[i],a=!0,r=n.TicketCountValue,o=l.listResource;if(h+=' <tr> <td class="cols01"> ',n.IsOneHour&&(h+=' <div class="icon_bg03"> <span method="onehour"> ',h+=d(o.Tag_OneHour),h+="</span> </div> "),h+=" ",n.IsKSeat&&(h+=' <div class="icon_bg03"> <span method="kseat"> ',h+=d(o.Tag_KSeat),h+="</span> </div> "),h+=" ",n.IsMU&&(h+=' <div class="icon_bg03"> <span method="Channel_MU"> ',h+=d(o.Channel_MU),h+="</span></div> "),h+=" ",n.IsBook51&&(h+=' <div class="icon_bg05"> <span method="Channel_Book51"> ',h+=d(o.Book51),h+="</span><em>\u4ee3\u7406</em></div> "),h+=' </td> <td class="cols02"> <span class="pseudo_link bor" ',n.IsBook51&&(h+='book="true"'),h+=' aircorp="',h+=d(n.AirCorpCode),h+='" mileage="',h+=d(n.Mileage),h+='" upgradeleg="',h+=d(n.UpgradeLeg),h+='" method="Mileage"> ',n.IsBook51?h+="\u5e38\u65c5\u5ba2\u91cc\u7a0b\u7d2f\u79ef\u8be6\u60c5 ":(h+=" ",n.Mileage&&""!=n.Mileage&&"0"!=n.Mileage?(h+=" ",h+=d("HO"==n.AirCorpCode?o.ActualTicketPrice:o.StandardMileage),h+="\xd7",h+=d(n.Mileage),h+="% "):(h+=" ",h+=d(n.NoMileage),h+=" "),h+=" "),h+=' </span> </td> <td class="cols03"> <span class="pseudo_link" method="flightrule" muRule="',h+=d(n.IsMU?n.MURule:""),h+='" rule="',h+=d(n.Rule),h+='" psg="',h+=d(n.PassengerType),h+='" shoprule="0-0">',h+=d(o.List_Rule),h+='</span><div style="display:none;"></div> </td> <td class="cols04"> ',n.AdultLegislationAmount>0&&!n.IsPackagePromotion&&(h+=' <div class="li_jia">&yen;<strong>',h+=d(n.OriginalSalesPrice),h+="</strong></div> "),h+=" ","Youth"==n.PassengerType||"Senior"==n.PassengerType?(h+=' <span class="sale" method="youth" passenger="',h+=d(n.PassengerType),h+='" aircorp="',h+=d(n.AirCorpCode),h+='"> ',h+=d(n.YouthSenior),h+="</span> "):(h+=" ",null!=n.ClassName&&""!=n.ClassName?(h+=' <span class="icon_bg01 ml5" method="class" flightno="',h+=d(n.FlightNumber),h+='" flightclass="',h+=d(n.FlightClassNumber),h+='"> ',"EN"==l.Language?(h+=" ",h+=d(n.ClassName),h+=" "):(h+=" ",h+=d(n.ClassName.substr(0,2)),h+=" "),h+="</span>","EN"!=l.Language&&(h+=d(n.ClassName.substr(2))),h+=" "):(h+=' <span class="tax"> ',h+=c(n.ClassTitle),h+="</span> ")),h+=' <span class="price">&yen;<strong method="tdMore">',h+=d(n.SalePrice),h+='</strong></span> </td> <td class="cols05"> ',n.IsShowCoupon){h+=" ";for(var p=0;p<n.CouponList.length;p++){h+=' <div class="icon_bg04" method="promotelist" pid="',h+=d(n.CouponList[p].Id),h+='" price="',h+=d(n.CouponList[p].SalePrice),h+='" isCoupon="1"> <span method="promotelist" promtype="',h+=d(n.CouponList[p].AirPromotionTypeID),h+='" pid="',h+=d(n.CouponList[p].Id),h+='" price="',h+=d(n.CouponList[p].SalePrice),h+='" isCoupon="1"> ',"EN"==l.Language&&(h+=d(o.CurrencyName)),h+=d(n.CouponList[p].SalePrice),"CN"==l.Language&&(h+=d(o.CurrencyName)),h+="</span> </div> ",n.CouponList[p].IsInproc&&(h+=' <div class="icon_',h+=d(n.CouponList[p].OrderFromId),h+='" method="',h+=d(n.CouponList[p].OrderFromId),h+='promotelist"></div> '),h+=" ",!n.IsDragonOnly&&n.CouponList[p].IsDragon&&a&&(a=!1,h+=' <div class="icon_bg_lc"> <span method="dragon"> ',h+=d(o.DragonOnly),h+="</span> </div> "),h+=" ";}h+=" ";}h+=" ";for(var p=0;p<n.CashList.length;p++){h+=' <div class="icon_bg04" method="promotelist" pid="',h+=d(n.CashList[p].Id),h+='" price="',h+=d(n.CashList[p].SalePrice),h+='"> <span method="promotelist" promtype="',h+=d(n.CashList[p].AirPromotionTypeID),h+='" pid="',h+=d(n.CashList[p].Id),h+='" price="',h+=d(n.CashList[p].SalePrice),h+='"> ',"EN"==l.Language&&(h+=d(o.CurrencyName)),h+=d(n.CashList[p].SalePrice),"CN"==l.Language&&(h+=d(o.CurrencyName)),h+="</span> </div> ",n.CashList[p].IsInproc&&(h+=' <div class="icon_',h+=d(n.CashList[p].OrderFromId),h+='" method="',h+=d(n.CashList[p].OrderFromId),h+='promotelist"></div> '),h+=" ",!n.IsDragonOnly&&n.CashList[p].IsDragon&&a&&(a=!1,h+=' <div class="icon_bg_lc"> <span method="dragon"> ',h+=d(o.DragonOnly),h+="</span> </div> "),h+=" ";}h+=" ",!n.IsOneHour&&n.IsPackagePromotion?(h+=' <div class="icon_bg02"><span method="BindInsuranceWithPackage">',h+=d(o.BindInsuranceWithPackage),h+="</span></div> "):!n.IsOneHour&&n.InsuranceProductId>0&&(h+=' <div class="icon_bg02"><span method="BindInsurance">',h+=d(o.BindInsuranceWithoutPackage),h+="</span></div> "),h+=" ",(n.PromotList.length>0||n.IsPreSale)&&(h+=" ",a&&n.PromotionDragon&&(h+=' <div class="icon_bg_lc"> <span method="dragon"> ',h+=d(o.DragonOnly),h+="</span> </div> "),h+=' <div class="icon_bg02 icon_hui"> <span method="promotions" pid="',h+=d(n.PromotList.join(",")),h+='" presale="',h+=d(n.IsPreSale),h+='" date="',h+=d(n.PreSaleDate),h+='" channel="',h+=d(n.IsWeb),h+='"> ',h+=d(o.Promotion),h+="</span></div> "),h+=" </td> ";var m=n.FlightNumber,g=n.FlightClassNumber,u=n.PromotionID;n.IsTransfer&&(m=n.FlightNumber+"-"+n.SecondFlightNumber,g=n.FlightClassNumber+"-"+n.SecondClassName),h+=' <td class="cols06"> <div style="height:32px;position:relative"> <input type="button" ',0==r?(h+=' class="button button_out" method="btnNoBooking" value="',h+=d(o.SoldOut),h+='" '):(h+=' class="button" method="btnBooking" value="',h+=d(o.Select),h+='" '),h+=' flightnum="',h+=d(m),h+='" flightclassnum="',h+=d(g),h+='" promotionid="',h+=d(u),h+='" itemid="',h+=d(n.Index),h+='" channel="',h+=d(n.Channel),h+='" onfocus="this.blur()" fareid="',h+=d(n.FareId),h+='" departtime="',h+=d(n.DepartureTime),h+='" price="',h+=d(n.SalePrice),h+='" totalfee="',h+=d(n.TotalFee),h+='" insuranceProductId="',h+=d(n.InsuranceProductId),h+='" onehour="',h+=d(n.IsOneHour),h+='"/> ',n.IsTiny&&(h+=' <span class="red"> ',h+=d(n.TicketCount),h+="</span> "),h+=' <span method="s2_loading" class="" style="display: none"></span></div> </td> </tr> ';}return h+=" </table>",new String(h);}),template("OneWay_Recommend",function(e,t){var i=this,s=e.showIcon,n=e.i,a=e.RecommendedFlights,r=e.leg,o=(e.itemId,e.ticketCount,e.departtime),l=void 0===e.Date?i.Date:e.Date,d=i.$jsonDateFormat,c=e.channel,p=e.uniqueKey,m=e.styleVal,g=e.SearchRequest,u=i.$escape,h=function(s,n){n=n||e;var a=i.$include(s,n,t);return L+=a,a;},v=(e.seg,e.context),S=e.moreCoupon,L="";L+=" ";var s=!0;for(n=0;n<a.length;n++){var r=a[n],o=(r.SegmentList[0].TicketCount,10000*new l(d(r.SegmentList[0].DepartureTime)).getTime()+6.21355968e+17),c="BSP";2==r.Channel&&(c="MU"),4==r.Channel&&(c="AirShopping"),6==r.Channel&&(c="Book51");var p="";p+=c,p+=r.SegmentList[0].FlightNumber,p+=r.SegmentList[0].FlightClass,p+=r.PromotionID,p+=r.SalePrice;var m="";g.AirCorp.length>0&&"0"!=g.AirCorp&&g.AirCorp!=r.SegmentList[0].AirCorpInfo.Code&&(m='style="display:none;"'),L+=' <div price="',L+=u(r.SalePrice),L+='" flighttime="',L+=u(o),L+='" flightno="',L+=u(r.SegmentList[0].FlightNumber),L+='" method="divBox" itemid="',L+=u(r.IndexByFlyType),L+='" aircorp="',L+=u(r.SegmentList[0].AirCorpInfo.Code),L+='" depart="',L+=u(r.SegmentList[0].DepartureAirPort),L+='" arrive="',L+=u(r.SegmentList[0].ArriveAirPort),L+='" time="',L+=u(o),L+='"> <div class="f-goto-div"> ',s&&(s=!1,L+=' <div class="tj_icon"> </div> '),L+=" ",h("./OneWay_SegmentInfo",{seg:r.SegmentList[0],context:v}),L+=' </div> <div class="fltable-div"> <table class="fltable"> ',h("./OneWay_SegmentPrice",{leg:r,context:v}),L+=' </table> <div method="divMore"> </div> <p class="lh"> <span method="loadding" style="display: none"></span><span class="pseudo_link" method="moreflight" itemid="',L+=u(r.IndexByFlyType),L+='" flightno="',L+=u(r.SegmentList[0].FlightNumber),L+='" channel="',L+=u(r.Channel),L+='" flightclass="',L+=u(r.SegmentList[0].FlightClassNumber),L+='" datacache="0" fareid="',L+=u(r.FareId),L+='" uniquekey="',L+=u(p),L+='"> ',L+=u(v.listResource.List_AllFlight),L+=u(S),L+='</span><span method="spanMore" itemid="',L+=u(r.IndexByFlyType),L+='" class="flight_down"></span> </p> </div> </div> ';}return new String(L);}),template("OneWay_ResultFilter",function(e){var t=this,i=t.$escape,s=e.context,n=e.SearchRequest,a=e.AirCorpList,r=e.i,o=e.airCorpInfo,l=e.DepartAirports,d=e.ArriveAirports,c=e.airport,p="";if(p+=' <div class="clx"> <dl class="clx"> <dt> ',p+=i(s.listResource.List_StopOverDTime),p+='</dt> <dd class="all on" method="allTime"> ',p+=i(s.listResource.Filter_No),p+='</dd> <dd> <input method="time" type="checkbox" id="time1" value="1" /><label for="time1">',p+=i(s.listResource.FlightTime1),p+='</label></dd> <dd> <input method="time" type="checkbox" id="time2" value="2" /><label for="time2">',p+=i(s.listResource.FlightTime2),p+='</label></dd> <dd> <input method="time" type="checkbox" id="time3" value="3" /><label for="time3">',p+=i(s.listResource.FlightTime3),p+='</label></dd> </dl> <dl class="clx"> <dt> ',p+=i(s.listResource.Filter_ClassType),p+='</dt> <dd> <input id="classY" name="Class" type="radio" method="ClassFilter" value="Y" ',"Y"==n.SeatLevel&&(p+="checked"),p+=' /><label for="classY">',p+=i(s.indexResource.Search_ClassType_Eco),p+='</label></dd> <dd> <input id="classS" name="Class" type="radio" method="ClassFilter" value="S" ',"S"==n.SeatLevel&&(p+="checked"),p+=' /><label for="classS">',p+=i(s.indexResource.Search_ClassType_EcoS),p+='</label></dd> <dd> <input id="classM" name="Class" type="radio" method="ClassFilter" value="M" ',"M"==n.SeatLevel&&(p+="checked"),p+=' /><label for="classM">',p+=i(s.indexResource.Search_ClassType_Othr),p+='</label></dd> </dl> </div> <div class="clx"> ',a.length>1){p+=' <dl class="clx airlines"> <dt> ',p+=i(s.listResource.Filter_AirCorp),p+='</dt> <dd class="all',p+=i("0"==n.AirCorp?" on":""),p+='" id="allAircorp" method="allAircorp"> ',p+=i(s.listResource.Filter_No),p+="</dd> ";for(var r=0;r<a.length;r++){var o=a[r];p+=' <dd> <input type="checkbox" method="aircorp" id="corp',p+=i(o.Code),p+='" ',n.AirCorp==o.Code&&(p+="checked"),p+=' value="',p+=i(o.Code),p+='" /><label for="corp',p+=i(o.Code),p+='">',p+=i(o.Name),p+="</label></dd> ";}p+=" </dl> ";}if(p+=" </div> ",l.length>1||d.length>1){if(p+=' <div class="clx"> <dl class="clx"> <dt> ',p+=i(s.listResource.Filter_FlyAircorp),p+='</dt> <dd class="all on" method="allDepartPort"> ',p+=i(s.listResource.Filter_No),p+="</dd> ",l.length>1){p+=" ";for(var r=0;r<l.length;r++){var c=l[r];p+=' <dd> <input id="departport',p+=i(c.Code),p+='" type="checkbox" method="departPort" value="',p+=i(c.Code),p+='" /><label for="departport',p+=i(c.Code),p+='">',p+=i(c.Name),p+="</label></dd> ";}p+=" ";}if(p+=" ",d.length>1){p+=" ";for(var r=0;r<d.length;r++){var c=d[r];p+=' <dd> <input id="arriveport',p+=i(c.Code),p+='" type="checkbox" method="arrivePort" value="',p+=i(c.Code),p+='" /><label for="arriveport',p+=i(c.Code),p+='">',p+=i(c.Name),p+="</label></dd> ";}p+=" ";}p+=" </dl> </div> ";}return p+=" ",new String(p);}),template("OneWay_SegmentInfo",function(e){var t=this,i=e.departHour,s=void 0===e.Date?t.Date:e.Date,n=t.$jsonDateFormat,a=e.seg,r=e.arriveHour,o=e.departureTime,l=e.arriveTime,d=e.duration,c=void 0===e.parseInt?t.parseInt:e.parseInt,p=t.$escape,m=e.context,g="";g+=" ";var i=new s(n(a.DepartureTime)).getHours(),r=new s(n(a.ArriveTime)).getHours(),o=n(a.DepartureTime,"shorttime"),l=n(a.ArriveTime,"shorttime"),d=c(a.FlightTime);return g+=' <table class="f-goto-table"> <tr> <td class="td1" width="32"> <span class="Airlines_',g+=p(a.AirCorpInfo.Code),g+=' icon_airline"></span> </td> <td class="td2" width="120"> ',g+=p(a.AirCorpInfo.ShortName),"EN"==m.Language?(g+="<br /> ",g+=p(a.FlightNumber),g+="&nbsp; ",g+=p(m.listResource.List_Data_PlaneType),g+='<span aircorp="',g+=p(a.AirCorpInfo.Code),g+='" method="PlanType" planetype="',g+=p(a.PlaneType),g+='">',g+=p(null==a.PlanTypeName||""==a.PlanTypeName?a.PlaneType:a.PlanTypeName),g+="</span> "):(g+="&nbsp;",g+=p(a.FlightNumber),g+="<br /> ","33V"==(""==a.PlanTypeName?a.PlaneType:a.PlanTypeName)?(g+='<span aircorp="',g+=p(a.AirCorpInfo.Code),g+='" method="PlanType" class="a33v" planetype="',g+=p(a.PlaneType),g+='"></span>'):"773"==(""==a.PlanTypeName?a.PlaneType:a.PlanTypeName)?(g+='<span aircorp="',g+=p(a.AirCorpInfo.Code),g+='" method="PlanType" class="boeing777" planetype="',g+=p(a.PlaneType),g+='"></span>'):"380"==(""==a.PlanTypeName?a.PlaneType:a.PlanTypeName)?(g+='<span aircorp="',g+=p(a.AirCorpInfo.Code),g+='" method="PlanType" class="a380" planetype="',g+=p(a.PlaneType),g+='"></span>'):(g+=p(m.listResource.List_Data_PlaneType),g+='<span class="pseudo_link" aircorp="',g+=p(a.AirCorpInfo.Code),g+='" method="PlanType" planetype="',g+=p(a.PlaneType),g+='">',g+=p(null==a.PlanTypeName||""==a.PlanTypeName?a.PlaneType:a.PlanTypeName),g+="</span>"),g+=" "),g+=' </td> <td class="td3"> <p class="time"> ',g+=p(o),g+="</p> ",g+=p(a.DepartureAirPortName),g+=p(a.DepartTermianlEN),g+=' </td> <td class="td4"> <p class="day">',i>r&&(g+=p(m.listResource.List_AddDay)),a.StopNumber>0&&(g+=' <span class="pseudo_link" method="StopOver" flightno="',g+=p(a.FlightNumber),g+='">',g+=p(m.listResource.List_StopOver),g+="</span>"),g+='</p> <div class="goto"> </div> <p> ',g+=p(m.listResource.FlightTimeFormat.replace("{0}",c(d/60)).replace("{1}",d%60)),g+='</p> </td> <td class="td5"> <p class="time"> ',g+=p(l),g+="</p> ",g+=p(a.ArriveAirPortName),g+=p(a.ArriveTermianlEN),g+=' </td> <td class="l_black"> ',g+=p(m.listResource.Taxfee),g+=p(a.AircorpFee.toFixed()),g+="+",g+=p(a.OilFee.toFixed()),g+=p(m.listResource.Dollar),g+=" </td> </tr> </table>",new String(g);}),template("OneWay_SegmentPrice",function(e,t){var i=this,s=e.ticketCount,n=e.leg,a=e.isLijian,r=e.isPackagePromotion,o=e.totalfee,l=e.departtime,d=void 0===e.Date?i.Date:e.Date,c=i.$jsonDateFormat,p=e.onehour,m=e.kseat,g=e.j,u=e.context,h=e.directFlag,v=e.channelString,S=i.$escape,L=function(s,n){n=n||e;var a=i.$include(s,n,t);return y+=a,a;},y=(e.searchIndex,"");y+=" ";for(var s=n.SegmentList[0].TicketCount,a=n.AdultLegislationAmount>0?!0:!1,r=n.IsPackagePromotion,o=n.SegmentList[0].OilFee+n.SegmentList[0].AircorpFee,l=10000*new d(c(n.SegmentList[0].DepartureTime)).getTime()+6.21355968e+17,p=!1,m=!1,g=0;g<n.ProductTypes.length;g++){p=p||3==n.ProductTypes[g]&&"CN"==u.Language,m=m||1==n.ProductTypes[g];}var h="direct";0!=n.SegmentList[0].TicketStatus&&(h+="-"+n.SegmentList[0].TicketCount);var v="BSP";return 2==n.Channel&&(v="MU"),4==n.Channel&&(v="AirShopping"),6==n.Channel&&(v="Book51"),y+=' <tbody> <tr> <td class="cols01"> ',p&&(y+=' <div class="icon_bg03"> <span method="onehour"> ',y+=S(u.listResource.Tag_OneHour),y+=" </span> </div> "),y+=" ",m&&(y+=' <div class="icon_bg03"> <span method="kseat"> ',y+=S(u.listResource.Tag_KSeat),y+="</span></div> "),y+=" ",2==n.Channel&&(y+=' <div class="icon_bg03"> <span method="Channel_MU"> ',y+=S(u.listResource.Channel_MU),y+="</span></div> "),y+=" ",6==n.Channel&&(y+=' <div class="icon_bg05"> <span method="Channel_Book51"> ',y+=S(u.listResource.Book51),y+="</span><em>\u4ee3\u7406</em></div> "),y+=' </td> <td class="cols02"> ',L("./OneWay_Mileage",{leg:n,context:u}),y+=' </td> <td class="cols03"> ',L("./List_Rule",{leg:n,context:u}),y+=' </td> <td class="cols04"> ',a&&!r&&(y+=' <div class="li_jia"> &yen;<strong>',y+=S(n.OriginalSalesPrice),y+="</strong></div> "),y+=" ",L("./List_Price",{leg:n,context:u,searchIndex:1}),y+=' </td> <td class="cols05"> ',L("./List_Promotions",{leg:n,context:u}),y+=' </td> <td class="cols06"> <div style="height: 32px; position: relative"> <input type="button" method="btnBooking" name="',y+=S(h),y+='" class="button" itemid="',y+=S(n.IndexByFlyType),y+='" flightnum="',y+=S(n.SegmentList[0].FlightNumber),y+='" fareid="',y+=S(n.FareId),y+='" flightclassnum="',y+=S(n.SegmentList[0].FlightClassNumber),y+='" promotionid="',y+=S(n.PromotionID),y+='" value="',y+=S(u.listResource.Select),y+='" onehour="',y+=S(p),y+='" onfocus="this.blur()" departtime="',y+=S(l),y+='" channel="',y+=S(v),y+='" price="',y+=S(n.SalePrice),y+='" totalfee="',y+=S(o),y+='" insuranceproductid="',y+=S(n.InsuranceProductId),y+='" /> ',2==n.SegmentList[0].TicketStatus&&(y+=' <span class="red"> ',y+=S(u.listResource.Tag_Tight.replace("{0}",s)),y+="</span> "),y+=" </div> </td> </tr> </tbody> ",new String(y);}),template("OneWay_SegmentSoldout",function(e,t){var i=this,s=e.isLijian,n=e.leg,a=e.isPackagePromotion,r=e.ticketCount,o=e.departtime,l=void 0===e.Date?i.Date:e.Date,d=i.$jsonDateFormat,c=e.onehour,p=e.kseat,m=e.j,g=e.context,u=e.channel,h=i.$escape,v=function(s,n){n=n||e;var a=i.$include(s,n,t);return C+=a,a;},S=(e.searchIndex,e.directFlag),L=e.oilfee,y=e.fee,f=e.totalfee,C="";C+=" ";for(var s=n.AdultLegislationAmount>0?!0:!1,a=n.IsPackagePromotion,r=n.SegmentList[0].TicketCount,o=10000*new l(d(n.SegmentList[0].DepartureTime)).getTime()+6.21355968e+17,c=!1,p=!1,m=0;m<n.ProductTypes.length;m++){c=c||3==n.ProductTypes[m]&&"CN"==g.Language,p=p||1==n.ProductTypes[m];}var u="BSP";if(2==n.Channel&&(u="MU"),4==n.Channel&&(u="AirShopping"),6==n.Channel&&(u="Book51"),C+=' <tr method="recommand"> <td class="cols01"> ',c&&(C+=' <div class="icon_bg03"> <span method="onehour"> ',C+=h(g.listResource.Tag_OneHour),C+=" </span> </div> "),C+=" ",p&&(C+=' <div class="icon_bg03"> <span method="kseat"> ',C+=h(g.listResource.Tag_KSeat),C+="</span></div> "),C+=" ",2==n.Channel&&(C+=' <div class="icon_bg03"> <span method="Channel_MU"> ',C+=h(g.listResource.Channel_MU),C+="</span></div> "),C+=" ",6==n.Channel&&(C+=' <div class="icon_bg05"> <span method="Channel_Book51"> ',C+=h(g.listResource.Book51),C+="</span><em>\u4ee3\u7406</em></div> "),C+=' </td> <td class="cols02"> ',v("./OneWay_Mileage",{leg:n,context:g}),C+=' </td> <td class="cols03"> ',v("./List_Rule",{leg:n,context:g}),C+=' </td> <td class="cols04"> ',s&&!a&&(C+=' <div class="li_jia"> &yen;<strong>',C+=h(n.OriginalSalesPrice),C+="</strong></div> "),C+=" ",v("./List_Price",{leg:n,context:g,searchIndex:1}),C+=' </td> <td class="cols05"> ',v("./List_Promotions",{leg:n,context:g}),C+=' </td> <td class="cols06"> <div style="height: 32px; position: relative"> ',0>=r){C+=' <input type="button" class="button button_out" method="btnNoBooking" value="',C+=h(g.listResource.SoldOut),C+='" /> ';}else{var S="direct";0!=n.SegmentList[0].TicketStatus&&(S+="-"+n.SegmentList[0].TicketCount);var L=n.SegmentList[0].OilFee,y=n.SegmentList[0].AircorpFee,f=L+y;C+=' <input type="button" method="btnBooking" name="',C+=h(S),C+='" class="button" itemid="',C+=h(n.IndexByFlyType),C+='" flightnum="',C+=h(n.SegmentList[0].FlightNumber),C+='" fareid="',C+=h(n.FareId),C+='" flightclassnum="',C+=h(n.SegmentList[0].FlightClassNumber),C+='" promotionid="',C+=h(n.PromotionID),C+='" value="',C+=h(g.listResource.Select),C+='" onehour="',C+=h(c),C+='" onfocus="this.blur()" departtime="',C+=h(o),C+='" channel="',C+=h(u),C+='" price="',C+=h(n.SalePrice),C+='" totalfee="',C+=h(f),C+='" insuranceproductid="',C+=h(n.InsuranceProductId),C+='" /> ',2==n.SegmentList[0].TicketStatus&&(C+=' <span class="red"> ',C+=h(g.listResource.Tag_Tight.replace("{0}",r)),C+="</span> "),C+=" ";}return C+=" </div> </td> </tr> ",new String(C);}),template("OneWay_SelloutFlight",function(e,t){var i=this,s=e.legListCount,n=e.FlightLegList,a=e.recommendedCount,r=e.RecommendedFlights,o=e.showIcon,l=e.i,d=e.SelloutFlights,c=e.leg,p=e.channel,m=e.uniqueKey,g=i.$escape,u=function(s,n){n=n||e;var a=i.$include(s,n,t);return L+=a,a;},h=(e.seg,e.context),v=(e.isLijian,e.isPackagePromotion,e.j),S=e.k,L=(e.searchIndex,"");L+=" ";var s=n.length,a=r.length,o=!0;L+=' <div class="flightlist flightlist_out"> ';for(var l=0;l<d.length;l++){var c=d[l],p="BSP";2==c.Channel&&(p="MU"),4==c.Channel&&(p="AirShopping"),6==c.Channel&&(p="Book51");var m="";m+=p,m+=c.SegmentList[0].FlightNumber,m+=c.SegmentList[0].FlightClass,m+=c.PromotionID,m+=c.SalePrice,L+=' <div price="',L+=g(c.SalePrice),L+='" flighttime="',L+=g(c.SegmentList[0].DepartureTime),L+='" flightno="',L+=g(c.SegmentList[0].FlightNumber),L+='" method="divBox" itemid="',L+=g(s+a+c.IndexByFlyType),L+='"> <div class="f-goto-div"> ',o&&(o=!1,L+=' <div class="out_icon"> </div> '),L+=" ",u("./OneWay_SegmentInfo",{seg:c.SegmentList[0],context:h}),L+=' </div> <div class="fltable-div"> <table class="fltable"> ';c.AdultLegislationAmount>0?!0:!1,c.IsPackagePromotion;L+=' <tr> <td class="cols01"> ';for(var v=0;S<c.ProductTypes.length;v++){3==c.ProductTypes[v]&&"CN"==h.Language&&(L+=' <div class="icon_bg03"> <span method="onehour"> ',L+=g(h.listResource.Tag_OneHour),L+=" </span> </div> "),L+=" ",1==c.ProductTypes[v]&&(L+=' <div class="icon_bg03"> <span method="kseat"> ',L+=g(h.listResource.Tag_KSeat),L+="</span></div> ");}L+=" ",2==c.Channel&&(L+=' <div class="icon_bg03"> <span method="Channel_MU"> ',L+=g(h.listResource.Channel_MU),L+="</span></div> "),L+=" ",6==c.Channel&&(L+=' <div class="icon_bg05"> <span method="Channel_Book51"> ',L+=g(h.listResource.Book51),L+="</span><em>\u4ee3\u7406</em></div> "),L+=' </td> <td class="cols02"> ',u("./OneWay_Mileage",{leg:c,context:h}),L+=' </td> <td class="cols03"> ',u("./List_Rule",{leg:c,context:h}),L+=' </td> <td class="cols04"> ',u("./List_Price",{leg:c,context:h,searchIndex:1}),L+=' <br /> </td> <td class="cols05"> ',u("./List_Promotions",{leg:c,context:h}),L+=' </td> <td class="cols06"> <div style="height: 32px; position: relative"> <input type="button" class="button button_out" method="btnNoBooking" value="',L+=g(h.listResource.SoldOut),L+='" /> </div> </td> </tr> </table> <div method="divMore"> </div> <p class="lh"> <span method="loadding" style="display: none"></span><span class="pseudo_link" method="moreflight" itemid="',L+=g(s+a+c.IndexByFlyType),L+='" flightno="',L+=g(c.SegmentList[0].FlightNumber),L+='" channel="',L+=g(c.Channel),L+='" flightclass="',L+=g(c.SegmentList[0].FlightClassNumber),L+='" datacache="0" fareid="',L+=g(c.FareId),L+='" uniquekey="',L+=g(m),L+='"> ',L+=g(h.listResource.List_AllFlight),L+='</span><span method="spanMore" itemid="',L+=g(s+a+c.IndexByFlyType),L+='" class="flight_down"></span></p> </div> </div> ';}return L+=" </div> ",new String(L);}),"function"==typeof define?define(function(){return template;}):"undefined"!=typeof exports?module.exports=template:global.template=template;}(this);var ListResultClient=Elong.Page.ListResultClient=Class.create();Object.extend(ListResultClient.prototype,{name:"ListResultClient",initialize:function(){this.initializeDOM();this.initializeServerData();this.initializeEvent();this.render();},initializeDOM:function(){this.DataTitle=$("ul.flight_title");this.DataList=$("#DataList");this.DataList_Transfer=$("#DataList_Transfer");this.OrderList=$("div[method='OrderField']");this.ContentEnd=$("#m_contentend");this.Scroll=$("#scrolltop");this.FlightOneWayListYDay=new Template(OneWayController.UrlConfig.Flight_Result_OneWayseoyday.replace(/{/g,"#{"));this.FlightOneWayListSDay=new Template(OneWayController.UrlConfig.Flight_Result_OneWayseosday.replace(/{/g,"#{"));this.FlightOneWayListMDay=new Template(OneWayController.UrlConfig.Flight_Result_OneWayseomday.replace(/{/g,"#{"));this.ClassCache={};this.PlanTypes={};this.MileageDescriptions={};},initializeServerData:function(){this.resource=OneWayController.Resources;this.context={Language:OneWayController.Language,WebCategory:OneWayController.WebCategory,OrderFromId:OneWayController.OrderFromId,Controller:OneWayController,listResource:listResource,indexResource:indexResource};},initializeEvent:function(){this.DataTitle.bind("click",this.DataListOnClick.bindAsEventListener(this));this.DataList.bind("click",this.DataListOnClick.bindAsEventListener(this));this.DataList.bind("mouseover",this.DataListOnMouseOver.bindAsEventListener(this));this.DataList.bind("mouseout",this.DataListOnMouseOut.bindAsEventListener(this));this.DataList.bind("mouseup",this.DataListOnMouseUp.bindAsEventListener(this));this.ContentEnd.bind("mouseover",this.DataListOnMouseOver.bindAsEventListener(this));this.OrderList.bind("click",this.OrderListOnClick.bindAsEventListener(this));$("#emergency span.close").click(function(){$("#emergency").slideUp();});},ScrollTop:function(a){return{init:function(){if($(window).scrollTop()>0){a.show();}},scrollTops:function(){if($(window).scrollTop()>0){a.fadeIn();}else{a.fadeOut();}},start:function(){a.click(function(c){$(window).scrollTop(0);c.preventDefault();});if($(window).scrollTop()>0){a.show();}$(window).resize(function(){var c=!!window.ActiveXObject;var b=c&&!window.XMLHttpRequest;if(!b){this.init();}}.bind(this));$(window).scroll(function(){var c=!!window.ActiveXObject;var b=c&&!window.XMLHttpRequest;if(!b){this.init();}this.scrollTops();}.bind(this));}};},Channel_MUMouseOver:function(b){var a=Event.element(b);if(this.listWindow!=null){this.listWindow.close();}this.listWindow=new TipWindow({eventElement:a,width:240,defer:false,buildHtmlContent:function(c){c.htmlContent=this.resource.Channel_MU_Description;c.show();}.bind(this)});},Channel_Book51MouseOver:function(b){var a=Event.element(b);if(this.listWindow!=null){this.listWindow.close();}this.listWindow=new TipWindow({eventElement:a,width:240,defer:false,buildHtmlContent:function(c){c.htmlContent=this.resource.Channel_Book51_Description;c.show();}.bind(this)});},DataListOnMouseOver:function(e){var d=Event.element(e);var k=d.attr("method");switch(k){case"PlanType":this.PlanTypeOnClick(d);break;case"kseat":if(this.listWindow!=null){this.listWindow.close();}this.listWindow=new TipWindow({eventElement:d,width:240,defer:false,buildHtmlContent:function(w){if(OneWayController.Language=="CN"){w.htmlContent="可申请特惠机票可能因为航空公司供座位有限无法申请下来，艺龙会尽量为您争取；如果没有申请到机票我们会及时联系您。可申请折扣机票必须当日出票，信用卡支付。";}else{w.htmlContent="'Discounts may apply' tickets are subject to availability due to the airlines' limited seats supply. We will contact you timely if we fail to apply this price for you. 'Discounts may apply' tickets must be PAID and ISSUED on the same day of the booking.";}w.show();}});break;case"china":if(this.listWindow!=null){this.listWindow.close();}this.listWindow=new TipWindow({eventElement:d,width:240,defer:false,buildHtmlContent:function(w){if(OneWayController.Language=="CN"){w.htmlContent="根据航空公司政策，本舱位仅限中国大陆居民预订。 ";w.show();}}});break;case"onehour":if(this.listWindow!=null){this.listWindow.close();}this.listWindow=new TipWindow({eventElement:d,width:240,defer:false,buildHtmlContent:function(w){if(OneWayController.Language=="CN"){w.htmlContent="请在起飞前1小时完成预订，只接受国内信用卡支付。";w.show();}}});break;case"BindInsurance":var o=d.parents("tr").find("td[class='cols06']").find("input").attr("price");if(o!="undefined"){o=parseInt(o)+20;}if(this.listWindow!=null){this.listWindow.close();}this.listWindow=new TipWindow({eventElement:d,width:240,defer:false,buildHtmlContent:function(w){w.htmlContent=String.format(this.resource.BindInsurance_Tip,o);w.show();}.bind(this)});break;case"BindInsuranceWithPackage":if(this.listWindow!=null){this.listWindow.close();}this.listWindow=new TipWindow({eventElement:d,width:240,defer:false,buildHtmlContent:function(w){w.htmlContent=this.resource.PackageBindInsurance_Tip.toString();w.show();}.bind(this)});break;case"promotelist":this.ShowPromoteList(d);break;case"promotions":var m=d.attr("pid");var n=d.attr("presale");var c=d.attr("date");var b=d.attr("channel");if(this.listWindow!=null){this.listWindow.close();}this.listWindow=new TipWindow({eventElement:d,width:240,defer:true,buildHtmlContent:function(w){OneWayController.GetPromotions(m,(n==1),c,b,function(A){if(A.success){var y="<div>";var C="<div class='icon_bg03'><span>{0}</span></div><br/><p class='l_black mb10'>{1}</p>";for(var z=0;z<A.value.length;z++){var B=A.value[z].Title;var x=A.value[z].Desc;y+=String.format(C,B,x);}y+="</div>";w.htmlContent=y;w.show();}}.bind(this),true);}});break;case"qqpromotelist":if(this.listWindow!=null){this.listWindow.close();}this.listWindow=new TipWindow({eventElement:d,width:240,defer:false,buildHtmlContent:function(w){w.htmlContent="QQ会员专享";w.show();}});break;
case"flightrule":this.FlightRestriction(d);break;
case"StopOver":var g=d.attr("flightno");this.StopOver(g,d);break;
case"Channel_MU":this.Channel_MUMouseOver(e);break;case"Channel_Book51":this.Channel_Book51MouseOver(e);break;
case"class":var g=d.attr("flightno");var f=d.attr("flightclass");this.ClassName(g,f,d);break;
case"presale":if(this.listWindow!=null){this.listWindow.close();}this.listWindow=new TipWindow({eventElement:d,width:240,defer:false,buildHtmlContent:function(w){w.htmlContent=d.next().html();w.show();}});break;case"dragon":if(this.listWindow!=null){this.listWindow.close();}this.listWindow=new TipWindow({eventElement:d,width:240,defer:false,buildHtmlContent:function(w){w.htmlContent=this.resource.DragonTip;w.show();}.bind(this)});break;case"Mileage":this.ShowMileageDescription(d);break;case"divBox":d.addClass("bg");break;
case"btnBooking":var p=d.attr("price");var s=d.attr("totalfee");var l=d.attr("onehour").toLowerCase();var j=d.attr("insuranceProductId");var v=parseInt(p)+parseInt(s);var u=parseInt(p)+parseInt(s);if(l=="false"){u+=20;}var r;var i;var q;var t;var h;var a;if(OneWayController.Language=="CN"){r="票价";i="保险";q="税费";t="总价";h="份";a="可选";}else{r="ticket";i="Insurance";q="Tax&Fee";t="TotalPrice";h="copy";a="optional";}if(j>0){d.before('<div class="pricebox" method="divPriceBox"><i></i><span class="total">'+t+' ¥<span class="price">'+v+'</span><br><br></span><span class="detail">'+r+" ¥"+p+"<br>"+q+" ¥"+s+(l=="true"?"":"<br>"+i+"&nbsp;1&nbsp;"+h)+"</span></div>");}else{d.before('<div class="pricebox" method="divPriceBox"><i></i><span class="total">'+t+' ¥<span class="price">'+u+'</span><br><br></span><span class="detail">'+r+" ¥"+p+"<br>"+q+" ¥"+s+(l=="true"?"":"<br>"+i+" ¥20("+a+")")+"</span></div>");}d.attr("class","button_on");break;case"btnNoBooking":d.before('<div class="pricebox"><i></i>'+this.resource.BookTip_Sellout+"</div>");break;default:break;}},
DataListOnMouseOut:function(b){var a=Event.element(b);var c=a.attr("method");switch(c){case"PlanType":case"china":case"qqpromotelist":case"flightrule":case"Mileage":case"StopOver":case"class":this.ContentEnd.html("");break;case"divBox":a.removeClass("bg");break;case"btnBooking":$("div[method='divPriceBox']").remove();a.attr("class","button");break;case"btnNoBooking":a.prev().remove();break;case"promotelist":if(a.attr("isCoupon")!="1"){this.ContentEnd.html("");}break;default:break;}},DataListOnMouseUp:function(b){var a=Event.element(b);var c=a.attr("method");switch(c){case"btnBooking":$("#bookLoading").remove();a.after('<span id="bookLoading" class="s2_loading"></span>');break;default:break;}},ShowPromoteList:function(a){var b=a.attr("pid");var c=a.attr("price");if(this.listWindow!=null){this.listWindow.close();}this.listWindow=new TipWindow({eventElement:a,width:240,defer:true,buildHtmlContent:function(d){FlightAjaxController.GetPromotInfo(b,function(e){if(e.success){d.htmlContent=e.value.toString().replace("#price#",c);d.show();}}.bind(this),true);}});},DataListOnClick:function(d){var c=Event.element(d);var i=c.attr("method");switch(i){case"fly":case"price":$("div.flightlist_tj").hide();c.addClass("cur");var j=new Array();if(i=="fly"){this.DataTitle.find("li[method='price']").removeClass("cur");OneWayController.SearchRequest.OrderBy="DepartureTime";j.push("flighttime");j.push("price");}else{this.DataTitle.find("li[method='fly']").removeClass("cur");OneWayController.SearchRequest.OrderBy="Price";j.push("price");j.push("flighttime");}this.selectSort(this.DivArray,j);$("#flightlist").append($(this.DivArray));break;case"btnBooking":if(!c.attr("disabled")){var g=c.attr("flightnum");var f=c.attr("flightclassnum");var e=c.attr("fareid");var b=c.attr("departtime");var k=c.attr("price");var a=c.attr("channel");var l=c.attr("promotionid");this.BookingOrder(g,f,e,c,b,k,a,l);}break;case"moreflight":this.MoreFlight(c);break;case"moreflight_transfer":this.MoreFlight_Transfer(c);break;case"showchange":var h=c.attr("itemid");if(this.tipWindow!=null){this.tipWindow.close();}this.tipWindow=new TipWindow({htmlContent:'<div id="divTip">'+$("div[method='ChangeTurn'][itemid='"+h+"']").html()+"</div>",eventElement:c,width:700});$("#divTip").bind("click",this.ChangeTurnClick.bindAsEventListener(this));break;case"moretrans":if(this.DataList_Transfer.find("div[id='fpagebox']").find("span:eq(0)").attr("class")=="flight_down"){this.DataList_Transfer.find("div[id='fpagebox']").find("a:eq(0)").text(this.resource.TransferLeg_More_Up);this.DataList_Transfer.find("div[id='fpagebox']").find("span:eq(0)").removeClass().addClass("flight_top");this.DataList_Transfer.find("li[method='divBox']").show();}else{this.DataList_Transfer.find("div[id='fpagebox']").find("a:eq(0)").text(this.resource.TransferLeg_More);this.DataList_Transfer.find("div[id='fpagebox']").find("span:eq(0)").removeClass().addClass("flight_down");this.DataList_Transfer.find("li[method='divBox']:gt(0)").hide();}break;default:break;}},MoreFlight_ShowFlight:function(c,b){var a=this.DataList.find("div[method='divBox'][itemid='"+c+"']");var d=a.find("div[method='divMore']");var e=a.find("tr[method='recommand']");var f=a.find("p[method='young']");if(b){e.hide();f.hide();d.show();a.find("span[method='spanMore']").attr("class","flight_top");}else{d.hide();e.show();f.show();a.find("span[method='spanMore']").attr("class","flight_down");}},HideMoreFlight:function(){this.DataList.find("span[method='spanMore'][class='flight_top']").each(function(b){var c=$(this).attr("itemid");var a=$("#DataList").find("div[method='divBox'][itemid='"+c+"']");a.find("span[method='spanMore']").attr("class","flight_down");a.find("div[method='divMore']").hide();a.find("tr[method='recommand']").show();a.find("p[method='young']").show();});},MoreFlight:function(c){var g=c.attr("itemid");var f=c.attr("flightNo");var e=c.attr("flightclass");var b=c.attr("datacache");var d=c.attr("fareid");var a=c.attr("channel");var h=c.attr("uniqueKey");if($("div[method='divBox'][itemid='"+g+"'] span[method='spanMore']").attr("class")=="flight_down"){if(b=="1"){this.HideMoreFlight();this.MoreFlight_ShowFlight(g,true);}else{c.prev("span[method='loadding']").addClass("s_loading").show();c.hide();c.next("span").hide();OneWayController.GetMorePrices(OneWayController.SearchRequest,f,e,d,a,h,function(k){if(k.success){this.HideMoreFlight();var j=new Object();j.list=k.value;j.context=this.context;var i=template("OneWay_MoreFlight",j);this.DataList.find("div[method='divBox'][itemid='"+g+"'] div[method='divMore']").html(i);this.MoreFlight_ShowFlight(g,true);$("div[method='divBox'][itemid='"+g+"']").find("span[method='moreflight']").each(function(){$(this).attr("datacache","1");});}c.prev("span[method='loadding']").addClass("").hide();c.show();c.next("span").show();}.bind(this),false,"POST");}}else{this.MoreFlight_ShowFlight(g,false);}},MoreFlight_ShowFlight_Transfer:function(c,b){var a=this.DataList_Transfer.find("li[method='divBox'][itemid='"+c+"']");if(b){a.find("span[method='spanMore']").attr("class","flight_top");a.find("ul").show();}else{a.find("span[method='spanMore']").attr("class","flight_down");a.find("ul").hide();}},HideMoreFlight_Transfer:function(){this.DataList_Transfer.find("span[method='spanMore'][class='flight_top']").each(function(b){var c=$(this).attr("itemid");var a=$("#DataList_Transfer li[method='divBox'][itemid='"+c+"']");a.find("span[method='spanMore']").attr("class","flight_down");a.find("ul").hide();});},MoreFlight_Transfer:function(c){var g=c.attr("itemid");var f=c.attr("flightNo");var e=c.attr("flightclass");var b=c.attr("datacache");var d=c.attr("fareid");var a=c.attr("channel");var h=c.attr("uniqueKey");if(this.DataList_Transfer.find("li[method='divBox'][itemid='"+g+"'] span[method='spanMore']").attr("class")=="flight_down"){if(b=="1"){this.HideMoreFlight_Transfer();this.MoreFlight_ShowFlight_Transfer(g,true);}else{c.prev("span[method='loadding']").addClass("s_loading").show();c.hide();c.next("span[method='spanMore']").hide();OneWayController.GetMorePrices(OneWayController.SearchRequest,f,e,d,a,h,function(k){if(k.success){this.HideMoreFlight_Transfer();var j=new Object();j.list=k.value;j.context=this.context;var i=template("OneWay_MoreFlight",j);this.DataList_Transfer.find("li[method='divBox'][itemid='"+g+"'] div[method='divMore']").html(i);this.MoreFlight_ShowFlight_Transfer(g,true);c.attr("datacache","1");}c.prev("span[method='loadding']").addClass("").hide();c.show();c.next("span[method='spanMore']").show();}.bind(this),false,"POST");}}else{this.MoreFlight_ShowFlight_Transfer(g,false);}},BookingOrder:function(i,h,g,f,e,j,d,m){f.next().show();var c="";var b="";var a="";var l=0;if(OneWayController.IsSupportContrast){var k=0;this.DataList.find("#flightlist >div[method='divBox']").each(function(){var s=$(this).attr("flighttime");var r=$(this).attr("price");var q=$(this).attr("flightno");var n=$(this).find("input[method='btnBooking']").eq(0);var p=$(n).attr("fareid");var o=$(n).attr("flightclassnum");if(Math.abs(e-s)<=72000000000){if((j-r)>0){l++;}if((j-r)>k){c=q;b=o;a=p;k=Math.abs(j-r);}}});}$("#fillOrderForm input[name='flightnum']").val(i);$("#fillOrderForm input[name='classno']").val(h);$("#fillOrderForm input[name='channel']").val(d);$("#fillOrderForm input[name='fareid']").val(g);$("#fillOrderForm input[name='promotionid']").val(m);$("#fillOrderForm input[name='price']").val(j);$("#fillOrderForm input[name='cflightnum']").val(c);$("#fillOrderForm input[name='cclassno']").val(b);$("#fillOrderForm input[name='cfareid']").val(a);$("#fillOrderForm input[name='cpricedeffcount']").val(l);$("#fillOrderForm").submit();},ChangeTurnClick:function(b){var a=Event.element(b);var f=a.attr("method");switch(f){case"btnChange":var e=a.attr("itemid");var g=a.attr("segid");var d=a.attr("flightnum");var c=a.attr("flightclassnum");var h=$("li[method='divBox'][itemid='"+e+"'] table[method='Turn']");h.find("td.cols02").html($("#divTip tr[segid='"+g+"']").find("td:eq(1)").html());h.find("td.cols01").html($("#divTip tr[segid='"+g+"']").find("td:eq(2)").html());h.find("td.cols03").html($("#divTip tr[segid='"+g+"']").find("td:eq(3)").html());h.next().html($("#divTip tr[segid='"+g+"']").find("p.huafei").html());h.prev().find("span.zz_icon span").html($("#divTip tr[segid='"+g+"']").find("div.ift_zz_bj").html());$("li[method='divBox'][itemid='"+e+"'] input[type='button'][method='btnBooking']").attr("flightnum",d).attr("flightclassnum",c);if(this.tipWindow!=null){this.tipWindow.close();}break;}},PlanTypeOnClick:function(b){var d=b.attr("planetype");var a=b.attr("aircorp");var c=OneWayController.Language.toLowerCase();if(this.PlanTypes[c+"_"+a+"_"+d]){if(this.listWindow!=null){this.listWindow.close();}this.listWindow=new TipWindow({eventElement:b,width:379,defer:false,htmlContent:this.PlanTypes[c+"_"+a+"_"+d]});}else{FlightAjaxController.GetPlaneType(d,a,function(g){if(g.success){var f='<ul><li><b>{0}</b></li><li>{1}</li><li style="display:{3}"><img  src="{2}" width="310" height="240"  alt="" /></li></ul>';var e=g.value!=null?String.format(f,g.value.Name,g.value.Tip,g.value.PlaneImage,"block"):String.format(f,FlightAjaxController.Resources.PlanType_NoPlan,"","#","none");if(this.listWindow!=null){this.listWindow.close();}this.listWindow=new TipWindow({eventElement:b,width:379,defer:false,htmlContent:e});this.PlanTypes[c+"_"+a+"_"+d]=e;}}.bind(this),true);}},OrderListOnClick:function(evt){var element=Event.element(evt);var method=element.attr("method");switch(method){case"ClassFilter":var urlTeml=this.FlightOneWayListYDay;switch(element.val()){case"S":OneWayController.SearchRequest.SeatLevel="S";urlTeml=this.FlightOneWayListSDay;break;case"M":OneWayController.SearchRequest.SeatLevel="M";urlTeml=this.FlightOneWayListMDay;break;default:OneWayController.SearchRequest.SeatLevel="Y";urlTeml=this.FlightOneWayListYDay;break;}var dayCount=OneWayController.SearchRequest.DayCount;var url=urlTeml.eval({language:OneWayController.Language.toLowerCase(),departcitynameen:OneWayController.SearchRequest.DepartCityNameEn.toLowerCase().replace(/\'/g,""),arrivecitynameen:OneWayController.SearchRequest.ArriveCityNameEn.toLowerCase().replace(/\'/g,""),daycount:dayCount});window.location=url;break;case"departPort":case"arrivePort":case"aircorp":this.FilterFlightMethod();break;case"time":this.FilterFlightMethod();var orderFields=new Array();this.DataTitle.find("li[method='fly']").addClass("cur");this.DataTitle.find("li[method='price']").removeClass("cur");OneWayController.SearchRequest.OrderBy="DepartureTime";orderFields.push("flighttime");orderFields.push("price");this.selectSort(this.DivArray,orderFields);$("#flightlist").append($(this.DivArray));break;case"allAircorp":$("input[method='aircorp']:checked").each(function(){$(this).attr("checked",false);});this.FilterFlightMethod();break;case"allDepartPort":$("input[method='departPort']:checked").each(function(){$(this).attr("checked",false);});$("input[method='arrivePort']:checked").each(function(){$(this).attr("checked",false);});this.FilterFlightMethod();break;case"allTime":$("input[method='time']:checked").each(function(){$(this).attr("checked",false);});this.FilterFlightMethod();break;default:break;}},FilterFlightMethod:function(){var a="";var c="";var b="";var d="";$("input[method='aircorp']:checked").each(function(){if(a.length>0){a+=",";}a+=$(this).val();});if(a==""){$("dd[method='allAircorp']").addClass("on");}else{$("dd[method='allAircorp']").removeClass("on");}$("input[method='departPort']:checked").each(function(){if(c.length>0){c+=",";}c+=$(this).val();});$("input[method='arrivePort']:checked").each(function(){if(b.length>0){b+=",";}b+=$(this).val();});if(c==""&&b==""){$("dd[method='allDepartPort']").addClass("on");}else{$("dd[method='allDepartPort']").removeClass("on");}$("input[method='time']:checked").each(function(){if(d.length>0){d+=",";}d+=$(this).val();});if(d==""){$("dd[method='allTime']").addClass("on");}else{$("dd[method='allTime']").removeClass("on");}$("div.tj_flightlist").hide();this.DataList.find("#flightlist >div[method='divBox']").each(function(){if((a==""||a.indexOf($(this).attr("aircorp"))>=0)&&(c==""||c.indexOf($(this).attr("depart"))>=0)&&(b==""||b.indexOf($(this).attr("arrive"))>=0)&&(d==""||d.indexOf($(this).attr("time"))>=0)){$(this).show();}else{$(this).hide();}});$("span[method='flightcount']").html(this.DataList.find("#flightlist >div[method='divBox']:visible").length);if(this.DataList.find("#flightlist >div[method='divBox']:visible").length==0){$("#dvNoResult").show();}else{$("#dvNoResult").hide();}},itemComparer:function(a,b,c,d){var f=false;var e=c[0];var g="";if(c.length>1){g=c[1];}switch(d){case"desc":f=parseInt(a.attr(e))>parseInt(b.attr(e));break;case"asc":f=parseInt(a.attr(e))<parseInt(b.attr(e));break;}if(f){return 1;}if(!f&&parseInt(a.attr(e))==parseInt(b.attr(e))){f=parseInt(a.attr(g))<parseInt(b.attr(g));if(f){return 1;}else{return 0;}}return -1;},selectSort:function(a,f){if(a.length>100){return a;}var h;for(var c=0;c<a.length;c++){var e=c;for(var d=c+1;d<a.length;d++){var g=false;if(g){break;}var b=this.itemComparer($(a[d]),$(a[e]),f,"asc");switch(b){case 1:h=a[d];a[d]=a[e];a[e]=h;g=true;break;case -1:g=true;break;}}}return a;},ClassName:function(c,b,a){if(this.ClassCache[c+b]){if(this.listWindow!=null){this.listWindow.close();}this.listWindow=new TipWindow({htmlContent:"<div >"+this.ClassCache[c+b]+"</div>",eventElement:a,defer:false,width:240});}else{FlightAjaxController.ClassDescription(c,b,OneWayController.SearchRequest,0,function(d){if(d.success){if(this.listWindow!=null){this.listWindow.close();}this.listWindow=new TipWindow({htmlContent:"<div >"+d.value+"</div>",eventElement:a,defer:false,width:240});this.ClassCache[c+b]=d.value;}}.bind(this),true);}},StopOver:function(b,a){if(this.ClassCache[b]){if(this.listWindow!=null){this.listWindow.close();}this.listWindow=new TipWindow({htmlContent:"<div >"+this.ClassCache[b]+"</div>",eventElement:a,defer:false,width:240});}else{FlightAjaxController.GetStopOverInfo(b,OneWayController.SearchRequest,function(c){if(c.success){if(this.listWindow!=null){this.listWindow.close();}this.listWindow=new TipWindow({htmlContent:"<div >"+c.value+"</div>",eventElement:a,defer:false,width:240});this.ClassCache[b]=c.value;}}.bind(this));}},FlightRestriction:function(b){var c=b.attr("rule");var d=c.split("|");var e=b.attr("psg");var a=d[0];FlightAjaxController.RestrictionRequestInfo.AirCorpCode=d[1];FlightAjaxController.RestrictionRequestInfo.FareItemID=d[2];FlightAjaxController.RestrictionRequestInfo.FlightClass=d[3];FlightAjaxController.RestrictionRequestInfo.FlightTime=d[4];FlightAjaxController.RestrictionRequestInfo.IssueCityCode=d[5];FlightAjaxController.RestrictionRequestInfo.IsKSeat=d[6];FlightAjaxController.RestrictionRequestInfo.IsPromotion=d[7];FlightAjaxController.RestrictionRequestInfo.PolicyId=d[8];FlightAjaxController.RestrictionRequestInfo.DepartPortCode=d[9];FlightAjaxController.RestrictionRequestInfo.ArrivePortCode=d[10];FlightAjaxController.RestrictionRequestInfo.Language=FlightAjaxController.Language;if(this.listWindow!=null){this.listWindow.close();}if(a=="MU"){this.FlightRestrictionForMU(b,FlightAjaxController.RestrictionRequestInfo,e);}else{if(a=="AirShopping"){this.FlightRestrictionForShopping(b,FlightAjaxController.RestrictionRequestInfo,e);}else{this.FlightRestrictionForBSP(b,FlightAjaxController.RestrictionRequestInfo,e,a);}}},FlightRestrictionForBSP:function(b,c,d,a){if(a=="Book51"){c.Channel=6;}else{c.Channel=1;}this.listWindow=new TipWindow({eventElement:b,defer:false,width:240,buildHtmlContent:function(f){var e=b.next().html();if(e.trim()!=""){f.htmlContent="<div >"+e+"</div>";f.show();}else{FlightAjaxController.GetRestrictionRuleInfo(c,d,function(g){if(g.success){if(this.listWindow!=null){this.listWindow.close();}f.htmlContent="<div >"+g.value+"</div>";f.show();b.next().html(g.value);}}.bind(this),true);}}.bind(this)});},FlightRestrictionForMU:function(a,b,d){FlightAjaxController.MuRestrictionRequestInfo=Object.clone(FlightAjaxController.RestrictionRequestInfo);var c=a.attr("murule").split("|");FlightAjaxController.MuRestrictionRequestInfo.DepartureAirPort=c[0];FlightAjaxController.MuRestrictionRequestInfo.DestinationAirport=c[1];FlightAjaxController.MuRestrictionRequestInfo.FlightNo=c[2];FlightAjaxController.MuRestrictionRequestInfo.Language=FlightAjaxController.Language;this.listWindow=new TipWindow({eventElement:a,defer:false,width:240,buildHtmlContent:function(f){var e=a.next().html();if(e.trim()!=""){f.htmlContent="<div >"+e+"</div>";f.show();}else{FlightAjaxController.GetMURestrictionRuleInfo(FlightAjaxController.MuRestrictionRequestInfo,d,function(g){if(g.success){if(this.listWindow!=null){this.listWindow.close();}f.htmlContent="<div >"+g.value+"</div>";f.show();a.next().html(g.value);}}.bind(this),true);}}.bind(this)});},FlightRestrictionForShopping:function(a,b,c){this.listWindow=new TipWindow({eventElement:a,defer:false,width:240,buildHtmlContent:function(e){var l=a.next().html();if(l!=""){e.htmlContent="<div >"+l+"</div>";e.show();}else{var i=a.parent().parent().find(".cols06 input");if(!i.attr("disabled")){var h=i.attr("flightnum");var g=i.attr("flightclassnum");var f=i.attr("fareid");var d=i.attr("channel");var k=i.attr("promotionid");var j=a.attr("shoprule");FlightAjaxController.GetShoppingRestrictionRuleInfo(OneWayController.SearchRequest,"channel1",h,g,f,d,k,c,j,function(m){if(m.success){if(this.listWindow!=null){this.listWindow.close();}e.htmlContent="<div >"+m.value+"</div>";e.show();a.next().html(m.value);}}.bind(this),true);}}}.bind(this)});},ShowMileageDescription:function(c){if(this.listWindow!=null){this.listWindow.close();}var b=c.attr("book");if(b){this.listWindow=new TipWindow({eventElement:c,width:240,defer:false,htmlContent:"常旅客标准里程累积详情，请查看航空公司官方网站"});return;}var a=c.attr("aircorp");var e=c.attr("mileage");var f=c.attr("upgradeleg")||0;var d=OneWayController.Language.toLowerCase();if(this.MileageDescriptions[d+"_"+a+"_"+e+"_"+f]){if(this.listWindow!=null){this.listWindow.close();}this.listWindow=new TipWindow({eventElement:c,width:240,defer:false,htmlContent:this.MileageDescriptions[d+"_"+a+"_"+e+"_"+f]});}else{FlightAjaxController.GetMileageDescription(a,e,f,function(g){if(g.success){if(this.listWindow!=null){this.listWindow.close();}this.listWindow=new TipWindow({eventElement:c,width:240,defer:false,htmlContent:g.value});this.MileageDescriptions[d+"_"+a+"_"+e+"_"+f]=g.value;}}.bind(this),true);}},GetUserPoint:function(){if(OneWayController.IsFromSquare){FlightAjaxController.GetUserPoint(function(a){if(a.success){$("#squares_mess span[method='score']").removeClass("red");$("#squares_mess span[method='score']").html(a.value+SearchBoxController.Resources.UserPoint);}else{$("#squares_mess span[method='score']").addClass("red");$("#squares_mess span[method='score']").html(SearchBoxController.Resources.ExceptionOnGetScores);}});}},render:function(){this.GetUserPoint();var a=this.ScrollTop(this.Scroll);a.start();OneWayController.S(OneWayController.SearchRequest,function(e){if(e.success){var d=e.value;d.context=this.context;if(d.RecommendedFlights.length>0){var b=template("OneWay_Recommend",d);$(".flightlist_tj").html(b);$(".flightlist_tj").slideDown();}var f=$("span[method='flightcount']");f.html(d.FlightLegList.length);f.parent().slideToggle();if(d.FlightLegList.length>0){var c=template("OneWay_ResultFilter",d);document.getElementById("fsortbox").innerHTML=c;$("#fsortbox").next().show();var b=template("OneWay_DataList",d);document.getElementById("flightlist").innerHTML=b;this.DivArray=$.makeArray(this.DataList.find("#flightlist >div[method='divBox']"));}if(d.SelloutFlights.length>0){var b=template("OneWay_SelloutFlight",d);$(b).insertAfter(document.getElementById("flightlist"));}if(d.FlightTransferLegList.length>0){var b=template("OneWay_DataList_Transfer",d);$(b).insertAfter(document.getElementById("flightlist"));this.DataList_Transfer=$("#DataList_Transfer");}if(d.FlightLegList.length==0&&d.FlightTransferLegList.length==0){$("#flightlist").hide();if(d.IsException){$("#dvException").show();}else{if(d.SoldOut){$("#dvSoldout").show();}else{$("#dvNoRoute").show();}}}}}.bind(this));},destroyDOM:function(){this.DataTitle=null;this.DataList=null;this.DataList_Transfer=null;this.OrderList=null;this.ChooseFlight=null;this.ContentEnd=null;this.Scroll=null;this.DivArray=null;this.FlightOneWayListYDay=null;this.FlightOneWayListSDay=null;this.FlightOneWayListMDay=null;this.ClassCache=null;this.PlanTypes=null;this.MileageDescriptions=null;},destroyEvent:function(){this.DataList.unbind("click",this.DataListOnClick);this.DataTitle.unbind("click",this.DataListOnClick);this.DataList.unbind("mouseover",this.DataListOnMouseOver);this.ContentEnd.unbind("mouseover",this.DataListOnMouseOver);this.OrderList.unbind("click",this.OrderListOnClick);},dispose:function(){this.destroyEvent();this.destroyDOM();}});var MsnTip=Elong.Page.MsnTip=Class.create();Object.extend(MsnTip.prototype,{name:"msnTip",html:"",options:{},initialize:function(a){Object.extend(Object.extend(this,this.options),a);this.initializeDOM();this.initializeEvent();this.render();},initializeDOM:function(){this.windowElement=$("#RealTimeBookDiv");this.closeElement=$("#RealTimeBookClose");},destroyDOM:function(){},initializeEvent:function(){$(window).bind("scroll",this.onWindowScroll.bindAsEventListener(this));$(window).bind("resize",this.onWindowResize.bindAsEventListener(this));this.closeElement.bind("click",this.HidTooltip.bindAsEventListener(this));},HidTooltip:function(){this.windowElement.fadeOut(500);},onWindowScroll:function(){var d=Globals.browserDimensions();var c=Globals.getScrollPosition();var b=d.height+c.y-this.windowElement.height()-25;var a=$(document).height()-10;if(b>a){$("#RealTimeBookDiv")[0].style.top=a+"px";}else{$("#RealTimeBookDiv")[0].style.top=b+"px";}},onWindowResize:function(){var d=Globals.browserDimensions();var c=Globals.getScrollPosition();var b=d.height+c.y-this.windowElement.height()-25;var a=$(document).height();if(b>a){$("#RealTimeBookDiv")[0].style.top=(a-10)+"px";}else{$("#RealTimeBookDiv")[0].style.top=b+"px";}},destroyEvent:function(){$(window).unbind("scroll",this.onWindowScroll);$(window).unbind("resize",this.onWindowResize);},render:function(){var e=Globals.browserDimensions();var c=e.width-this.windowElement.width()-10;var d=Globals.getScrollPosition();var a=$(document).height();var b=e.height+d.y;this.windowElement[0].style.top=b+"px";this.ie6FilterIFrame=Globals.addIE6Filter(this.windowElement.width(),this.windowElement.height(),c,top);this.windowElement.show();this.windowElement.animate({top:b-this.windowElement.height()-25},1000);this.showTimer=FunctionExt.defer(function(){$("#RealTimeBookDiv").fadeOut(1000);clearTimeout(this.showTimer);this.showTimer=null;},10000,this);this.destroyEvent();}});var client=null;$(document).ready(function(){client=new ListResultClient();if($("#RealTimeBookDiv")[0]!=null){var a=new MsnTip();}});var SearchBoxClient=Elong.Page.SearchBoxClient=Class.create();Object.extend(SearchBoxClient.prototype,{name:"SearchBoxClient",initialize:function(){this.initializeDOM();this.initializeEvent();this.FlightOneWayListDay=new Template(SearchBoxController.UrlConfig.Flight_Result_OneWayseoyday.replace(/{/g,"#{"));this.FlightOneWayListBusinessDay=new Template(SearchBoxController.UrlConfig.Flight_Result_OneWayseomday.replace(/{/g,"#{"));this.FlightRoundGoListDay=new Template(SearchBoxController.UrlConfig.Flight_Result_GoRoundseoyday.replace(/{/g,"#{"));this.FlightRoundGoListBusinessDay=new Template(SearchBoxController.UrlConfig.Flight_Result_GoRoundseomday.replace(/{/g,"#{"));$("#DIVWaiting").hide();this.render();},initializeDOM:function(){this.SearchBox=$("div.searchbar");this.FlightType=this.SearchBox.find("input[name='FlightType']");this.RoundTrip=this.SearchBox.find("span[method='Round']");this.RoundDate=this.SearchBox.find("span[method='Round']");this.DateInput=this.SearchBox.find("input[method='Date']");this.btnSearch=this.SearchBox.find("#btnSearch");this.Change=this.SearchBox.find("#changecity");this.DateStyle=(SearchBoxController.Language.toLowerCase()=="cn"?"date":"dateEn");var a=validator.convertDate(SearchBoxController.ServerTime);this.NowDate=validator.reFormatDateString(a.getFullYear()+"-"+(a.getMonth()+1)+"-"+a.getDate());this.NextDate=validator.reFormatDateString((a.getFullYear()+1)+"-"+(a.getMonth()+1)+"-"+a.getDate());},initializeEvent:function(){this.FlightType.bind("change",this.FlightTypeOnChange.bindAsEventListener(this));this.DateInput.bind("click",this.DateInputClick.bindAsEventListener(this));this.btnSearch.bind("click",this.btnSearchClick.bindAsEventListener(this));this.Change.bind("click",this.ChangeCityClick.bindAsEventListener(this));$(window).unload(this.dispose.bind(this));},CookieDate:function(c,a){var e=new Date();var b=new Date();e=$(c).attr("default");b=Globals.cookie("FlightCondition",a);var d=Globals.cookie("FlightCondition",a);if(b<e){d=$(c).val();}if(SearchBoxController.Language.toLowerCase()=="cn"){if(d.indexOf("/")>-1){d=validator.reFormatDateString(d);}}else{if(d.indexOf("-")>-1){d=validator.reFormatDateStringEn(d);}}return d;},getDateOffset:function(c,d){var a=validator.convertDateTime(c);var b=validator.convertDateTime(d);return Math.round(Math.abs((b.getTime()-a.getTime())/86400000));},filterCityNameEn:function(a){var b=a.replace(/[^\d\w]/g,"_").toLowerCase();while(b.indexOf("__")!=-1){b=b.replace("__","_");}return b;},FlightTypeOnChange:function(){switch(this.FlightType.val()){case"0":this.RoundDate.hide();break;case"1":this.RoundDate.show();break;default:break;}},ChangeCityClick:function(c){var a=this.SearchBox.find("#Round_DepartCity");var b=this.SearchBox.find("#Round_ArriveCity");var d=a.val();var e=a.attr("citythreesign");var f=a.attr("citynameen");this.setCity("Round_DepartCity",b.attr("citythreesign"),SearchBoxController.Language=="CN"?b.val():"",SearchBoxController.Language=="EN"?b.val():b.attr("citynameen"));this.setCity("Round_ArriveCity",e,SearchBoxController.Language=="CN"?d:"",SearchBoxController.Language=="EN"?d:f);},DateInputClick:function(b){var a=Event.element(b);new CalendarWindow({language:SearchBoxController.Language,eventElement:a,enabledFrom:this.NowDate,enabledTo:this.NextDate,selectedDate:String.isNullOrEmpty(a.val())?this.NowDate:a.val(),onSelected:function(f){a.val(f);if(a.attr("name")=="DepartDate"&&this.FlightType.val()==1){var h=validator.reFormatDateString(f);var d=validator.reFormatDateString(this.SearchBox.find("input[name='BackDate']").val());if(h>d){var g=validator.convertDate(h);var e=new Date(g.setDate(g.getDate()+3));var c=validator.reFormatDateString(e.getFullYear()+"-"+(e.getMonth()+1)+"-"+e.getDate());if(SearchBoxController.Language=="EN"){c=validator.reFormatDateStringEn(c);}this.SearchBox.find("input[name='BackDate']").val(c);}this.SearchBox.find("input[name='BackDate']").click();}}.bind(this)});},setCity:function(objId,citycode,citynamecn,citynameen){if(SearchBoxController.Language.toLowerCase()=="cn"){$("#"+objId).val(citynamecn);$("#"+objId).attr("cityname",citynameen);}else{$("#"+objId).val(citynameen);$("#"+objId).attr("cityname",citynamecn);}if(citynameen!=null&&citynameen!="undefined"&&citynameen!=""){$("#"+objId).attr("citynameen",citynameen);}$("#"+objId).attr("citythreesign",citycode);eval(String.format('var city = {CityThreeSign:"{0}",CityNameCn:"{1}",CityNameEn:"{2}"}',citycode,citynamecn,citynameen));$("#"+objId).get(0).City=city;},getCity:function(obj){if(obj==null||obj=="undefined"||obj.get(0).City==null||obj.get(0).City=="undefined"){eval(String.format('var city = {CityThreeSign:"{0}",CityNameCn:"{1}",CityNameEn:"{2}"}',"","",""));return city;}if(obj.get(0).City.CityNameEn==undefined&&String.isNullOrEmpty(obj.get(0).City.CityNameEn&&obj.attr("citynameen")!=undefined)){obj.get(0).City.CityNameEn=obj.attr("citynameen");}return obj.get(0).City;},ValidateOneWay:function(){if(!validator.valid($("#Round_DepartCity").val(),"notEmpty")){$error($("#Round_DepartCity"),SearchBoxController.Resources.Validate_DepartCityNull);return false;}if(!validator.valid($("#Round_ArriveCity").val(),"notEmpty")){$error($("#Round_ArriveCity"),SearchBoxController.Resources.Validate_ArriveCityNull);return false;}$("#Round_DepartCity").attr("citythreesign",this.getCity($("#Round_DepartCity")).CityThreeSign);$("#Round_ArriveCity").attr("citythreesign",this.getCity($("#Round_ArriveCity")).CityThreeSign);if(!validator.valid($("#Round_DepartCity").attr("citythreesign"),"notEmpty")){$error($("#Round_DepartCity"),SearchBoxController.Resources.Validate_NoDepartCity);return false;}if(!validator.valid($("#Round_ArriveCity").attr("citythreesign"),"notEmpty")){$error($("#Round_ArriveCity"),SearchBoxController.Resources.Validate_NoArriveCity);return false;}if($("#Round_DepartCity").attr("citythreesign")==$("#Round_ArriveCity").attr("citythreesign")){$error($("#Round_DepartCity"),SearchBoxController.Resources.Validate_SameCity);return false;}if(!validator.valid($("input[name='DepartDate']").val(),"notEmpty & "+this.DateStyle)){$error($("input[name='DepartDate']"),SearchBoxController.Resources.Validate_DateFormat);return false;}var b=$("input[name='DepartDate']").val();var a=validator.reFormatDateString(b);if(a<this.NowDate){$error($("input[name='DepartDate']"),SearchBoxController.Resources.Validate_BeforeToday);return false;}if(a>this.NextDate){$error($("input[name='DepartDate']"),SearchBoxController.Resources.Validate_LimitDate);return false;}return true;},ValidateRound:function(){var e=this.ValidateOneWay();var f=true;if(!validator.valid($("input[name='BackDate']").val(),"notEmpty & "+this.DateStyle)){$error($("input[name='BackDate']"),SearchBoxController.Resources.Validate_DateFormat);return false;}var d=$("input[name='DepartDate']").val();var b=validator.reFormatDateString(d);var c=$("input[name='BackDate']").val();var a=validator.reFormatDateString(c);if(a<this.NowDate){$error($("input[name='BackDate']"),SearchBoxController.Resources.Validate_BeforeToday);return false;}if(a>this.NextDate){$error($("input[name='BackDate']"),SearchBoxController.Resources.Validate_LimitDate);return false;}if(b>a){$error($("input[name='BackDate']"),SearchBoxController.Resources.Validate_DateCheck);return false;}return e&&f;},btnSearchClick:function(evt){if(this.wind!=null){this.wind.close();}var wind=new Dialog({title:"",htmlContent:$("#DIVWaiting").html(),width:SearchBoxController.Language.toLowerCase()=="cn"?320:400,height:100,initEvent:function(windowElement){var waiting=windowElement.find("div[method='SearchWaiting']");waiting.show();}.bind(this)});wind.show();var flighType=this.FlightType.val();var url;var element=Event.element(evt);var departCityObj=this.getCity($("#Round_DepartCity"));var arriveCityObj=this.getCity($("#Round_ArriveCity"));if(flighType==0){if(!this.ValidateOneWay()){wind.close();return;}var dayCount=this.getDateOffset(this.NowDate,validator.reFormatDateString($("input[name='DepartDate']").val()));url=this.FlightOneWayListDay.eval({departcitynameen:this.filterCityNameEn(departCityObj.CityNameEn),arrivecitynameen:this.filterCityNameEn(arriveCityObj.CityNameEn),language:SearchBoxController.Language.toLowerCase(),daycount:dayCount});ConditionValue={FType:flighType,DepCode:departCityObj.CityThreeSign,ArrCode:arriveCityObj.CityThreeSign,DepDate:$("input[name='DepartDate']").val(),BackDate:"",DepName:encodeURIComponent($("#Round_DepartCity").val())+"|"+departCityObj.CityNameEn,ArrName:encodeURIComponent($("#Round_ArriveCity").val())+"|"+arriveCityObj.CityNameEn};}else{if(flighType==1){if(!this.ValidateRound()){wind.close();return;}var dayCount1=this.getDateOffset(this.NowDate,validator.reFormatDateString($("input[name='DepartDate']").val()));var dayCount2=this.getDateOffset(this.NowDate,validator.reFormatDateString($("input[name='BackDate']").val()));url=this.FlightRoundGoListDay.eval({departcitynameen:this.filterCityNameEn(departCityObj.CityNameEn),arrivecitynameen:this.filterCityNameEn(arriveCityObj.CityNameEn),language:SearchBoxController.Language.toLowerCase(),daycount:dayCount1,backdaycount:dayCount2});ConditionValue={FType:flighType,DepCode:departCityObj.CityThreeSign,ArrCode:arriveCityObj.CityThreeSign,DepDate:$("input[name='DepartDate']").val(),BackDate:$("input[name='BackDate']").val(),DepName:encodeURIComponent($("#Round_DepartCity").val())+"|"+departCityObj.CityNameEn,ArrName:encodeURIComponent($("#Round_ArriveCity").val())+"|"+arriveCityObj.CityNameEn};}}Globals.cookie("FlightCondition","",ConditionValue,{expires:30,path:"/",secure:false});if(window.location.host=="big5.elong.com"){var ht="ht";url=ht+"tp://big5.elong.com/gate/big5/flight.elong.com"+url;}window.location.href=url;element.addClass("searchbtn_disable");element[0].disabled=true;return true;},render:function(){if($("#Round_DepartCity").length>0){new CityWindow({eventElement:$("#Round_DepartCity"),cityType:"flightsrc",lang:SearchBoxController.Language.toLowerCase(),resultNextId:"Round_ArriveCity",onSelect:function(b,a){$("#Round_DepartCity").attr("citythreesign",a.CityThreeSign);$("#Round_DepartCity").attr("citynameen",a.CityNameEn);$("#Round_ArriveCity").click();}});new CityWindow({eventElement:$("#Round_ArriveCity"),cityType:"flightsrc",lang:SearchBoxController.Language.toLowerCase(),onSelect:function(b,a){$("#Round_ArriveCity").attr("citythreesign",a.CityThreeSign);$("#Round_ArriveCity").attr("citynameen",a.CityNameEn);$("input[name='DepartDate']").click();}});}},destroyDOM:function(){this.SearchBox=null;this.FlightType=null;this.RoundTrip=null;this.RoundDate=null;this.DateInput=null;this.btnSearch=null;this.Change=null;this.DateStyle=null;this.NowDate=null;this.NextDate=null;this.FlightOneWayListDay=null;this.FlightOneWayListBusinessDay=null;this.FlightRoundGoListDay=null;this.FlightRoundGoListBusinessDay=null;},destroyEvent:function(){this.FlightType.unbind("change");this.DateInput.unbind("click");this.btnSearch.unbind("click");this.Change.unbind("click");},dispose:function(){this.destroyEvent();this.destroyDOM();}});var client=null;$(document).ready(function(){client=new SearchBoxClient();});var CustomSelect=Elong.Page.CustomSelect=Class.create();Object.extend(CustomSelect.prototype,{name:"CustomSelect",initialize:function(){this.isItemHover=0;this.delayTime4Select=null;this.selectUsingObj="";this.selectCloseUsing=0;this.isClickSelectTextObj=0;this.initializeDOM();this.initializeEvent();this.render();},initializeDOM:function(){this.MySelects=$(".droplist");this.Itmes=$(".droplist ul");},initializeEvent:function(){this.MySelects.bind("click",this.MySelectClick.bindAsEventListener(this));this.MySelects.bind("mouseover",this.MySelectMouseOver.bindAsEventListener(this));this.MySelects.bind("mouseout",this.MySelectMouseOut.bindAsEventListener(this));this.Itmes.bind("click",this.ItemsClick.bindAsEventListener(this));$(".droplist :text").click(function(){isClickSelectTextObj=1;});},MySelectClick:function(b){var a=Event.element(b);var e=a.attr("idtag");this.MySelects.removeClass("droplist_on");if(this.selectCloseUsing==1){return;}var g=(e==undefined?a.parents(".droplist"):a);if(this.selectUsingObj!=""&&this.selectUsingObj!=g.attr("idtag")){g.removeClass("droplist_on");}if(this.selectUsingObj!=""){clearTimeout(this.delayTime4Select);this.selectCloseUsing=1;g.removeClass("droplist_on");this.selectUsingObj="";this.delayTime4Select=setTimeout(function(){this.selectCloseUsing=0;this.isClickSelectTextObj=0;}.bind(this),200);}else{this.selectUsingObj=g.attr("idtag");clearTimeout(this.delayTime4Select);var e=g.attr("idtag");var d="";var c=$("#"+e);if(c.length>0){d=$("#"+e).val();}var f=g.find("ul.box");g.addClass("droplist_on");}},MySelectMouseOver:function(a){this.selectCloseUsing=0;},MySelectMouseOut:function(b){var a=Event.element(b);this.selectCloseUsing=1;this.delayTime4Select=setTimeout(function(){if(this.selectCloseUsing==1&&this.isClickSelectTextObj==0){$("div.droplist").removeClass("droplist_on");this.isItemHover=0;this.selectUsingObj="";}}.bind(this),3000);},ItemsClick:function(b){var a=Event.element(b);if(a.get(0).tagName.toLowerCase()!="li"){return;}this.selectCloseUsing=1;var e=a.parents("div.droplist");e.find("span.value").html(a.html());var d=e.attr("idtag");var c=$("#"+d);if(c.length>0){$("#"+d).val(a.attr("code")).trigger("change");}else{e.after('<input type="hidden" id="'+d+'" name="'+d+'" value="'+a.attr("code")+'"/>');}e.removeClass("droplist_on");this.selectUsingObj="";this.isItemHover=0;this.delayTime4Select=setTimeout(function(){this.selectCloseUsing=0;this.isClickSelectTextObj=0;}.bind(this),200);},render:function(){},destroyDOM:function(){this.isItemHover=null;this.delayTime4Select=null;this.selectUsingObj=null;this.selectCloseUsing=null;this.isClickSelectTextObj=null;this.MySelects=null;this.Itmes=null;},destroyEvent:function(){this.MySelects.unbind("click");this.MySelects.unbind("mouseover");this.MySelects.unbind("mouseout");this.Itmes.unbind("click");},dispose:function(){this.destroyEvent();this.destroyDOM();}});var selectclient=null;$(document).ready(function(){selectclient=new CustomSelect();});var OneWayConditon=Elong.Page.OneWayConditon=Class.create();Object.extend(OneWayConditon.prototype,{initialize:function(){this.initializeDOM();this.initializeEvent();this.prePorcess();},initializeDOM:function(){this.prevbtn=$("#prev");this.nextbtn=$("#next");this.navlist=$("#flightlistnav");this.weekcn=["周日","周一","周二","周三","周四","周五","周六"];this.weeken=["Sun.","Mon.","Tue.","Wed.","Thu.","Fri.","Sat."];this.monthen=new Array("Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Spt","Oct","Nov","Dec");this.qtext=["查询低价","Query"];this.lan=OneWayController.Language=="CN"?0:1;},initializeEvent:function(){this.navlist.bind("click",this.navlistOnClick.bindAsEventListener(this));},prePorcess:function(){$("#DIVWaiting").hide();var b=validator.getDateString(new Date(OneWayController.SearchRequest.DepartDate.replace(/-/g,"/")));var a=this.addDays(new Date(),3).replace(/\//g,"-");if(b<=a){this.prevbtn.find("em").removeClass("enable").addClass("disable");}if(b>=this.addDays(new Date(),362).replace(/\//g,"-")){this.nextbtn.find("em").removeClass("enable").addClass("disable");}$("a[method='noresult_research']").bind("click",function(){$("input[method='Date'][name='DepartDate']").click();}.bindAsEventListener(this));},appendNextOWLowestPirce:function(i,g,b,c){var a;var d;if(c>0){a=this.addDays(b,1);d=this.addDays(b,c);}else{d=this.addDays(b,-1);a=this.addDays(b,c);}var h=this.prevbtn.next().find("em").attr("value");var f=this.nextbtn.prev().find("em").attr("value");var e=validator.getDateString(new Date(OneWayController.SearchRequest.DepartDate.replace(/-/g,"/")));FlightAjaxController.GetOneWayLowestPrice(OneWayController.SearchRequest,a,d,function(q){if(q.success&&q.value.length>0){var m=new StringBuilder();for(var n=0;n<q.value.length;n++){data=q.value[n];var r=new Date(data.PriceDate.replace(/-/g,"/"));if(q.value.length==7&&validator.getDateString(r)==validator.getDateString(new Date())){this.prevbtn.find("em").removeClass("enable").addClass("disable");}var u;var j;if(OneWayController.Language=="EN"){u=this.weeken[r.getDay()];j=this.monthen[r.getMonth()]+" "+r.getDate();}else{u=this.weekcn[r.getDay()];j=validator.getDateString(r).substring(5);}var p=data.Price;var s=validator.getDateString(r);var o=$("#flightlistnav").find("li[class=navcols]:first").clone();var l=o.find("div");l.removeClass("f_l_nb").addClass("f_l_na");if(p<=0){l.html("<em value="+s+">"+j+"</em><em>&nbsp;("+u+")</em><br/><span href='###' class=pseudo_link>"+this.qtext[this.lan]+"</span><span></span>");}else{l.html("<em value="+s+">"+j+"</em><em>&nbsp;("+u+")</em><br/><span>¥<strong>"+p+"</strong></span>");}var t=l.parent().attr("href").replace(/\d/g,"");var k=l.find("em[value]").attr("value").replace(/-/g,"/");l.parent().attr("href",t.replace("day.","day"+this.getOffset(new Date(k))+"."));if(s==e){l.attr("class","f_l_nb");m.append($("<div></div>").append(o).html());}else{if(s>=h&&s<=f){m.append($("<div></div>").append(o).html());}else{m.append($("<div></div>").append(o.hide()).html());}}}if($.browser.msie){if($.browser.version=="6.0"){this.nextbtn.css("margin-right","-3px");}}if(c>0){i.after(m.toString());g.hide();for(var n=0;n<7;n++){i=i.next();i.show();}}else{i.before(m.toString());g.hide();for(var n=0;n<7;n++){i=i.prev();i.show();}}}}.bind(this),true);},addDays:function(a,c){var e=new Date(a.getTime()+c*24*60*60*1000);var d=e.getMonth()+1;var b=e.getDate();return e.getFullYear()+"/"+(d<10?"0"+d:d)+"/"+(b<10?"0"+b:b);},getOffset:function(a){var c=new Date();var d=new Date(c.getFullYear()+"/"+(c.getMonth()+1)+"/"+c.getDate());var b=parseInt((a-d)/1000/60/60/24);return b;},navlistOnClick:function(c){if(this.listWindow!=null){this.listWindow.close();}var b=Event.element(c);var f=b.attr("method");var e=0;while(f==null&&e<5){e++;b=b.parent();f=b.attr("method");}switch(f){case"seachflightbyday":var e=0;$("#m_contentend").html("");var l=new Dialog({title:"",htmlContent:$("#DIVWaiting").html(),width:SearchBoxController.Language.toLowerCase()=="cn"?320:400,height:100,initEvent:function(m){var i=m.find("div[method='SearchWaiting']");i.show();}.bind(this)});l.show();break;case"prevweek":if(b.find("em").attr("class")=="disable"){return;}var j=$("#lowlistnav").find("li[class=navcols]:visible");var k=$(j[0]);var h=k.prevAll("[class=navcols]:hidden");this.nextbtn.find("em").removeClass("disable").addClass("enable");if(k.find("em").attr("value").replace(/-/g,"/")<=this.addDays(new Date(),7)){this.prevbtn.find("em").removeClass("enable").addClass("disable");}if(h.length<7){h.remove();var a=new Date(k.find("em").attr("value").replace(/-/g,"/"));this.appendNextOWLowestPirce(k,j,a,-90);return;}j.hide();for(var d=0;d<7;d++){k=k.prev();k.show();}break;case"nextweek":if(b.find("em").attr("class")=="disable"){return;}var j=$("#lowlistnav").find("li[class=navcols]:visible");var k=$(j[6]);this.prevbtn.find("em").removeClass("disable").addClass("enable");var g=k.nextAll("[class=navcols]:hidden");if(k.find("em").attr("value").replace(/-/g,"/")>=this.addDays(new Date(),358)){this.nextbtn.find("em").removeClass("enable").addClass("disable");}if(g.length<7){g.remove();var a=new Date(k.find("em").attr("value").replace(/-/g,"/"));this.appendNextOWLowestPirce(k,j,a,90);return;}if(g.length>=7){j.hide();for(var d=0;d<7;d++){k=k.next();k.show();}}break;default:break;}},calendarOnClick:function(c){c.stopPropagation();var b=Event.element(c);var f=b.attr("method");var e=0;while(f==null&&e<5){e++;b=b.parent();f=b.attr("method");}switch(f){case"jumpToRoundList":var j=b.find("a");var g=new Date(OneWayController.SearchRequest.DepartDate.replace(/-/g,"/"));var d=this.getOffset(new Date(g.getFullYear()+"/"+(g.getMonth()+1)+"/"+g.getDate()));var h=new Date();h.setTime(j.attr("enddate"));var a=this.getOffset(h);var i="/"+OneWayController.SearchRequest.DepartCityNameEn+"-"+OneWayController.SearchRequest.ArriveCityNameEn+"/round/"+OneWayController.Language.toLowerCase()+"_day"+d+"_day"+a+".html?tabindex=1";$("#m_contentend").html("");var k=new Dialog({title:"",htmlContent:$("#DIVWaiting").html(),width:SearchBoxController.Language.toLowerCase()=="cn"?320:400,height:100,initEvent:function(m){var l=m.find("div[method='SearchWaiting']");l.show();}.bind(this)});k.show();window.location.href=i;break;default:break;}}});$(document).ready(function(){var a=new OneWayConditon();});