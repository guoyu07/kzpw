!function(global){var template=function(e,t){return template[/string|function/.test(typeof t)?"compile":"render"].apply(template,arguments);},cache=template.cache={},toString=function(e,t){return"string"!=typeof e&&(t=typeof e,"number"===t?e+="":e="function"===t?toString(e.call(e)):""),e;},escapeMap={"<":"&#60;",">":"&#62;",'"':"&#34;","'":"&#39;","&":"&#38;"},escapeHTML=function(e){return toString(e).replace(/&(?![\w#]+;)|[<>"']/g,function(e){return escapeMap[e];});},isArray=Array.isArray||function(e){return"[object Array]"==={}.toString.call(e);},each=function(e,t){if(isArray(e)){for(var a=0,n=e.length;n>a;a++){t.call(e,e[a],a,e);}}else{for(a in e){t.call(e,e[a],a);}}},resolve=function(e,t){var a=/(\/)[^/]+\1\.\.\1/,n=e.replace(/^([^.])/,"./$1").replace(/[^/]+$/,""),r=n+t;for(r=r.replace(/\/\.\//g,"/");r.match(a);){r=r.replace(a,"/");}return r;},helpers=template.helpers={$include:function(e,t,a){var n=resolve(a,e);return template.render(n,t);},$string:toString,$escape:escapeHTML,$each:each},debug=function(e){var t="";for(var a in e){t+="<"+a+">\n"+e[a]+"\n\n";}return t&&global.console&&console.error("Template Error\n\n"+t),function(){return"{Template Error}";};};template.render=function(e,t){var a=template.get(e)||debug({id:e,name:"Render Error",message:"No Template"});return t?a(t):a;},template.compile=function(e,t){var a="function"==typeof t,n=cache[e]=function(n){try{return a?new t(n,e)+"":t;}catch(r){return debug(r)();}};return n.prototype=helpers,a&&(t.prototype=helpers),n.toString=function(){return t+"";},n;},template.get=function(e){return cache[e.replace(/^\.\//,"")];},template.helper=function(e,t){helpers[e]=t;},template.helper("Date",Date),template.helper("String",String),template.helper("parseInt",parseInt),template.helper("$log",function(e){console.log(e);}),template.helper("$MsJson2Date",function(value){var d=eval("new "+value.replace(/\//g,""));return d;}),template.helper("$timeFormat",function(e){return new String(e).length<=0?"":1==new String(e).length?"0"+e:e;}),template.helper("$jsonDateFormat",function(e,t){var a=new Date(parseInt(e.substr(6))),n=a.getTime(),r=60000*a.getTimezoneOffset(),s=n+r;e=new Date(s+28800000);var l=e.getMonth()+1<10?"0"+(e.getMonth()+1):e.getMonth()+1,o=e.getDate()<10?"0"+e.getDate():e.getDate(),i=e.getHours()<10?"0"+e.getHours():e.getHours(),c=e.getMinutes()<10?"0"+e.getMinutes():e.getMinutes(),p=e.getSeconds()<10?"0"+e.getSeconds():e.getSeconds();return"date"==t?e.getFullYear()+"/"+l+"/"+o:"time"==t?i+":"+c+":"+p:"shorttime"==t?i+":"+c:"full"==t?e.getFullYear()+"/"+l+"/"+o+" "+i+":"+c+":"+p:e.getFullYear()+"/"+l+"/"+o+" "+i+":"+c+":"+p;}),template("Calendar",function(e){var t=this,a=e.minPrice,n=e.model,r=e.index,s=e.value,l=e.length,o=e.i,i=e.flag,c=e.price,p=(e.date,e.context),u=e.currClass,g=t.$escape,d=e.LowClass,m=t.$string,f="";f+=" ";for(var a=0,n=null,r=0;r<s.length;r++){n=s[r],(0>=a||a>n.Price&&n.Price>0)&&(a=n.Price);}var l=s.length,o=0;f+="<tr> ";for(var i=0;35>i;){if(n=s[i],o>=7&&(o=0),null!=n&&n.PriceDate==o++){var c="&nbsp;";l>i&&(c=n.Price>0?"<em>&yen;</em>"+n.Price:p.Resource.No_DATA);var u=l>i&&a==n.Price?"low_td":"";if(f+=' <td class="',f+=g(u),f+='" ',"&nbsp;"!=c&&a!=n.Price&&(f+=" onmouseover=\"javascript:this.className='",f+=g(u),f+=" bg_on';\" onmouseout=\"javascript:this.className='';\" "),f+='> <a method="seachflightbyday" onfocus="javascript:this.blur();" href="',f+=g(n.Url),f+='"> ',l>i&&n.Price>0){f+=' <div class="dwbox" method="seachflightbyday"> ';var d=a==n.Price?"low":"";f+=' <span class="',f+=g(d),f+='" method="seachflightbyday"> ',f+=m(c),f+="</span> ";}else{f+=g(c);}f+=' <div class="datebox" method="seachflightbyday"> ',f+=g(n.DepartDate),f+="</div> ",s.length>i&&(f+=" </div> "),f+=" </a> </td> ",i++,7==o&&(f+="</tr> <tr> ");}else{if(f+=" <td onmouseout=\"javascript:this.className='';\" onmouseover=\"javascript:this.className='bg_on';\"> </td> ",null==n&&(i++,7==++o)){break;}}}return f+="</tr> ",new String(f);}),template("CityList",function(e){var t=this,a=e.List,n=e.i,r=e.model,s=e.dateTime,l=void 0===e.Date?t.Date:e.Date,o=void 0===e.parseInt?t.parseInt:e.parseInt,i=e.month,c=e.day,p=t.$escape,u="";if(u+=' <ul class="clx"> ',a.length>0){for(var n=0;n<a.length;n++){var r=a[n];if(!(r.Discount>5)){var s=new l(o(r.FlyDate.substr(6))),i=s.getMonth()+1,c=s.getDate();u+=" <li ",n%2==0&&(u+='class="alt" '),u+='><a href="',u+=p(r.URL),u+='" target="_blank"><span class="cols01"> ',u+=p(r.FromCityName),u+=" - ",u+=p(r.ToCityName),u+='</span><span class="cols02">',u+=p(i),u+="\u6708",u+=p(c),u+='\u65e5</span><span class="cols03">',u+=p(r.Discount),u+=' \u6298</span><span class="cols04">&yen;',u+=p(r.Price),u+="</span></a></li> ";}}}return u+=" </ul> ",new String(u);}),template("InterCityTab",function(e,t){var a=this,n=e.length,r=e.key,s=e.i,l=e.city,o=e.code,i=a.$escape,c=e.context,p=function(n,r){r=r||e;var s=a.$include(n,r,t);return g+=s,s;},u=e.value,g="";g+=" ";var n=r.length;if(n>0){g+=' <div class="city clx" id="interCity"> ';for(var s=0;n>s;s++){var l=r[s],o=l.Code;g+=' <span id="',g+=i("h_"+o),g+='" city="',g+=i(o),g+='" ',0==s&&(g+='class="on" '),g+="> ",g+=i(l.Name),g+=" </span> ";}g+=" </div> ";}else{g+=' <ul class="main clx"> <li class="clx"> ',g+=i(c.Resource.NoDataTitle),g+="</li></ul> ";}return p("./InterList",{value:u,context:c}),new String(g);}),template("InterList",function(e){var t=this,a=(e.months,e.PromoteItem),n=e.value,r=e.length,s=t.$escape,l=e.j,o=e.PriceInfo,i=e.departCity,c=e.arriveCity,p=e.departCode,u=e.arriveCode,g=e.airCorpName,d=e.airCorpCode,m=e.classTypeName,f=e.context,h=e.expireFull,y="";y+=" ";var a=n[0].Departure,r=n.length;y+=' <ul class="main clx" id="',y+=s("t_"+a.Code),y+='" style="display: none;"> ';for(var l=0;r>l;l++){var o=n[l],i=o.Departure.Name,c=o.Arrive.Name,p=o.Departure.Code,u=o.Arrive.Code,g=o.AirCorp.Name,d=o.AirCorp.Code,m=o.ClassTypeName;o.OneWayPrice>0&&(y+=' <li class="clx"><span class="cols01"> ',y+=s(i),y+=" - ",y+=s(c),y+='</span><span class="cols02"><span class="Airlines_',y+=s(d),y+=' fp_fwr"></span>',y+=s(g),y+='</span> <span class="cols03"> ',y+=s(m),y+=s(f.Resource.OneWay),y+='&nbsp;<em class="yellow">&yen;</em><strong class="yellow">',y+=s(o.OneWayPrice),y+='</strong></span> <span class="cols04"><span method="expire" class="pseudo_link bor"> ',y+=s(f.Resource.ExpiryDate),y+='</span> <div style="display: none"> ',y+=s(o.BeingDate),y+=s(f.Resource.To),y+=s(o.ExpiryDate),y+='</div> </span><span class="cols05" method="OneWayBooking"> <input type="button" class="button" begindate="',y+=s(o.BeingDate),y+='" date="',y+=s(h),y+='" startcity="',y+=s(p),y+='" endcity="',y+=s(u),y+='" value="',y+=s(f.Resource.View),y+='" /></span>'),o.RoundTripPrice>0&&null!=o.AirCorp&&(o.OneWayPrice<=0?(y+=' <li class="clx"><span class="cols01"> ',y+=s(i),y+=" - ",y+=s(c),y+='</span><span class="cols02"><span class="Airlines_',y+=s(d),y+=' fp_fwr"></span>',y+=s(g),y+="</span> "):y+=' <br /> <span class="cols01">&nbsp;</span><span class="cols02">&nbsp;</span> ',y+=' <span class="cols03"> ',y+=s(m),y+=s(f.Resource.RoundTrip),y+='&nbsp;<em class="yellow">&yen;</em><strong class="yellow">',y+=s(o.RoundTripPrice),y+='</strong></span><span class="cols04"><span method="expire" class="pseudo_link bor">',y+=s(f.Resource.ExpiryDate),y+='</span><div style="display: none;"> ',y+=s(o.BeingDate),y+=s(f.Resource.To),y+=s(o.ExpiryDate),y+='</div> </span><span class="cols05" method="RoundBooking"> <input type="button" class="button" begindate="',y+=s(o.BeingDate),y+='" date="',y+=s(o.ExpiryDate),y+='" startcity="',y+=s(p),y+='" endcity="',y+=s(u),y+='" value="',y+=s(f.Resource.View),y+='" /></span> '),y+="</li> ";}return y+=' <li class="line_none tr"> ',"Elong"==f.WebCategory&&"CN"==f.Language&&(y+=' <a href="http://iflight.elong.com" target="_blank">',y+=s(f.Resource.More),y+="</a> "),y+=" </li> </ul> ",new String(y);}),"function"==typeof define?define(function(){return template;}):"undefined"!=typeof exports?module.exports=template:global.template=template;}(this);var BannerPlayClient=Elong.Page.BannerPlay=Class.create();Object.extend(BannerPlayClient.prototype,{name:"BannerPlayClient",data:[],loadManage:[],contentId:"elong_play_com",currentIndex:1,scroll:null,loadScroll:null,mainDOMTemplate:new Template("<div id='elong_play_text' class='l_b' lastselected='0pg'>#{PLAYTEXT}</div><div id='elong_play'>#{PLAYIMG}</div>"),initialize:function(){if(this.data.length==0){$("#"+this.contentId).removeClass("l_k");return;}this.initializeDOM();this.initializeEvent();},initializeDOM:function(){$("#DIVWaiting").hide();var playTextTemplate=new Template("<A onfocus='this.blur()' href='javascript:void(0)' rel='nofollow' index='#{index}'>#{index}</A>&nbsp;");var playImageTemplate=new Template(" <div class='i_pic01' index='#{index}'><A href='#{url}' rel='nofollow' target='_blank'><div style='background:url(#{backgroud}) no-repeat;width:#{width};height:#{height}'></div></A></div>");if(this.data.length>1){var playTex="";for(var i=1;i<=this.data.length;i++){playTex+=playTextTemplate.eval({index:i});}}var img=playImageTemplate.eval({index:0,url:this.data[0].url,backgroud:this.data[0].backgroud,width:this.data[0].width,height:this.data[0].height});var item=this.mainDOMTemplate.eval({PLAYTEXT:playTex,PLAYIMG:img});$(item).appendTo($("#"+this.contentId));$("#elong_play_text a").eq(0).addClass("selected");this.loadManage=new Array();for(var i=0;i<this.data.length;i++){this.loadManage.push(i>0?0:1);}this.startLoadTimer();},initializeEvent:function(){$("#"+this.contentId).bind("click",this.bannerPlayClick.bindAsEventListener(this));if(this.data.length>1){this.startTimer();}},render:function(){},destroyDOM:function(){},destroyEvent:function(){},dispose:function(){this.destroyEvent();this.destroyDOM();},loadImage:function(index){var playImageTemplate=new Template("<div class='i_pic01' index='#{index}'><A href='#{url}' rel='nofollow' target='_blank' style='display:none'><div style='background:url(#{backgroud}) no-repeat;width:#{width};height:#{height}'></div></A></div>");$(playImageTemplate.eval({index:index-1,url:this.data[index-1].url,backgroud:this.data[index-1].backgroud,width:this.data[index-1].width,height:this.data[index-1].height})).appendTo($("#"+this.contentId+" div[id='elong_play']"));this.loadManage[index-1]=1;},startLoadTimer:function(){this.loadScroll=setInterval(function(){for(var a=0;a<this.loadManage.length;a++){if(this.loadManage[a]==0){this.loadImage(a+1);return;}}clearInterval(this.loadScroll);}.bind(this),5000);},startTimer:function(){this.scroll=setInterval(function(){if(++this.currentIndex>this.data.length){this.currentIndex=1;}$("#elong_play_text a").eq(this.currentIndex-1).trigger("click");}.bind(this),10000);},bannerPlayClick:function(b){var a=Event.element(b);if(!String.isNullOrEmpty(a.attr("index"))){this.currentIndex=parseInt(a.attr("index"));if(this.loadManage[this.currentIndex-1]==0){this.loadImage(this.currentIndex);}this.ScrollClick(b);b.stopPropagation();}},ScrollClick:function(c){var b=Event.element(c);var d=b.attr("index");var a=$("#elong_play_text a");$("#elong_play div a:visible").fadeOut(700);$("#elong_play div[class='i_pic01'][index='"+(d-1)+"'] a").fadeIn(1000);a.removeClass("selected").eq(d-1).addClass("selected");}});var IndexClient=Elong.Page.IndexClient=Class.create();Object.extend(IndexClient.prototype,{name:"IndexClient",initialize:function(){this.initializeDOM();this.initializeEvent();var a="http://iflight.elong";var b=IndexController.Language=="EN"?".net":".com";if(IndexController.WebCategory=="Elong"){a="http://iflight.elong"+b;}else{a="http://travel.elong"+b+"/iflight";}this.ListUrl=new Template(a+IndexController.UrlConfig.FlightList.replace(/{/g,"#{"));var c=validator.convertDate(IndexController.ServerTime);this.NowDate=validator.reFormatDateString(c.getFullYear()+"-"+(c.getMonth()+1)+"-"+c.getDate());this.NextDate=validator.reFormatDateString((c.getFullYear()+1)+"-"+(c.getMonth()+1)+"-"+c.getDate());this.context={Language:IndexController.Language,WebCategory:IndexController.WebCategory,OrderFromId:IndexController.OrderFromId,Controller:IndexController,Resource:IndexController.Resources};this.render();},initializeDOM:function(){this.rdFlightType=$("input[type='radio'][name='rdFlightType']");this.divPop=$("#popDiv");this.PromoteDate=$("#btnPromoteDate");this.Tab=$("#tehui");this.ContentEnd=$("#m_contentend");this.DateStyle=(IndexController.Language.toLowerCase()=="cn"?"date":"dateEn");},initializeEvent:function(){this.rdFlightType.bind("click",this.rdFlightTypeClick.bindAsEventListener(this));this.Tab.bind("mouseover",this.tabMouseOver.bindAsEventListener(this));this.Tab.bind("mouseout",this.tabMouseOut.bindAsEventListener(this));$("div[method='citytab']").bind("click",function(c){var b=Event.element(c);var a=b.attr("code");if($("div.ul_wrap[code='"+a+"']").length>0){$("div[method='citytab']").find("span").each(function(){$(this).removeClass("on");});b.addClass("on");$("div.ul_wrap").each(function(){if($(this).attr("code")==a){$(this).show();a="";}else{$(this).hide();}});}if(a!=undefined&&a!=""&&a!=null){IndexController.LowestDiscount(a,12,function(g){if(g.success){var f=g.value;var d=$("div[method='citytab']").next().clone();d.empty();d.attr("code",a);if(f!=undefined){var e=new Object();e.List=f;e.context=this.context;d.append(template.render("CityList",e));}$("div.ul_wrap").each(function(){$(this).hide();});d.insertAfter($("div[method='citytab']"));$("div[method='citytab']").find("span").each(function(){$(this).removeClass("on");});b.addClass("on");d.show();}else{var d=$("div[method='citytab']").next().clone();$("div.ul_wrap").each(function(){$(this).hide();});d.html(g.value);d.insertAfter($("div[method='citytab']"));$("div[method='citytab']").find("span").each(function(){$(this).removeClass("on");});b.addClass("on");d.show();}}.bind(this),true);}});$(window).unload(this.dispose.bind(this));},rdFlightTypeClick:function(d){var c=Event.element(d);var e=c.attr("method");var b=this.getCity($("input[method='lowestPriceCity'][cityType=src]")).CityThreeSign;var a=this.getCity($("input[method='lowestPriceCity'][cityType=arr]")).CityThreeSign;if(e=="return"){var f=b;b=a;a=f;}this.reloadLowestPriceCalendar(b,a);},tabMouseOut:function(b){var a=Event.element(b);var c=a.attr("method");switch(c){case"expire":this.ContentEnd.html("");break;default:break;}},tabMouseOver:function(b){var a=Event.element(b);var c=a.attr("method");switch(c){case"expire":if(this.listWindow!=null){this.listWindow.close();}this.listWindow=new TipWindow({eventElement:a,width:200,defer:false,htmlContent:a.next().html()});break;}},setCity:function(objId,citycode,citynamecn,citynameen){if(IndexController.Language.toLowerCase()=="cn"){$("#"+objId).val(citynamecn);$("#"+objId).attr("cityname",citynameen);}else{$("#"+objId).val(citynameen);$("#"+objId).attr("cityname",citynamecn);}$("#"+objId).attr("citythreesign",citycode);eval(String.format('var city = {CityThreeSign:"{0}",CityNameCn:"{1}",CityNameEn:"{2}"}',citycode,citynamecn,citynameen));$("#"+objId).get(0).City=city;},getCity:function(obj){if(obj==null||obj=="undefine"||obj.get(0).City==null||obj.get(0).City=="undefine"){eval(String.format('var city = {CityThreeSign:"{0}",CityNameCn:"{1}",CityNameEn:"{2}"}',"","",""));return city;}var CityThreeSign=String.isNullOrEmpty(obj.get(0).City.CityThreeSign)?"":obj.get(0).City.CityThreeSign;var CityNameCn=String.isNullOrEmpty(obj.get(0).City.CityNameCn)?"":obj.get(0).City.CityNameCn;var CityNameEn=String.isNullOrEmpty(obj.get(0).City.CityNameEn)?"":obj.get(0).City.CityNameEn;var Id=String.isNullOrEmpty(obj.get(0).City.CityId)?"":obj.get(0).City.CityId;eval(String.format('var city = {CityId:"{3}",CityThreeSign:"{0}",CityNameCn:"{1}",CityNameEn:"{2}"}',CityThreeSign,CityNameCn,CityNameEn,Id));return city;},DateInputClick:function(b){var a=Event.element(b);new CalendarWindow({language:IndexController.Language,eventElement:a,enabledFrom:this.NowDate,enabledTo:this.NextDate,selectedDate:String.isNullOrEmpty(a.val())?this.NowDate:a.val(),onSelected:function(c){a.val(c);}.bind(this)});},OnewayBookingClick:function(f){var d=Event.element(f);var g=d.attr("startcity");var e=d.attr("endcity");var b=d.attr("date");var a=d.attr("begindate");this.PromoteDate.attr("startcity",g);this.PromoteDate.attr("endcity",e);this.PromoteDate.attr("flighttype","0");var c=$("input[method='PDate'][name='FLY_DATE']");c.attr("date",b);c.attr("begindate",a);c.bind("click",this.PDateInputClick.bindAsEventListener(this));this.divPop.find("span[id='returntext']").hide();var h=new Dialog({title:IndexController.Resources.PromoteDate,htmlContent:this.divPop.html(),width:290,height:120,initEvent:function(k){var i=k.find("input[method = 'PDate']");i.bind("click",this.PDateInputClick.bindAsEventListener(this));var j=k.find("#btnPromoteDate");j.bind("click",this.PromoteDateClick.bindAsEventListener(this));}.bind(this)});h.show();},PromoteDateClick:function(evt){var element=Event.element(evt);var startcity=element.attr("startcity");var endcity=element.attr("endcity");var flighttype=element.attr("flighttype");var curdivPop=element.parent().parent();var StartDate=curdivPop.find("input[name='FLY_DATE']").val();var EndDate=curdivPop.find("input[name='RETURN_DATE']").val();if(!validator.valid(StartDate,"notEmpty & "+this.DateStyle)){$error(curdivPop.find("input[name='FLY_DATE']"),IndexController.Resources.Validate_DateFormat);return;}var dateStart=validator.reFormatDateString(StartDate);if(dateStart<this.NowDate){$error($("input[name='FLY_DATE']"),IndexController.Resources.Validate_BeforeToday);return;}if(flighttype==1){if(!validator.valid(EndDate,"notEmpty & "+this.DateStyle)){$error(curdivPop.find("input[name='RETURN_DATE']"),IndexController.Resources.Validate_DateFormat);return;}var dateEnd=validator.reFormatDateString(EndDate);if(dateStart>dateEnd){$error(curdivPop.find("input[name='FLY_DATE']"),IndexController.Resources.Validate_DateCheck);return;}}window.location.href=this.ListUrl.eval({language:IndexController.Language.toLowerCase(),pagename:(flighttype=="0")?"list":"golist",startcity:startcity,endcity:endcity,startdate:dateStart,enddate:(flighttype=="0")?dateStart:dateEnd,adulttype:"0",aircorp:"All",passengercount:"1",childcount:"0",seatlevel:"Y"});},PDateInputClick:function(d){var c=Event.element(d);var b=c.attr("date");var a=validator.reFormatDateString(c.attr("begindate"));new CalendarWindow({language:IndexController.Language,eventElement:c,selectedDate:String.isNullOrEmpty(c.val())?this.NowDate:c.val(),enabledFrom:(a>this.NowDate)?a:this.NowDate,enabledTo:b,onSelected:function(e){c.val(e);}.bind(this)});},RoundBookingClick:function(f){var d=Event.element(f);var g=d.attr("startcity");var e=d.attr("endcity");var b=d.attr("date");var a=d.attr("begindate");this.PromoteDate.attr("startcity",g);this.PromoteDate.attr("endcity",e);this.PromoteDate.attr("flighttype","1");var c=$("input[method='PDate'][name='FLY_DATE']");c.attr("date",b);c.attr("begindate",a);c.bind("click",this.PDateInputClick.bindAsEventListener(this));this.divPop.find("span[id='returntext']").show();var h=new Dialog({title:IndexController.Resources.PromoteDate,htmlContent:this.divPop.html(),width:550,height:120,initEvent:function(l){var j=l.find("input[method = 'PDate']");j.bind("click",this.PDateInputClick.bindAsEventListener(this));var i=l.find("input[method = 'Date']");i.bind("click",this.DateInputClick.bindAsEventListener(this));var k=l.find("#btnPromoteDate");k.bind("click",this.PromoteDateClick.bindAsEventListener(this));}.bind(this)});h.show();},reloadLowestPriceCalendar:function(b,a){if(String.isNullOrEmpty(b)||b=="undefined"){return;}if(String.isNullOrEmpty(a)||b=="undefined"){return;}if(b==a){$error($("input[method='lowestPriceCity'][cityType=arr]"),IndexController.Resources.Validate_SameCity);return;}$("#cn_day30win").find("table tbody").children("tr").remove();var d=$("#calWaiting");var c=d.find("img");c.attr("src",c.attr("url"));d.show();IndexController.LowestPrice(b,a,function(f){if(f.success){f.context=this.context;var e=template.render("Calendar",f);$("#cn_day30win").find("table tbody").append(e);$("#calWaiting").hide();}}.bind(this),true);},loadPromotion:function(){IndexController.GetPromotion(function(c){if(c.success){var b=c.inter.key;if(b.length>0){c.inter.context=this.context;$("#tehui").append(template.render("InterCityTab",c.inter));var a=$("#interCity");a.bind("click",this.cityTabClick.bindAsEventListener(this));this.OneWayBooking=$("span[method='OneWayBooking']");this.RoundBooking=$("span[method='RoundBooking']");this.OneWayBooking.bind("click",this.OnewayBookingClick.bindAsEventListener(this));this.RoundBooking.bind("click",this.RoundBookingClick.bindAsEventListener(this));$("#t_BJS").show();}}}.bind(this),true,null,null);IndexController.LeftInfo(function(a){if(a.success){$("#left").append(a.value);}}.bind(this),true,null,null);},cityTabClick:function(c){var b=Event.element(c);var a=b.attr("city");if(a!="undefined"&&a!=null){$("#interCity").find("span").each(function(){if($(this).attr("id")=="h_"+a){$(this).addClass("on");}else{$(this).removeClass("on");}});var f=$("#interWait");var e=$("#t_"+a);if(e=="undefined"||e==null||e.length==0){if(f.length==0){f=$("#calWaiting").clone();$(f).attr("id","interWait");var d=$(f).find("img");d.attr("src",d.attr("url"));$(f).insertAfter($("#interCity"));}this.Tab.find("ul[id^='t_']").each(function(){$(this).hide();});$(f).show();IndexController.Promote(a,function(i){$("#interWait").hide();if(i.success){i.context=this.context;$(template.render("InterList",i)).insertAfter($("#interCity"));var g=i.value[0].Departure.Code;var h=$("#t_"+g);this.OneWayBooking=h.find("span[method='OneWayBooking']");this.RoundBooking=h.find("span[method='RoundBooking']");this.OneWayBooking.bind("click",this.OnewayBookingClick.bindAsEventListener(this));this.RoundBooking.bind("click",this.RoundBookingClick.bindAsEventListener(this));h.show();}}.bind(this),true);}else{if(f.length>0){$(f).hide();}this.Tab.find("ul[id^='t_']").each(function(){if($(this).attr("id")=="t_"+a){$(this).show();}else{$(this).hide();}});}}},render:function(){this.loadPromotion();new CityWindow({eventElement:$("input[method='lowestPriceCity'][cityType=src]"),cityType:"flightsrc",lang:IndexController.Language.toLowerCase(),onSelect:function(b,a){$("input[type=radio][name=rdFlightType][method=go]").click();}.bind(this)});new CityWindow({eventElement:$("input[method='lowestPriceCity'][cityType=arr]"),cityType:"flightsrc",lang:IndexController.Language.toLowerCase(),onSelect:function(b,a){$("input[type=radio][name=rdFlightType][method=go]").click();}.bind(this)});this.setCity("lowestCity1","BJS","北京","Beijing");this.setCity("lowestCity2","SHA","上海","Shanghai");},destroyDOM:function(){this.FlightType=null;},destroyEvent:function(){},dispose:function(){this.destroyEvent();this.destroyDOM();}});var indexclient=null;$(document).ready(function(){indexclient=new IndexClient();try{BannerPlayClient.prototype.data=bannerPlayData;}catch(b){}var a=new BannerPlayClient();});var SearchBoxClient=Elong.Page.SearchBoxClient=Class.create();Object.extend(SearchBoxClient.prototype,{name:"SearchBoxClient",initialize:function(){this.initializeDOM();this.initializeEvent();this.resource=IndexController.Resources;this.FlightOneWayListDay=new Template(IndexController.UrlConfig.Flight_Result_OneWayseoyday.replace(/{/g,"#{"));this.FlightOneWayListEconomyDay=new Template(IndexController.UrlConfig.Flight_Result_OneWayseosday.replace(/{/g,"#{"));this.FlightOneWayListBusinessDay=new Template(IndexController.UrlConfig.Flight_Result_OneWayseomday.replace(/{/g,"#{"));this.FlightOneWayListDayAirCorp=new Template(IndexController.UrlConfig.Flight_Result_OneWayseoycorpday.replace(/{/g,"#{"));this.FlightOneWayListBusinessAirCorp=new Template(IndexController.UrlConfig.Flight_Result_OneWayseomcorpday.replace(/{/g,"#{"));this.FlightRoundGoListDay=new Template(IndexController.UrlConfig.Flight_Result_GoRoundseoyday.replace(/{/g,"#{"));this.FlightRoundGoListEconomyDay=new Template(IndexController.UrlConfig.Flight_Result_GoRoundseosday.replace(/{/g,"#{"));this.FlightRoundGoListBusinessDay=new Template(IndexController.UrlConfig.Flight_Result_GoRoundseomday.replace(/{/g,"#{"));var a="http://iflight.elong";var b=IndexController.Language=="EN"?".net":".com";if(IndexController.WebCategory=="Elong"){a="http://iflight.elong"+b;}else{a="http://travel.elong"+b+"/iflight";}this.ListUrl=new Template(a+IndexController.UrlConfig.FlightList.replace(/{/g,"#{"));this.ListDayUrl=new Template(a+IndexController.UrlConfig.iFlightOneWay.replace(/{/g,"#{"));this.ListBizUrl=new Template(a+IndexController.UrlConfig.iFlightOneWayBiz.replace(/{/g,"#{"));this.ListFirstUrl=new Template(a+IndexController.UrlConfig.iFlightOneWayFirst.replace(/{/g,"#{"));this.PackageListUrl=new Template(a+IndexController.UrlConfig.Flights_PackageList2.replace(/{/g,"#{"));this.RoundTripUrl=new Template(a+IndexController.UrlConfig.iFlightRoundTrip.replace(/{/g,"#{"));this.RoundTripBizUrl=new Template(a+IndexController.UrlConfig.iFlightRoundTripBiz.replace(/{/g,"#{"));this.RoundTripFirstUrl=new Template(a+IndexController.UrlConfig.iFlightRoundTripFirst.replace(/{/g,"#{"));$("#DIVWaiting").hide();this.render();},initializeDOM:function(){this.SearchBox=$("div[id='mainsearch']");this.OneWayRadio=$("#domesticBox input[method='oneway']");this.RoundRadio=$("#domesticBox input[method='round']");this.RoundTrip=$("div[method='Round']");this.RoundDate=$("li[method='Round']");this.DateInput=$("input[method='Date']");this.btnSearch=$("#btnSearch");this.domesticBox=$("#domesticBox");this.interBox=$("#interBox");this.iRoundTrip=$("div[method='iRound']");this.iRoundDate=$("li[method='iRound']");this.iMultiDest=$("div[method='iMultiDest']");this.ThirdTrip=$("#ThirdTrip");this.FourthTrip=$("#FourthTrip");this.btnDel3=$("#btnDel3");this.btnDel4=$("#btnDel4");this.AdultCount=$("input[name='PassengerCount']");this.SearchFlightDate=$("#cn_day30win");this.DateStyle=(IndexController.Language.toLowerCase()=="cn"?"date":"dateEn");var b=validator.convertDate(IndexController.ServerTime);this.NowDate=validator.reFormatDateString(b.getFullYear()+"-"+(b.getMonth()+1)+"-"+b.getDate());this.NextDate=validator.reFormatDateString((b.getFullYear()+1)+"-"+(b.getMonth()+1)+"-"+b.getDate());var c=new Date(b.setDate(b.getDate()+1));this.Tomorrow=validator.reFormatDateString(c.getFullYear()+"-"+(c.getMonth()+1)+"-"+c.getDate());var a=new Date(b.setDate(b.getDate()+1));this.DayAfterTomorrow=validator.reFormatDateString(a.getFullYear()+"-"+(a.getMonth()+1)+"-"+a.getDate());},initializeEvent:function(){this.SearchBox.bind("click",this.SearchBoxClick.bindAsEventListener(this));this.DateInput.bind("click",this.DateInputClick.bindAsEventListener(this));this.btnSearch.bind("click",this.btnSearchClick.bindAsEventListener(this));this.iMultiDest.bind("click",this.MultiDestClick.bindAsEventListener(this));this.AdultCount.bind("change",this.AdultCountChanged.bindAsEventListener(this));this.SearchFlightDate.bind("click",this.SearchFlightDateClick.bindAsEventListener(this));var a=this.SearchBox.find("input[type='text']");a.bind("focus",this.OnFocusInput.bindAsEventListener(this));a.bind("blur",this.OnBlurInput.bindAsEventListener(this));a.bind("webkitspeechchange",this.OnSpeechChange.bindAsEventListener(this));a=$("#i_30daybox").find("input[type='text']");a.bind("focus",this.OnFocusInput.bindAsEventListener(this));a.bind("blur",this.OnBlurInput.bindAsEventListener(this));$(window).unload(this.dispose.bind(this));},CookieDate:function(c,a){var e=this.NowDate;var b=this.NowDate;e=$(c).attr("default");b=Globals.cookie("FlightCondition",a);var d=Globals.cookie("FlightCondition",a);if(b<e){d=$(c).val();}if(IndexController.Language.toLowerCase()=="cn"){if(d.indexOf("/")>-1){d=validator.reFormatDateString(d);}}else{if(d.indexOf("-")>-1){d=validator.reFormatDateStringEn(d);}}return d;},ShowDate:function(c,a){var e=this.NowDate;var b=this.NowDate;e=$(c).val();b=Globals.cookie("Condition",a);var d=Globals.cookie("Condition",a);if(b<e){d=$(c).val();}if(IndexController.Language.toLowerCase()=="cn"){if(d.indexOf("/")>-1){d=validator.reFormatDateString(d);}}else{if(d.indexOf("-")>-1){d=validator.reFormatDateStringEn(d);}}return d;},setCity:function(objId,citycode,citynamecn,citynameen){if(citynamecn==""||citynamecn=="undefined"||citynameen==""||citynameen=="undefined"){return;}if(IndexController.Language.toLowerCase()=="cn"){if(citynamecn!=null&&citynamecn!="undefined"&&citynamecn!=""){$("#"+objId).val(citynamecn);}$("#"+objId).attr("cityname",citynameen);}else{$("#"+objId).val(citynameen);$("#"+objId).attr("cityname",citynamecn);}if(citynameen!=null&&citynameen!="undefined"&&citynameen!=""){$("#"+objId).attr("citynameen",citynameen);}if(citycode!=null&&citycode!="undefined"&&citycode!=""){$("#"+objId).attr("citythreesign",citycode);}eval(String.format('var city = {CityThreeSign:"{0}",CityNameCn:"{1}",CityNameEn:"{2}"}',citycode,citynamecn,citynameen));$("#"+objId).get(0).City=city;},getCity:function(obj){if(obj==null||obj=="undefined"||obj.get(0).City==null||obj.get(0).City=="undefined"){eval(String.format('var city = {CityThreeSign:"{0}",CityNameCn:"{1}",CityNameEn:"{2}"}',"","",""));return city;}obj.get(0).City.CityNameEn=obj.attr("citynameen");return obj.get(0).City;},getDateOffset:function(c,d){var a=validator.convertDateTime(c);var b=validator.convertDateTime(d);return Math.round(Math.abs((b.getTime()-a.getTime())/86400000));},filterCityNameEn:function(a){var b=a.replace(/[^\d\w]/g,"_").toLowerCase();while(b.indexOf("__")!=-1){b=b.replace("__","_");}return b;},AdultCountChanged:function(c){var b=Event.element(c);var e=b.val()*2;var a=b.next().next().find("ul");a.children("li").remove();for(var d=0;d<=e;d++){a.append('<li code="'+d+'">'+d+"</li>");}},OnSpeechChange:function(b){var a=Event.element(b);$(a).keyup();},OnFocusInput:function(b){var a=Event.element(b);a.addClass("on");},OnBlurInput:function(b){var a=Event.element(b);a.removeClass("on");},SearchBoxClick:function(d){var c=Event.element(d);var e=c.attr("method");if($.browser.msie){var i=parseInt($.browser.version,10);if(i==6||i==7){switch(e){case"oneway":this.SearchBox.attr("class","mainsearch");this.RoundDate.show().addClass("gary");this.RoundDate.find(".dateinfo").hide();this.RoundDate.find("input").attr("value","yyyy-mm-dd").addClass("l_black");this.RoundTrip.show();break;case"round":this.SearchBox.attr("class","mainsearch");this.RoundDate.show().removeClass("gary").removeClass("l_black");this.RoundDate.find(".dateinfo").show();this.RoundTrip.show();this.RoundDate.find("input").val(this.GetBackDate());break;case"domesticTab":c.attr("class","a_on");c.next().attr("class","b");$("#bugfix").attr("class","bugfix01");this.interBox.hide();if(this.domesticBox.find("input[name='FlightType']:checked").val()==2){this.SearchBox.attr("class","mainsearch2");}else{this.SearchBox.attr("class","mainsearch");}this.domesticBox.show();break;case"interTab":c.attr("class","b_on");c.prev().attr("class","a");$("#bugfix").attr("class","bugfix02");this.domesticBox.hide();if(this.interBox.find("input[name='iFlightType']:checked").val()==2){this.SearchBox.attr("class","mainsearch2");}else{this.SearchBox.attr("class","mainsearch");}this.interBox.show();break;case"ioneway":this.iMultiDest.hide();this.SearchBox.attr("class","mainsearch");this.iRoundDate.hide();this.iRoundTrip.show();break;case"iround":this.iMultiDest.hide();this.SearchBox.attr("class","mainsearch");this.iRoundDate.show();this.iRoundTrip.show();break;case"imulti":this.iRoundTrip.hide();this.SearchBox.attr("class","mainsearch2");this.iMultiDest.show();break;case"changecity":var a=this.SearchBox.find("#Round_DepartCity");var b=this.SearchBox.find("#Round_ArriveCity");var f=a.val();var g=a.attr("citythreesign");var h=a.attr("citynameen");this.setCity("Round_DepartCity",b.attr("citythreesign"),IndexController.Language=="CN"?b.val():"",IndexController.Language=="EN"?b.val():b.attr("citynameen"));this.setCity("Round_ArriveCity",g,IndexController.Language=="CN"?f:"",IndexController.Language=="EN"?f:h);break;case"dateinfo":c.prev().click();break;default:break;}return;}}switch(e){case"oneway":this.RoundDate.show().addClass("gary").addClass("l_black");this.RoundDate.find(".dateinfo").hide();this.RoundDate.find("input").attr("value","yyyy-mm-dd").addClass("l_black");break;case"round":this.RoundDate.show().removeClass("gary");this.RoundDate.find(".dateinfo").show();this.RoundDate.find("input").removeClass("l_black").val(this.GetBackDate());break;case"domesticTab":if(c.attr("flag")==true||c.attr("flag")=="true"){return;}c.attr("class","a_on");c.next().attr("class","b");$("#bugfix").attr("class","bugfix01");if(this.interBox.find("input[name='iFlightType']:checked").val()==2){$("li[method='interTab']").attr("flag",true);this.interBox.animate({height:"hide"},"slow",function(){if(this.domesticBox.find("input[name='FlightType']:checked").val()==2){this.SearchBox.attr("class","mainsearch2");}else{this.SearchBox.attr("class","mainsearch");}this.domesticBox.animate({height:"show"},"slow",function(){$("li[method='interTab']").attr("flag",false);});}.bind(this));}else{if(this.domesticBox.find("input[name='FlightType']:checked").val()==2){$("li[method='interTab']").attr("flag",true);this.interBox.animate({height:"hide"},"slow",function(){this.SearchBox.attr("class","mainsearch2");this.domesticBox.animate({height:"show"},"slow",function(){$("li[method='interTab']").attr("flag",false);});}.bind(this));}else{this.interBox.hide();this.SearchBox.attr("class","mainsearch");this.domesticBox.show();}}break;case"interTab":if(c.attr("flag")==true||c.attr("flag")=="true"){return;}c.attr("class","b_on");c.prev().attr("class","a");$("#bugfix").attr("class","bugfix02");if(this.domesticBox.find("input[name='FlightType']:checked").val()==2){$("li[method='domesticTab']").attr("flag",true);this.domesticBox.animate({height:"hide"},"slow",function(){if(this.interBox.find("input[name='iFlightType']:checked").val()==2){this.SearchBox.attr("class","mainsearch2");}else{this.SearchBox.attr("class","mainsearch");}this.interBox.animate({height:"show"},"slow",function(){$("li[method='domesticTab']").attr("flag",false);});}.bind(this));}else{if(this.interBox.find("input[name='iFlightType']:checked").val()==2){$("li[method='domesticTab']").attr("flag",true);this.domesticBox.animate({height:"hide"},"slow",function(){this.SearchBox.attr("class","mainsearch2");this.interBox.animate({height:"show"},"slow",function(){$("li[method='domesticTab']").attr("flag",false);});}.bind(this));}else{this.domesticBox.hide();this.SearchBox.attr("class","mainsearch");this.interBox.show();}}break;case"ioneway":this.interBox.find("input[name='iFlightType']").attr("disabled",true);this.iMultiDest.animate({height:"hide"},"slow",function(){this.SearchBox.attr("class","mainsearch");this.iRoundDate.hide();this.iRoundTrip.animate({height:"show"},"slow",function(){this.interBox.find("input[name='iFlightType']").attr("disabled",false);}.bind(this));}.bind(this));break;case"iround":this.interBox.find("input[name='iFlightType']").attr("disabled",true);this.iMultiDest.animate({height:"hide"},"slow",function(){this.SearchBox.attr("class","mainsearch");this.iRoundDate.show();this.iRoundTrip.animate({height:"show"},"slow",function(){this.interBox.find("input[name='iFlightType']").attr("disabled",false);}.bind(this));}.bind(this));break;case"imulti":this.interBox.find("input[name='iFlightType']").attr("disabled",true);this.iRoundTrip.animate({height:"hide"},"slow",function(){this.SearchBox.attr("class","mainsearch2");this.iMultiDest.animate({height:"show"},"slow",function(){this.interBox.find("input[name='iFlightType']").attr("disabled",false);}.bind(this));}.bind(this));break;case"changecity":var a=this.SearchBox.find("#Round_DepartCity");var b=this.SearchBox.find("#Round_ArriveCity");var f=a.val();var g=a.attr("citythreesign");var h=a.attr("citynameen");this.setCity("Round_DepartCity",b.attr("citythreesign"),IndexController.Language=="CN"?b.val():"",IndexController.Language=="EN"?b.val():b.attr("citynameen"));this.setCity("Round_ArriveCity",g,IndexController.Language=="CN"?f:"",IndexController.Language=="EN"?f:h);break;case"dateinfo":c.prev().click();break;default:break;}},ShowWeekDay:function(c,a){var d=validator.reFormatDateString(a);var b=validator.convertDate(d);if(d==this.NowDate){c.next().html(this.resource.Today);}else{if(d==this.Tomorrow){c.next().html(this.resource.Tomorrow);}else{if(d==this.DayAfterTomorrow){c.next().html(this.resource.DayAfterTomorrow);}else{switch(b.getDay()){case 0:c.next().html(this.resource.Sunday);break;case 1:c.next().html(this.resource.Monday);break;case 2:c.next().html(this.resource.Tuesday);break;case 3:c.next().html(this.resource.Wednesday);break;case 4:c.next().html(this.resource.Thursday);break;case 5:c.next().html(this.resource.Friday);break;case 6:c.next().html(this.resource.Saturday);break;}}}}},DateInputClick:function(b){var a=Event.element(b);new CalendarWindow({language:IndexController.Language,eventElement:a,enabledFrom:this.NowDate,enabledTo:this.NextDate,selectedDate:String.isNullOrEmpty(a.val())?this.NowDate:a.val(),onSelected:function(f){if(a.attr("name")=="BackDate"){this.RoundDate.removeClass("gary");this.RoundDate.find(".dateinfo").show();this.RoundDate.find("input").removeClass("l_black");this.RoundRadio.attr("checked",true);this.OneWayRadio.attr("checked",false);}a.val(f);this.ShowWeekDay(a,f);if(a.attr("name")=="DepartDate"&&this.domesticBox.find("input[name='FlightType']:checked").val()==1){var h=validator.reFormatDateString(f);var g=validator.convertDate(h);var d=validator.reFormatDateString(this.SearchBox.find("input[name='BackDate']").val());if(h>d){var e=new Date(g.setDate(g.getDate()+3));var c=validator.reFormatDateString(e.getFullYear()+"-"+(e.getMonth()+1)+"-"+e.getDate());if(IndexController.Language=="EN"){c=validator.reFormatDateStringEn(c);}this.domesticBox.find("input[name='BackDate']").val(c);}this.domesticBox.find("input[name='BackDate']").click();}}.bind(this)});},GetBackDate:function(){var d=validator.reFormatDateString(this.RoundDate.prev().find("input").val());var c=validator.convertDate(d);var b=new Date(c.setDate(c.getDate()+3));var a=validator.reFormatDateString(b.getFullYear()+"-"+(b.getMonth()+1)+"-"+b.getDate());if(IndexController.Language=="EN"){a=validator.reFormatDateStringEn(a);}return a;},MultiDestClick:function(b){var a=Event.element(b);var c=a.attr("method");switch(c){case"AddTrip":if(this.ThirdTrip.css("display")=="none"){this.ThirdTrip.show();this.btnDel3.show();$("#FlightLength").val("3");}else{this.btnDel3.hide();this.btnDel4.show();this.FourthTrip.show();$("#FlightLength").val("4");}break;case"DelThird":this.ThirdTrip.hide();$("#FlightLength").val("2");break;case"DelFourth":this.FourthTrip.hide();this.btnDel3.show();$("#FlightLength").val("3");break;default:break;}},ValidateOneWay:function(){var c=$("#Round_DepartCity");var a=$("#Round_ArriveCity");if(!validator.valid(c.val(),"notEmpty")){$error(c,IndexController.Resources.Validate_DepartCityNull);return false;}if(!validator.valid(a.val(),"notEmpty")){$error(a,IndexController.Resources.Validate_ArriveCityNull);return false;}c.attr("citythreesign",this.getCity(c).CityThreeSign);a.attr("citythreesign",this.getCity(a).CityThreeSign);if(c.attr("citythreesign")==""){$error(c,IndexController.Resources.Validate_NoDepartCity);return false;}if(a.attr("citythreesign")==""){$error(a,IndexController.Resources.Validate_NoArriveCity);return false;}if(!validator.valid($("input[name='DepartDate']").val(),"notEmpty & "+this.DateStyle)){$error($("input[name='DepartDate']"),IndexController.Resources.Validate_DateFormat);return false;}if(c.val().trim()==a.val().trim()){$error(c,IndexController.Resources.Validate_SameCity);return false;}var d=$("input[name='DepartDate']").val();var b=validator.reFormatDateString(d);if(b<this.NowDate){$error($("input[name='DepartDate']"),IndexController.Resources.Validate_BeforeToday);return false;}if(b>this.NextDate){$error($("input[name='DepartDate']"),IndexController.Resources.Validate_LimitDate);return false;}return true;},ValidateRound:function(){var e=this.ValidateOneWay();var f=true;if(!validator.valid($("input[name='BackDate']").val(),"notEmpty & "+this.DateStyle)){$error($("input[name='BackDate']"),IndexController.Resources.Validate_DateFormat);return false;}var d=$("input[name='DepartDate']").val();var b=validator.reFormatDateString(d);var c=$("input[name='BackDate']").val();var a=validator.reFormatDateString(c);if(a<this.NowDate){$error($("input[name='BackDate']"),IndexController.Resources.Validate_BeforeToday);return false;}if(a>this.NextDate){$error($("input[name='BackDate']"),IndexController.Resources.Validate_LimitDate);return false;}if(b>a){$error($("input[name='BackDate']"),IndexController.Resources.Validate_DateCheck);return false;}return e&&f;},searchDomestic:function(){var flighType=this.domesticBox.find("input[name='FlightType']:checked").val();var departCityObj=this.getCity($("#Round_DepartCity"));var arriveCityObj=this.getCity($("#Round_ArriveCity"));var now=new Date();if(flighType==0){if(!this.ValidateOneWay()){return;}var classType=this.RoundTrip.find("input[name='ClassType']").val().toUpperCase();var dayCount=this.getDateOffset(this.NowDate,validator.reFormatDateString($("input[name='DepartDate']").val()));if(classType=="Y"){url=this.FlightOneWayListDay.eval({departcitynameen:this.filterCityNameEn(departCityObj.CityNameEn),arrivecitynameen:this.filterCityNameEn(arriveCityObj.CityNameEn),language:IndexController.Language.toLowerCase(),daycount:dayCount});}else{if(classType=="S"){url=this.FlightOneWayListEconomyDay.eval({departcitynameen:this.filterCityNameEn(departCityObj.CityNameEn),arrivecitynameen:this.filterCityNameEn(arriveCityObj.CityNameEn),language:IndexController.Language.toLowerCase(),daycount:dayCount});}else{url=this.FlightOneWayListBusinessDay.eval({departcitynameen:this.filterCityNameEn(departCityObj.CityNameEn),arrivecitynameen:this.filterCityNameEn(arriveCityObj.CityNameEn),language:IndexController.Language.toLowerCase(),daycount:dayCount});}}ConditionValue={FType:flighType,DepCode:departCityObj.CityThreeSign,ArrCode:arriveCityObj.CityThreeSign,DepDate:$("input[name='DepartDate']").val(),DepName:encodeURIComponent(departCityObj.CityNameCn)+"|"+departCityObj.CityNameEn,ArrName:encodeURIComponent(arriveCityObj.CityNameCn)+"|"+arriveCityObj.CityNameEn};}else{if(flighType==1){if(!this.ValidateRound()){return;}var classType=this.RoundTrip.find("input[name='ClassType']").val().toUpperCase();var dayCount1=this.getDateOffset(this.NowDate,validator.reFormatDateString($("input[name='DepartDate']").val()));var dayCount2=this.getDateOffset(this.NowDate,validator.reFormatDateString($("input[name='BackDate']").val()));if(classType=="Y"){url=this.FlightRoundGoListDay.eval({departcitynameen:this.filterCityNameEn(departCityObj.CityNameEn),arrivecitynameen:this.filterCityNameEn(arriveCityObj.CityNameEn),language:IndexController.Language.toLowerCase(),daycount:dayCount1,backdaycount:dayCount2});}else{if(classType=="S"){url=this.FlightRoundGoListEconomyDay.eval({departcitynameen:this.filterCityNameEn(departCityObj.CityNameEn),arrivecitynameen:this.filterCityNameEn(arriveCityObj.CityNameEn),language:IndexController.Language.toLowerCase(),daycount:dayCount1,backdaycount:dayCount2});}else{url=this.FlightRoundGoListBusinessDay.eval({departcitynameen:this.filterCityNameEn(departCityObj.CityNameEn),arrivecitynameen:this.filterCityNameEn(arriveCityObj.CityNameEn),language:IndexController.Language.toLowerCase(),daycount:dayCount1,backdaycount:dayCount2});}}ConditionValue={FType:flighType,DepCode:departCityObj.CityThreeSign,ArrCode:arriveCityObj.CityThreeSign,DepDate:$("input[name='DepartDate']").val(),BackDate:$("input[name='BackDate']").val(),DepName:encodeURIComponent(departCityObj.CityNameCn)+"|"+departCityObj.CityNameEn,ArrName:encodeURIComponent(arriveCityObj.CityNameCn)+"|"+arriveCityObj.CityNameEn};}}Globals.cookie("FlightCondition","",ConditionValue,{expires:30,path:"/",secure:false});$("#ConditionForm").attr("action",url);if(window.location.host=="big5.elong.com"){var actionUrl=$("#ConditionForm").attr("action");actionUrl="http://big5.elong.com/gate/big5/flight.elong.com"+actionUrl;$("#ConditionForm").attr("action",actionUrl);}return true;},searchInter:function(evt){var flighType=this.interBox.find("input[name='iFlightType']:checked").val();var segments="";var segmentsName="";var nowDate=this.NowDate;var passengerCount=1;var childCount=0;if((flighType==0)||(flighType==1)){if(!validator.valid($("#Dept_CityName").val(),"notEmpty")){$error($("#Dept_CityName"),IndexController.Resources.Validate_DepartCityNull);return;}if(!validator.valid($("#Arrive_CityName").val(),"notEmpty")){$error($("#Arrive_CityName"),IndexController.Resources.Validate_ArriveCityNull);return;}$("#Dept_CityName").attr("citythreesign",this.getCity($("#Dept_CityName")).CityThreeSign);$("#Arrive_CityName").attr("citythreesign",this.getCity($("#Arrive_CityName")).CityThreeSign);if(!validator.valid($("#Dept_CityName").attr("citythreesign"),"notEmpty")){$error($("#Dept_CityName"),IndexController.Resources.Validate_DepartCityNull);return;}if(!validator.valid($("#Arrive_CityName").attr("citythreesign"),"notEmpty")){$error($("#Arrive_CityName"),IndexController.Resources.Validate_ArriveCityNull);return;}if(!validator.valid($("input[name='Dept_Date']").val(),"notEmpty & "+this.DateStyle)){$error($("input[name='Dept_Date']"),IndexController.Resources.Validate_DateFormat);return;}if($("#Dept_CityName").attr("citythreesign")==$("#Arrive_CityName").attr("citythreesign")){$error($("input[name='Dept_CityName']"),IndexController.Resources.Validate_SameCity);return;}passengerCount=this.iRoundTrip.find("input[name='PassengerCount']").val();childCount=this.iRoundTrip.find("input[name='ChildCount']").val();if(childCount>passengerCount*2){$error(this.iRoundTrip.find("div[idtag='RoundCCount']"),IndexController.Resources.ChildCount);return;}if($("#Arrive_CityName").attr("citytype")=="Domestic"&&$("#Dept_CityName").attr("citytype")=="Domestic"){$error($("input[name='Dept_CityName']"),IndexController.Resources.DomesticCity);return;}var StartDate=this.iRoundTrip.find("input[name='Dept_Date']").val();var dateStart=validator.reFormatDateString(StartDate);if(dateStart<nowDate){$error($("input[name='Dept_Date']"),IndexController.Resources.Validate_BeforeToday);return;}var adulttype=this.iRoundTrip.find("input[name='SearchInfo_AdultType']").val();var seatlevel=this.iRoundTrip.find("input[name='ClassType']").val();var dayCount=this.getDateOffset(this.NowDate,validator.reFormatDateString(StartDate));var reg=new RegExp(" ","g");if(flighType==0){if(adulttype==0&&passengerCount==1&&childCount==0){var url="";switch(seatlevel){case"C":url=this.ListBizUrl.eval({language:IndexController.Language.toLowerCase(),startcity:$("#Dept_CityName").attr("citynameen").toLowerCase().replace(reg,"_"),endcity:$("#Arrive_CityName").attr("citynameen").toLowerCase().replace(reg,"_"),days:dayCount});break;case"F":url=this.ListFirstUrl.eval({language:IndexController.Language.toLowerCase(),startcity:$("#Dept_CityName").attr("citynameen").toLowerCase().replace(reg,"_"),endcity:$("#Arrive_CityName").attr("citynameen").toLowerCase().replace(reg,"_"),days:dayCount});break;case"Y":default:url=this.ListDayUrl.eval({language:IndexController.Language.toLowerCase(),startcity:$("#Dept_CityName").attr("citynameen").toLowerCase().replace(reg,"_"),endcity:$("#Arrive_CityName").attr("citynameen").toLowerCase().replace(reg,"_"),days:dayCount});break;}$("#ConditionForm").attr("action",url);}else{$("#ConditionForm").attr("action",this.ListUrl.eval({language:IndexController.Language.toLowerCase(),pagename:"list",startcity:$("#Dept_CityName").attr("citythreesign"),endcity:$("#Arrive_CityName").attr("citythreesign"),startdate:validator.reFormatDateString(StartDate),enddate:validator.reFormatDateString(StartDate),adulttype:adulttype,aircorp:"All",passengercount:passengerCount,childcount:childCount,seatlevel:seatlevel}));}}else{if(!validator.valid($("input[name='Back_Date']").val(),"notEmpty & "+this.DateStyle)){$error($("input[name='Back_Date']"),IndexController.Resources.Validate_DateFormat);return;}var EndDate=$("input[name='Back_Date']").val();var dateEnd=validator.reFormatDateString(EndDate);if(dateEnd<nowDate){$error($("input[name='Back_Date']"),IndexController.Resources.Validate_BeforeToday);return;}if(dateStart>dateEnd){$error($("input[name='Back_Date']"),IndexController.Resources.Validate_DateCheck);return;}if(adulttype==0&&passengerCount==1&&childCount==0){var url="";var backDayCount=this.getDateOffset(this.NowDate,validator.reFormatDateString(EndDate));switch(seatlevel){case"C":url=this.RoundTripBizUrl.eval({language:IndexController.Language.toLowerCase(),startcity:$("#Dept_CityName").attr("citynameen").toLowerCase().replace(reg,"_"),endcity:$("#Arrive_CityName").attr("citynameen").toLowerCase().replace(reg,"_"),days:dayCount,backdays:backDayCount});break;case"F":url=this.RoundTripFirstUrl.eval({language:IndexController.Language.toLowerCase(),startcity:$("#Dept_CityName").attr("citynameen").toLowerCase().replace(reg,"_"),endcity:$("#Arrive_CityName").attr("citynameen").toLowerCase().replace(reg,"_"),days:dayCount,backdays:backDayCount});break;case"Y":default:url=this.RoundTripUrl.eval({language:IndexController.Language.toLowerCase(),startcity:$("#Dept_CityName").attr("citynameen").toLowerCase().replace(reg,"_"),endcity:$("#Arrive_CityName").attr("citynameen").toLowerCase().replace(reg,"_"),days:dayCount,backdays:backDayCount});break;}$("#ConditionForm").attr("action",url);}else{$("#ConditionForm").attr("action",this.ListUrl.eval({language:IndexController.Language.toLowerCase(),pagename:"golist",startcity:$("#Dept_CityName").attr("citythreesign"),endcity:$("#Arrive_CityName").attr("citythreesign"),startdate:validator.reFormatDateString(StartDate),enddate:validator.reFormatDateString(EndDate),adulttype:adulttype,aircorp:"All",passengercount:passengerCount,childcount:childCount,seatlevel:seatlevel}));}}}if(flighType==2){var validate=true;this.iMultiDest.find("input[id*='_Dept_CityName']:visible").each(function(){if(!validator.valid($(this).val(),"notEmpty")){$error($(this),IndexController.Resources.Validate_DepartCityNull);validate=false;}});if(!validate){return;}this.iMultiDest.find("input[id*='_Arrive_CityName']:visible").each(function(){if(!validator.valid($(this).val(),"notEmpty")){$error($(this),IndexController.Resources.Validate_ArriveCityNull);validate=false;}});if(!validate){return;}this.iMultiDest.find("input[name*='_Dept_Date']:visible").each(function(){var datestyle=(IndexController.Language.toLowerCase()=="cn"?"date":"dateEn");if(!validator.valid($(this).val(),"notEmpty & "+datestyle)){$error($(this),IndexController.Resources.Validate_DateFormat);validate=false;}});passengerCount=this.iMultiDest.find("input[name='PassengerCount']").val();childCount=this.iMultiDest.find("input[name='ChildCount']").val();if(childCount>passengerCount*2){$error(this.iMultiDest.find("div[idtag='multiCCount']"),IndexController.Resources.ChildCount);validate=false;}$("#Multi1_Dept_CityName").attr("citythreesign",this.getCity($("#Multi1_Dept_CityName")).CityThreeSign);$("#Multi2_Dept_CityName").attr("citythreesign",this.getCity($("#Multi2_Dept_CityName")).CityThreeSign);$("#Multi1_Arrive_CityName").attr("citythreesign",this.getCity($("#Multi1_Arrive_CityName")).CityThreeSign);$("#Multi2_Arrive_CityName").attr("citythreesign",this.getCity($("#Multi2_Arrive_CityName")).CityThreeSign);if(!validator.valid($("#Multi1_Dept_CityName").attr("citythreesign"),"notEmpty")){$error($("#Multi1_Dept_CityName"),IndexController.Resources.Validate_DepartCityNull);return;}if(!validator.valid($("#Multi2_Dept_CityName").attr("citythreesign"),"notEmpty")){$error($("#Multi2_Dept_CityName"),IndexController.Resources.Validate_DepartCityNull);return;}if(!validator.valid($("#Multi1_Arrive_CityName").attr("citythreesign"),"notEmpty")){$error($("#Multi1_Arrive_CityName"),IndexController.Resources.Validate_ArriveCityNull);return;}if(!validator.valid($("#Multi2_Arrive_CityName").attr("citythreesign"),"notEmpty")){$error($("#Multi2_Arrive_CityName"),IndexController.Resources.Validate_ArriveCityNull);return;}if($("#Multi1_Dept_CityName").attr("citythreesign")==$("#Multi1_Arrive_CityName").attr("citythreesign")){$error($("input[id='Multi1_Dept_CityName']"),IndexController.Resources.Validate_SameCity);return;}if($("#Multi2_Dept_CityName").attr("citythreesign")==$("#Multi2_Arrive_CityName").attr("citythreesign")){$error($("input[id='Multi2_Dept_CityName']"),IndexController.Resources.Validate_SameCity);return;}if(!validate){return;}var Multi1_Date=$("input[name='Multi1_Dept_Date']").val();var Multi2_Date=$("input[name='Multi2_Dept_Date']").val();var dateMulti1=validator.reFormatDateString(Multi1_Date);var dateMulti2=validator.reFormatDateString(Multi2_Date);if(dateMulti1<nowDate){$error($("input[name='Multi1_Dept_Date']"),IndexController.Resources.Validate_BeforeToday);return;}if(dateMulti2<nowDate){$error($("input[name='Multi2_Dept_Date']"),IndexController.Resources.Validate_BeforeToday);return;}if(dateMulti2<dateMulti1){$error($("input[name='Multi2_Dept_Date']"),IndexController.Resources.Validate_DateCheck);validate=false;}if(this.ThirdTrip.css("display")!="none"){var Multi3_Date=$("input[name='Multi3_Dept_Date']").val();var dateMulti3=validator.reFormatDateString(Multi3_Date);if(dateMulti3<nowDate){$error($("input[name='Multi3_Dept_Date']"),IndexController.Resources.Validate_BeforeToday);validate=false;}if(dateMulti3<dateMulti2){$error($("input[name='Multi3_Dept_Date']"),IndexController.Resources.Validate_DateCheck);validate=false;}$("#Multi3_Dept_CityName").attr("citythreesign",this.getCity($("#Multi3_Dept_CityName")).CityThreeSign);$("#Multi3_Arrive_CityName").attr("citythreesign",this.getCity($("#Multi3_Arrive_CityName")).CityThreeSign);if(!validator.valid($("#Multi3_Dept_CityName").attr("citythreesign"),"notEmpty")){$error($("#Multi3_Dept_CityName"),IndexController.Resources.Validate_DepartCityNull);validate=false;}if(!validator.valid($("#Multi3_Arrive_CityName").attr("citythreesign"),"notEmpty")){$error($("#Multi3_Arrive_CityName"),IndexController.Resources.Validate_ArriveCityNull);validate=false;}if($("#Multi3_Dept_CityName").attr("citythreesign")==$("#Multi3_Arrive_CityName").attr("citythreesign")){$error($("input[id='Multi3_Dept_CityName']"),IndexController.Resources.Validate_SameCity);validate=false;}}if(this.FourthTrip.css("display")!="none"){var Multi4_Date=$("input[name='Multi4_Dept_Date']").val();var dateMulti4=validator.reFormatDateString(Multi4_Date);if(dateMulti4<nowDate){$error($("input[name='Multi4_Dept_Date']"),IndexController.Resources.Validate_BeforeToday);validate=false;}if(dateMulti4<dateMulti3){$error($("input[name='Multi4_Dept_Date']"),IndexController.Resources.Validate_DateCheck);validate=false;}$("#Multi4_Dept_CityName").attr("citythreesign",this.getCity($("#Multi4_Dept_CityName")).CityThreeSign);$("#Multi4_Arrive_CityName").attr("citythreesign",this.getCity($("#Multi4_Arrive_CityName")).CityThreeSign);if(!validator.valid($("#Multi4_Dept_CityName").attr("citythreesign"),"notEmpty")){$error($("#Multi4_Dept_CityName"),IndexController.Resources.Validate_DepartCityNull);validate=false;}if(!validator.valid($("#Multi4_Arrive_CityName").attr("citythreesign"),"notEmpty")){$error($("#Multi4_Arrive_CityName"),IndexController.Resources.Validate_ArriveCityNull);validate=false;}if($("#Multi4_Dept_CityName").attr("citythreesign")==$("#Multi4_Arrive_CityName").attr("citythreesign")){$error($("input[id='Multi4_Dept_CityName']"),IndexController.Resources.Validate_SameCity);validate=false;}}if(!validate){return;}segments=$("#Multi1_Dept_CityName").attr("citythreesign")+"_"+$("#Multi1_Arrive_CityName").attr("citythreesign")+"_"+validator.reFormatDateString($("input[name='Multi1_Dept_Date']").val());segments+=";";segments+=$("#Multi2_Dept_CityName").attr("citythreesign")+"_"+$("#Multi2_Arrive_CityName").attr("citythreesign")+"_"+validator.reFormatDateString($("input[name='Multi2_Dept_Date']").val());var cityFormat="";segmentsName=this.getCity($("#Multi1_Dept_CityName")).CityNameCn+"|"+this.getCity($("#Multi1_Dept_CityName")).CityNameEn;segmentsName+="_";segmentsName+=this.getCity($("#Multi1_Arrive_CityName")).CityNameCn+"|"+this.getCity($("#Multi1_Arrive_CityName")).CityNameEn;segmentsName+=";";segmentsName+=this.getCity($("#Multi2_Dept_CityName")).CityNameCn+"|"+this.getCity($("#Multi2_Dept_CityName")).CityNameEn;segmentsName+="_";segmentsName+=this.getCity($("#Multi2_Arrive_CityName")).CityNameCn+"|"+this.getCity($("#Multi2_Arrive_CityName")).CityNameEn;if((this.ThirdTrip.css("display")!="none")){segments+=";";segments+=$("#Multi3_Dept_CityName").attr("citythreesign")+"_"+$("#Multi3_Arrive_CityName").attr("citythreesign")+"_"+validator.reFormatDateString($("input[name='Multi3_Dept_Date']").val());segmentsName+=";";segmentsName+=this.getCity($("#Multi3_Dept_CityName")).CityNameCn+"|"+this.getCity($("#Multi3_Dept_CityName")).CityNameEn;segmentsName+="_";segmentsName+=this.getCity($("#Multi3_Arrive_CityName")).CityNameCn+"|"+this.getCity($("#Multi3_Arrive_CityName")).CityNameEn;}if((this.ThirdTrip.css("display")!="none")&&(this.FourthTrip.css("display")!="none")){segments+=";";segments+=$("#Multi4_Dept_CityName").attr("citythreesign")+"_"+$("#Multi4_Arrive_CityName").attr("citythreesign")+"_"+validator.reFormatDateString($("input[name='Multi4_Dept_Date']").val());segmentsName+=";";segmentsName+=this.getCity($("#Multi4_Dept_CityName")).CityNameCn+"|"+this.getCity($("#Multi4_Dept_CityName")).CityNameEn;segmentsName+="_";segmentsName+=this.getCity($("#Multi4_Arrive_CityName")).CityNameCn+"|"+this.getCity($("#Multi4_Arrive_CityName")).CityNameEn;}$("#ConditionForm").attr("action",this.PackageListUrl.eval({Language:IndexController.Language.toLowerCase(),Segments:segments,SegmentsName:segmentsName,AirCorps:"All",AdultTypes:"ADT-"+passengerCount+"_CHD-"+childCount,FlightClass:this.iMultiDest.find("input[name='ClassType']").val(),Extend1:this.iMultiDest.find("input[name='SearchInfo_AdultType']").val()=="0"?"0_0_0_0":"1_0_0_0"}));}var ConditionValue="";if(flighType!="2"){ConditionValue={FT:flighType,SC:$("#Dept_CityName").attr("citythreesign"),SCN:this.getCity($("#Dept_CityName")).CityNameCn+"|"+this.getCity($("#Dept_CityName")).CityNameEn,EC:$("#Arrive_CityName").attr("citythreesign"),ECN:this.getCity($("#Arrive_CityName")).CityNameCn+"|"+this.getCity($("#Arrive_CityName")).CityNameEn,SD:$("input[name='Dept_Date']").val(),ED:$("input[name='Back_Date']").val()};}Globals.cookie("Condition","",ConditionValue,{expires:30,path:"/",secure:false});if(window.location.host=="big5.elong.com"){var actionUrl=$("#ConditionForm").attr("action");actionUrl="http://big5.elong.com/gate/big5/iflight.elong.com"+actionUrl.replace("http://","");$("#ConditionForm").attr("action",actionUrl);}return true;},SearchFlightDateClick:function(b){var a=Event.element(b);var c=a.attr("method");switch(c){case"seachflightbyday":this.ShowWaiting();break;default:break;}},btnSearchClick:function(b){var a=Event.element(b);var c=false;if($("li[method='domesticTab']").attr("class")=="a_on"){c=this.searchDomestic();}else{c=this.searchInter();}if(c){this.ShowWaiting();$("#ConditionForm").submit();a.hide();$("#searchboxwait").show();}},ShowWaiting:function(){if(this.wind!=null){this.wind.close();}var a=new Dialog({title:"",htmlContent:$("#DIVWaiting").html(),width:IndexController.Language.toLowerCase()=="cn"?320:400,height:100,initEvent:function(c){var b=c.find("div[method='SearchWaiting']");b.show();}.bind(this)});a.show();},renderInter:function(){var c=1;var a=Globals.cookie("Condition");if(a!=null&&a!=""){c=String.isNullOrEmpty(Globals.cookie("Condition","FT"))?c:Globals.cookie("Condition","FT");if(c!=2){var d=String.isNullOrEmpty(Globals.cookie("Condition","SCN"))?"":Globals.cookie("Condition","SCN");var b=String.isNullOrEmpty(Globals.cookie("Condition","ECN"))?"":Globals.cookie("Condition","ECN");this.setCity("Dept_CityName",String.isNullOrEmpty(Globals.cookie("Condition","SC"))?"":Globals.cookie("Condition","SC"),d==""?d:(String.isNullOrEmpty(d.split("|")[0])?"":d.split("|")[0]),d==""?d:(String.isNullOrEmpty(d.split("|")[1])?"":d.split("|")[1]));this.setCity("Arrive_CityName",String.isNullOrEmpty(Globals.cookie("Condition","EC"))?"":Globals.cookie("Condition","EC"),b==""?b:(String.isNullOrEmpty(b.split("|")[0])?"":b.split("|")[0]),b==""?b:(String.isNullOrEmpty(b.split("|")[1])?"":b.split("|")[1]));}if(c==2){switch(segList.length){case 3:this.ThirdTrip.show();this.btnDel3.show();break;case 4:this.btnDel3.hide();this.btnDel4.show();this.ThirdTrip.show();this.FourthTrip.show();break;}}else{this.SearchBox.find("input[name='Dept_Date']").val(this.ShowDate("#hdnStartDate","StartDate"));this.ShowWeekDay($("input[name='Dept_Date']"),this.ShowDate("#hdnStartDate","StartDate"));if(c==1){$("input[name='Back_Date']").val(this.ShowDate("#hdnEndDate","EndDate"));this.ShowWeekDay($("input[name='Back_Date']"),this.ShowDate("#hdnEndDate","EndDate"));}}}else{c=this.interBox.find("input[name='iFlightType']:checked").val();if(c==2){if($("#FlightLength").val()>2){this.ThirdTrip.show();this.btnDel3.show();}if($("#FlightLength").val()>3){this.btnDel3.hide();this.btnDel4.show();this.FourthTrip.show();}}}switch(c){case"1":this.SearchBox.find("input[name='iFlightType'][method='itrip']").attr("checked",true);break;case"2":this.SearchBox.find("input[name='iFlightType'][method='imulti']").attr("checked",true);this.iRoundTrip.hide();this.iMultiDest.show();break;default:this.SearchBox.find("input[name='iFlightType'][method='ioneway']").attr("checked",true);this.iRoundDate.hide();break;}new CityWindow({eventElement:$("#Dept_CityName"),cityType:"iflightall",hotType:"iflightsrc",lang:IndexController.Language.toLowerCase(),resultNextId:"Arrive_CityName",onSelect:function(f,e){$("#Dept_CityName").attr("citythreesign",e.CityThreeSign);$("#Dept_CityName").attr("citytype",e.CityType);$("#Dept_CityName").attr("citynameen",e.CityNameEn);$("#Arrive_CityName").click();}});new CityWindow({eventElement:$("#Multi1_Dept_CityName"),cityType:"iflightall",hotType:"iflightsrc",lang:IndexController.Language.toLowerCase(),resultNextId:"Multi1_Arrive_CityName",onSelect:function(f,e){$("#Multi1_Dept_CityName").attr("citythreesign",e.CityThreeSign);$("#Multi1_Dept_CityName").attr("citytype",e.CityType);$("#Multi1_Dept_CityName").attr("citynameen",e.CityNameEn);}});new CityWindow({eventElement:$("#Multi2_Dept_CityName"),cityType:"iflightall",hotType:"iflightdest",lang:IndexController.Language.toLowerCase(),resultNextId:"Multi2_Arrive_CityName",onSelect:function(f,e){$("#Multi2_Dept_CityName").attr("citythreesign",e.CityThreeSign);$("#Multi2_Dept_CityName").attr("citytype",e.CityType);$("#Multi2_Dept_CityName").attr("citynameen",e.CityNameEn);}});new CityWindow({eventElement:$("#Multi3_Dept_CityName"),cityType:"iflightall",hotType:"iflightdest",lang:IndexController.Language.toLowerCase(),resultNextId:"Multi3_Arrive_CityName",onSelect:function(f,e){$("#Multi3_Dept_CityName").attr("citythreesign",e.CityThreeSign);$("#Multi3_Dept_CityName").attr("citytype",e.CityType);$("#Multi3_Dept_CityName").attr("citynameen",e.CityNameEn);}});new CityWindow({eventElement:$("#Multi4_Dept_CityName"),cityType:"iflightall",hotType:"iflightdest",lang:IndexController.Language.toLowerCase(),resultNextId:"Multi4_Arrive_CityName",onSelect:function(f,e){$("#Multi4_Dept_CityName").attr("citythreesign",e.CityThreeSign);$("#Multi4_Dept_CityName").attr("citytype",e.CityType);$("#Multi4_Dept_CityName").attr("citynameen",e.CityNameEn);}});new CityWindow({eventElement:$("#Arrive_CityName"),cityType:"iflightall",hotType:"iflightdest",lang:IndexController.Language.toLowerCase(),onSelect:function(f,e){$("#Arrive_CityName").attr("citythreesign",e.CityThreeSign);$("#Arrive_CityName").attr("citytype",e.CityType);$("#Arrive_CityName").attr("citynameen",e.CityNameEn);$("input[name='Dept_Date']").click();}});new CityWindow({eventElement:$("#Multi1_Arrive_CityName"),cityType:"iflightall",hotType:"iflightdest",lang:IndexController.Language.toLowerCase(),onSelect:function(f,e){$("#Multi1_Arrive_CityName").attr("citythreesign",e.CityThreeSign);$("#Multi1_Arrive_CityName").attr("citytype",e.CityType);$("#Multi1_Arrive_CityName").attr("citynameen",e.CityNameEn);$("#Multi2_Dept_CityName").attr("citythreesign",e.CityThreeSign);$("#Multi2_Dept_CityName").attr("citytype",e.CityType);$("#Multi2_Dept_CityName").attr("citynameen",e.CityNameEn);this.setCity("Multi2_Dept_CityName",e.CityThreeSign,e.CityNameCn,e.CityNameEn);}.bind(this)});new CityWindow({eventElement:$("#Multi2_Arrive_CityName"),cityType:"iflightall",hotType:"iflightdest",lang:IndexController.Language.toLowerCase(),onSelect:function(f,e){$("#Multi2_Arrive_CityName").attr("citythreesign",e.CityThreeSign);$("#Multi2_Arrive_CityName").attr("citytype",e.CityType);this.setCity("Multi3_Dept_CityName",e.CityThreeSign,e.CityNameCn,e.CityNameEn);$("#Multi3_Dept_CityName").attr("citythreesign",e.CityThreeSign);$("#Multi3_Dept_CityName").attr("citytype",e.CityType);$("#Multi3_Dept_CityName").attr("citynameen",e.CityNameEn);}.bind(this)});new CityWindow({eventElement:$("#Multi3_Arrive_CityName"),cityType:"iflightall",hotType:"iflightdest",lang:IndexController.Language.toLowerCase(),onSelect:function(f,e){$("#Multi3_Arrive_CityName").attr("citythreesign",e.CityThreeSign);$("#Multi3_Arrive_CityName").attr("citytype",e.CityType);this.setCity("Multi4_Dept_CityName",e.CityThreeSign,e.CityNameCn,e.CityNameEn);$("#Multi4_Dept_CityName").attr("citythreesign",e.CityThreeSign);$("#Multi4_Dept_CityName").attr("citytype",e.CityType);$("#Multi4_Dept_CityName").attr("citynameen",e.CityNameEn);}.bind(this)});new CityWindow({eventElement:$("#Multi4_Arrive_CityName"),cityType:"iflightall",hotType:"iflightdest",lang:IndexController.Language.toLowerCase(),onSelect:function(f,e){$("#Multi4_Arrive_CityName").attr("citythreesign",e.CityThreeSign);$("#Multi4_Arrive_CityName").attr("citytype",e.CityType);$("#Multi4_Arrive_CityName").attr("citynameen",e.CityNameEn);}});},renderDomestic:function(){var a=Globals.cookie("FlightCondition");if(a!=null&&a!=""){if(Globals.cookie("FlightCondition","FType")!="2"){if(Globals.cookie("FlightCondition","FType")!="1"){this.SearchBox.find("input[name='FlightType'][method='oneway']").attr("checked","checked");this.RoundTrip.show();this.RoundDate.show().addClass("gary");this.RoundDate.find(".dateinfo").hide();this.RoundDate.find("input").attr("value","yyyy-mm-dd").addClass("l_black");}else{this.SearchBox.find("input[name='FlightType'][method='round']").attr("checked","checked");this.RoundTrip.show();this.RoundDate.show().removeClass("gary").removeClass("l_black");this.RoundDate.find(".dateinfo").hide();var d=validator.reFormatDateString(this.CookieDate("input[name='BackDate']","BackDate"));if(d>=this.NowDate){this.SearchBox.find("input[name='BackDate']").val(this.CookieDate("input[name='BackDate']","BackDate"));this.ShowWeekDay(this.SearchBox.find("input[name='BackDate']"),this.CookieDate("input[name='BackDate']","BackDate"));}}var c=Globals.cookie("FlightCondition","DepName")==null?"":Globals.cookie("FlightCondition","DepName");this.setCity("Round_DepartCity",Globals.cookie("FlightCondition","DepCode"),c==""?"":c.split("|")[0],c==""?"":c.split("|")[1]);var b=Globals.cookie("FlightCondition","ArrName")==null?"":Globals.cookie("FlightCondition","ArrName");this.setCity("Round_ArriveCity",Globals.cookie("FlightCondition","ArrCode"),b==""?"":b.split("|")[0],b==""?"":b.split("|")[1]);var d=validator.reFormatDateString(this.CookieDate("input[name='DepartDate']","DepDate"));if(d>=this.NowDate){this.SearchBox.find("input[name='DepartDate']").val(this.CookieDate("input[name='DepartDate']","DepDate"));this.ShowWeekDay(this.SearchBox.find("input[name='DepartDate']"),this.CookieDate("input[name='DepartDate']","DepDate"));}}}else{this.RoundDate.show().addClass("gary").find("input").addClass("l_black").val("yyyy-mm-dd");this.RoundDate.find(".dateinfo").hide();}new CityWindow({eventElement:$("#Round_DepartCity"),cityType:"flightsrc",lang:IndexController.Language.toLowerCase(),resultNextId:"Round_ArriveCity",onSelect:function(f,e){$("#Round_DepartCity").attr("citythreesign",e.CityThreeSign);$("#Round_DepartCity").attr("citynameen",e.CityNameEn);$("#Round_ArriveCity").click();}});new CityWindow({eventElement:$("#Round_ArriveCity"),cityType:"flightsrc",lang:IndexController.Language.toLowerCase(),onSelect:function(f,e){$("#Round_ArriveCity").attr("citythreesign",e.CityThreeSign);$("#Round_ArriveCity").attr("citynameen",e.CityNameEn);$("input[name='DepartDate']").click();}});},render:function(){this.renderDomestic();this.renderInter();},destroyDOM:function(){this.FlightType=null;},destroyEvent:function(){},dispose:function(){this.destroyEvent();this.destroyDOM();}});var searchboxclient=null;$(document).ready(function(){searchboxclient=new SearchBoxClient();});var CustomSelect=Elong.Page.CustomSelect=Class.create();Object.extend(CustomSelect.prototype,{name:"CustomSelect",initialize:function(){this.isItemHover=0;this.delayTime4Select=null;this.selectUsingObj="";this.selectCloseUsing=0;this.isClickSelectTextObj=0;this.initializeDOM();this.initializeEvent();this.render();},initializeDOM:function(){this.MySelects=$(".droplist");this.Itmes=$(".droplist ul");},initializeEvent:function(){this.MySelects.bind("click",this.MySelectClick.bindAsEventListener(this));this.MySelects.bind("mouseover",this.MySelectMouseOver.bindAsEventListener(this));this.MySelects.bind("mouseout",this.MySelectMouseOut.bindAsEventListener(this));this.Itmes.bind("click",this.ItemsClick.bindAsEventListener(this));$(".droplist :text").click(function(){isClickSelectTextObj=1;});},MySelectClick:function(b){var a=Event.element(b);var e=a.attr("idtag");this.MySelects.removeClass("droplist_on");if(this.selectCloseUsing==1){return;}var g=(e==undefined?a.parents(".droplist"):a);if(this.selectUsingObj!=""&&this.selectUsingObj!=g.attr("idtag")){g.removeClass("droplist_on");}if(this.selectUsingObj!=""){clearTimeout(this.delayTime4Select);this.selectCloseUsing=1;g.removeClass("droplist_on");this.selectUsingObj="";this.delayTime4Select=setTimeout(function(){this.selectCloseUsing=0;this.isClickSelectTextObj=0;}.bind(this),200);}else{this.selectUsingObj=g.attr("idtag");clearTimeout(this.delayTime4Select);var e=g.attr("idtag");var d="";var c=$("#"+e);if(c.length>0){d=$("#"+e).val();}var f=g.find("ul.box");g.addClass("droplist_on");}},MySelectMouseOver:function(a){this.selectCloseUsing=0;},MySelectMouseOut:function(b){var a=Event.element(b);this.selectCloseUsing=1;this.delayTime4Select=setTimeout(function(){if(this.selectCloseUsing==1&&this.isClickSelectTextObj==0){$("div.droplist").removeClass("droplist_on");this.isItemHover=0;this.selectUsingObj="";}}.bind(this),3000);},ItemsClick:function(b){var a=Event.element(b);if(a.get(0).tagName.toLowerCase()!="li"){return;}this.selectCloseUsing=1;var e=a.parents("div.droplist");e.find("span.value").html(a.html());var d=e.attr("idtag");var c=$("#"+d);if(c.length>0){$("#"+d).val(a.attr("code")).trigger("change");}else{e.after('<input type="hidden" id="'+d+'" name="'+d+'" value="'+a.attr("code")+'"/>');}e.removeClass("droplist_on");this.selectUsingObj="";this.isItemHover=0;this.delayTime4Select=setTimeout(function(){this.selectCloseUsing=0;this.isClickSelectTextObj=0;}.bind(this),200);},render:function(){},destroyDOM:function(){},destroyEvent:function(){},dispose:function(){this.destroyEvent();this.destroyDOM();}});var selectclient=null;$(document).ready(function(){selectclient=new CustomSelect();});