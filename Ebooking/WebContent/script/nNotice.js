/*from tccdn minify at 2013-12-23 21:35:55,fileï¼š/cn/public/module/mNotice/0.4.2/mNotice.js?v=13082101*/
(function(a){a.extend({mNotice:function(g){function b(d){var f=true;d=a.all(d);if(d.length){d.each(function(h){if(!(a.one(h).hasClass("none")||h.style.display==="none")){return f=false}});return f}else{return 1}}function c(d){if(d=e.apply(ac,[d,r])){Z.html("");Z.html(d);ag=true}else{ag=false}}function J(d,f){var h;ak||am(ac);if(h=e.apply(ac,[d,r])){Z=ao(h,f);ag=true;aa==="mTab"&&aq(aa,ac,f);at(ac,Z);av&&aw(Z,ac);if(ay){aA(Z);aC(Z)}aE(ac,Z);aG(Z,ac);if(a.one(".mNotice-close",Z).length){Z.on("click",function(i){i=a.getTarget(i);a.one(i).hasClass("mNotice-close")&&Z.addClass("none")})}}else{ag=false}}function al(){if(!ar){var d=document.createElement("iframe");d.id="mNotice-backdrop";fish.one(Z).html("top",d);a.one(d).css("position:absolute;border:none;filter:alpha(opacity=0);opacity:0;z-index:-1");ar=d}d=fish.one(Z).width();var f=fish.one(Z).height();fish.all(ar).css("width:"+d+"px;height:"+f+"px")}function ao(d,f){Z=document.createElement("div");var h=a.one(Z);an&&h.attr("data-box-type",an);Z.id="mNotice-"+f;Z.className=ab?"mNotice-wrap none "+ab:"mNotice-wrap none";h.css("position: absolute; z-index: 2000;");document.body.insertBefore(Z,document.body.firstChild);Z.innerHTML=d;al();return h}function aq(d,f,h){d==="mTab"&&a.one("#mNotice-"+h).mTab({tab_tray:".mNotice-mTab-tab-tray",append:"current",content:".mNotice-mTab-content",fn:function(){au();al()}})}function at(d,f){d.on(aI,function(){a.all("body .mNotice-wrap").addClass("none");if(ag&&b(ad)){f.removeClass("none");aj(f,d,ap);al()}})}function am(d){d.on("click",function(){d[0].select()})}function aw(d,f){d.on(aK,function(h){h=a.getTarget(h);if(a.one(h).hasClass("mNotice-normal")){f.val(h.innerHTML);f.attr("cid",h.getAttribute("cid"));f.attr("ctype",h.getAttribute("ctype"));f.addClass("color-normal");d.addClass("none");an&&setTimeout(function(){a.dom("#"+an).blur()},20);af&&af.apply(a.one(h),[f])}})}function aA(d){d.on("mouseover",function(f){f=a.getTarget(f);if(a.one(f).hasClass("mNotice-normal")){a.all(".mNotice-normal",d).removeClass("mNotice-hover");a.one(f).addClass("mNotice-hover")}})}function aC(d){d.on("mouseout",function(){a.all(".mNotice-normal",d).removeClass("mNotice-hover")})}function aG(d,f){a.one(document).on("mousedown",function(h){for(var i=a.getTarget(h);i!==null;){if(i.nodeType===1&&(i===f[0]||i.className.indexOf("mNotice-wrap")>-1)){fish.one(i).attr("data-box-type")&&setTimeout(function(){fish.dom("#"+fish.one(i).attr("data-box-type")).focus()},0);return}i=i.parentNode}d.addClass("none")})}function aE(d,f){d.on("keydown",function(h){h=a.getEvent(h);key=h.keyCode||h.which;typeof key==="number"&&key!==17&&key!==18&&f.addClass("none")})}function aj(f,h,i){var j=i;if(f&&f[0].nodeType===1&&h&&h[0].nodeType===1){f.css("left:-1000px;");i=a.one(window).width();a.one(window).height();var m=h.width(),d=h.height(),k=f.width();f.height();h=h.offset();a.one(document).scrollTop();var l=a.one(document).scrollLeft();if(j&&!ax(j)){j.x=typeof j.x==="number"?j.x:0;j.y=typeof j.y==="number"?j.y:0}else{j={x:0,y:0}}h.left-l>i-(h.left-l)&&i-(h.left-l)<k?f.css("left:"+(h.left+m-k-j.x)+"px"):f.css("left:"+(h.left+j.x)+"px");f.css("top:"+(h.top+d+j.y)+"px")}else{aj(Z,ac,i)}}function au(){if(!(!Z||Z.hasClass("none"))){az&&clearTimeout(az);az=setTimeout(function(){aj(Z,ac,ap);al()},100)}}function ax(d){for(var f in d){return false}return true}function ai(d){if(!window.iError){window.iError=[]}window.iError.push({date:(new Date).toString(),info:d})}var aB=fish.guid();if(!g){throw Error("\u4f20\u9012\u8bbe\u7f6e\u53c2\u6570\uff01")}var ac=g.beside,an=g.dataBoxType,ak=g.isSelect,aI=g.documentCaptureEvent?g.documentCaptureEvent:"focus",aK=g.inputCaptureEvent?g.inputCaptureEvent:"click";if(this.length){ac=a.one(this[0])}else{if(!ac||typeof ac!=="string"&&ac.nodeType!==1&&!ac.length){throw Error("\u6307\u5b9a\u9700\u8981\u5f39\u6846\u7684\u8282\u70b9\u9009\u62e9\u5668\u6216\u8282\u70b9\uff01")}ac=a.one(ac);if(!ac.length){throw Error("\u6307\u5b9a\u9700\u8981\u5f39\u6846\u7684\u8282\u70b9\uff01")}}if(!{INPUT:"INPUT",TEXTAREA:"TEXTAREA"}[ac[0].nodeName]){throw Error("\u6307\u5b9a\u7684\u8f93\u5165\u57df\u65e0\u6548\uff01")}var ap={x:0,y:0},aD=g.offset&&g.offset.x,aF=g.offset&&g.offset.y,ae=g.request,ah=g.localData,r=typeof g.template==="string"?g.template:undefined,aa=g.mode==="mTab"?"mTab":"",ar,e=g.display,av=g.isClick===undefined?false:!!g.isClick,ay=g.isHover===undefined?false:!!g.isHover,af=typeof g.clickCallback==="function"?g.clickCallback:false,ab=typeof g.theme==="string"?g.theme:"",aH=typeof g.urlInTime==="function"?g.urlInTime:false,ad=typeof g.rejects==="string"?g.rejects:false,aJ="",Z,ag,az,aL={};if(g.offset&&(parseInt(aD)||parseInt(aF))){aD&&(ap.x=aD);aF&&(ap.y=aF)}if(!g.display&&typeof g.display!=="function"){throw Error("\u6307\u5b9a\u6570\u636e\u6e32\u67d3\u51fd\u6570\uff01")}if(!ae&&!ah||ae&&ah){throw Error("\u6307\u5b9a\u552f\u4e00\u6570\u636e\u6e90\uff01")}else{if(ae&&aH){aJ=ae.url;ae.url=aH(aJ);ae.fn=function(d){if(d&&(d.length||!ax(d))){a.ready(function(){aL[ae.url.substring(ae.url.indexOf("?")+1)]=d;a.all("#mNotice-"+aB).length?c(d):J(d,aB)})}};ae.onTimeout=function(){ai("\u670d\u52a1\u5668\u7aef\u54cd\u5e94\u8d85\u65f6\uff01")};ae.err=function(){ai("\u670d\u52a1\u5668\u7aef\u53d1\u751f\u9519\u8bef\uff01")};a.ajax(ae)}else{a.ready(function(){if(ah&&(ah.length||!ax(ah))){J(ah,aB)}})}}a.ready(function(){a.one(window).on("resize",au);a.one(window).on("scroll",au)});return{show:function(){setTimeout(function(){ag&&b(ad)&&Z.removeClass("none")&&aj()},0)},hide:function(){Z&&Z.length&&Z.addClass("none")},position:aj,update:function(){var d;ae.url=aH(aJ);d=ae.url.substring(ae.url.indexOf("?")+1);aL[d]?c(aL[d]):a.ajax(ae)}}}})})(fish);